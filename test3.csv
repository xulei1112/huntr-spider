https://huntr.dev/bounties/5529f51e-e40f-46f1-887b-c9dbebab4f06/,XSS Stored in perspective name in pimcore/perspective-editor,"Hello team,",,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/pimcore/perspective-editor/commit/16979055c684ff3321cf0945d11a1b0ee1e4b8d2,"@@ -104,6 +104,8 @@ pimcore.bundle.perspectiveeditor.PerspectiveEditor = class {
                                    disabled: !pimcore.settings['perspectives-writeable'],
                                    handler: function(){
                                        Ext.MessageBox.prompt(t('plugin_pimcore_perspectiveeditor_new_perspective'), t('plugin_pimcore_perspectiveeditor_new_perspective'), function (button, value) {


                                            if (button === 'ok' && value.length > 0) {
                                                //check for configs with same name
                                                let match = this.perspectiveTreeStore.findExact(""name"", value);
@@ -824,4 +826,8 @@ pimcore.bundle.perspectiveeditor.PerspectiveEditor = class {
            }
        }
    }




}
@@ -86,6 +86,8 @@ pimcore.bundle.perspectiveeditor.ViewEditor = class {
                    disabled: !pimcore.settings['custom-views-writeable'],
                    handler: function () {
                        Ext.MessageBox.prompt(t('plugin_pimcore_perspectiveeditor_new_view'), t('plugin_pimcore_perspectiveeditor_new_view'), function (button, value) {


                            if (button === 'ok' && value.length > 0) {
                                const record = this.viewTreeStore.getRoot().appendChild({
                                    id: pimcore.bundle.perspectiveeditor.PerspectiveViewHelper.generateUuid(),
@@ -567,4 +569,8 @@ pimcore.bundle.perspectiveeditor.ViewEditor = class {
            }
        }
    }




}
@@ -24,7 +24,7 @@ protected function convertTreeStoreToConfiguration($treeStore)
        $configuration = [];

        foreach ($treeStore['children'] as $child) {
            $name = $child['name'];
            $configuration[$name] = [];
            $configuration[$name]['elementTree'] = [];
            foreach ($child['children'] as $index => $element) {

@@ -39,6 +39,10 @@ protected function convertTreeStoreToConfiguration($treeStore)

        if (isset($treeStore['children'])) {
            foreach ($treeStore['children'] as $child) {




                if (!empty($child['config']['treeContextMenu'])) {
                    foreach (array_keys($child['config']['treeContextMenu']) as $contextMenuEntry) {
                        if (substr($child['config']['treetype'], 0, strlen($contextMenuEntry)) != $contextMenuEntry) {

","6
src/Resources/public/js/pimcore/perspective/perspective.js
@@ -104,6 +104,8 @@ pimcore.bundle.perspectiveeditor.PerspectiveEditor = class {
                                    disabled: !pimcore.settings['perspectives-writeable'],
                                    handler: function(){
                                        Ext.MessageBox.prompt(t('plugin_pimcore_perspectiveeditor_new_perspective'), t('plugin_pimcore_perspectiveeditor_new_perspective'), function (button, value) {
                                            value = this.sanitizeName(value);

                                            if (button === 'ok' && value.length > 0) {
                                                //check for configs with same name
                                                let match = this.perspectiveTreeStore.findExact(""name"", value);
@@ -824,4 +826,8 @@ pimcore.bundle.perspectiveeditor.PerspectiveEditor = class {
            }
        }
    }

    sanitizeName (name) {
        return name.replace(/[^a-z0-9_\-.+]/gi,'');
    }
}
6
src/Resources/public/js/pimcore/perspective/view.js
@@ -86,6 +86,8 @@ pimcore.bundle.perspectiveeditor.ViewEditor = class {
                    disabled: !pimcore.settings['custom-views-writeable'],
                    handler: function () {
                        Ext.MessageBox.prompt(t('plugin_pimcore_perspectiveeditor_new_view'), t('plugin_pimcore_perspectiveeditor_new_view'), function (button, value) {
                            value = this.sanitizeName(value);

                            if (button === 'ok' && value.length > 0) {
                                const record = this.viewTreeStore.getRoot().appendChild({
                                    id: pimcore.bundle.perspectiveeditor.PerspectiveViewHelper.generateUuid(),
@@ -567,4 +569,8 @@ pimcore.bundle.perspectiveeditor.ViewEditor = class {
            }
        }
    }

    sanitizeName (name) {
        return name.replace(/[^a-z0-9_\-.+]/gi,'');
    }
}
2
src/Services/PerspectiveAccessor.php
@@ -24,7 +24,7 @@ protected function convertTreeStoreToConfiguration($treeStore)
        $configuration = [];

        foreach ($treeStore['children'] as $child) {
            $name = $child['name'];
            $name = htmlspecialchars($child['name']);
            $configuration[$name] = [];
            $configuration[$name]['elementTree'] = [];
            foreach ($child['children'] as $index => $element) {
4
src/Services/ViewAccessor.php
@@ -39,6 +39,10 @@ protected function convertTreeStoreToConfiguration($treeStore)

        if (isset($treeStore['children'])) {
            foreach ($treeStore['children'] as $child) {
                if (array_key_exists('name', $child['config'])) {
                    $child['config']['name'] = htmlspecialchars($child['config']['name']);
                }

                if (!empty($child['config']['treeContextMenu'])) {
                    foreach (array_keys($child['config']['treeContextMenu']) as $contextMenuEntry) {
                        if (substr($child['config']['treetype'], 0, strlen($contextMenuEntry)) != $contextMenuEntry) {",,
https://huntr.dev/bounties/24c0a65f-0751-4ff8-af63-4b325ac8879f/,stored HTML-Injection in the Comments Part in thorsten/phpmyfaq,Lets see :),CVE-2023-1761,CWE-94: Code Injection,https://www.github.com/thorsten/phpmyfaq/commit/128ef85f8e3ab7869d3107aa4d0b6867b53391d7,"@@ -200,7 +200,7 @@
                ->setType($type)
                ->setUsername($username)
                ->setEmail($mailer)
                ->setComment(nl2br($comment))
                ->setDate($_SERVER['REQUEST_TIME']);

            if ($oComment->addComment($commentEntity)) {

@@ -83,7 +83,7 @@ public function getComments(int $id, string $type): string
            $output .= sprintf(
                '<strong><a href=""mailto:%s"">%s</a></strong>',
                $mail->safeEmail($item->getEmail()),
                $item->getUsername()
            );
            $output .= sprintf(' <span class=""text-muted"">(%s)</span>', $date->format($item->getDate()));
            $output .= '     </div>';

","2
phpmyfaq/ajaxservice.php
@@ -200,7 +200,7 @@
                ->setType($type)
                ->setUsername($username)
                ->setEmail($mailer)
                ->setComment(nl2br($comment))
                ->setComment(nl2br(strip_tags($comment)))
                ->setDate($_SERVER['REQUEST_TIME']);

            if ($oComment->addComment($commentEntity)) {
2
phpmyfaq/src/phpMyFAQ/Comments.php
@@ -83,7 +83,7 @@ public function getComments(int $id, string $type): string
            $output .= sprintf(
                '<strong><a href=""mailto:%s"">%s</a></strong>',
                $mail->safeEmail($item->getEmail()),
                $item->getUsername()
                Strings::htmlentities($item->getUsername())
            );
            $output .= sprintf(' <span class=""text-muted"">(%s)</span>', $date->format($item->getDate()));
            $output .= '     </div>';",,
https://huntr.dev/bounties/2d0ac48a-490d-4548-8d98-7447042dd1b5/,Stored xss real name in thorsten/phpmyfaq,"In the admin account, there is a feature to add a user. In this feature, a vulnerability was found in the ""Your Name"" form.",CVE-2023-1760,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/thorsten/phpmyfaq/commit/56295b54062a284020fccce12a5044f9fa7d2770,"@@ -17,6 +17,7 @@

namespace phpMyFAQ\Helper;


use phpMyFAQ\User;

/**
@@ -58,7 +59,7 @@ public function getAllUserOptions(int $id = 1, bool $allowBlockedUsers = false):
                    '<option value=""%d"" %s>%s (%s)</option>',
                    $userId,
                    (($userId === $id) ? 'selected' : ''),
                    $this->user->getUserData('display_name'),
                    $this->user->getLogin()
                );
            }

","3
phpmyfaq/src/phpMyFAQ/Helper/UserHelper.php
@@ -17,6 +17,7 @@

namespace phpMyFAQ\Helper;

use phpMyFAQ\Strings;
use phpMyFAQ\User;

/**
@@ -58,7 +59,7 @@ public function getAllUserOptions(int $id = 1, bool $allowBlockedUsers = false):
                    '<option value=""%d"" %s>%s (%s)</option>',
                    $userId,
                    (($userId === $id) ? 'selected' : ''),
                    $this->user->getUserData('display_name'),
                    Strings::htmlentities($this->user->getUserData('display_name')),
                    $this->user->getLogin()
                );
            }",,
https://huntr.dev/bounties/e8109aed-d364-4c0c-9545-4de0347b10e1/,XSS @ records in thorsten/phpmyfaq,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,CVE-2023-1759,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/thorsten/phpmyfaq/commit/ecbd8107fe954b6be95dab315862d1caa0b94efa,"@@ -43,9 +43,9 @@

if ($user->perm->hasPermission($user->getUserId(), 'add_faq')) {
    // FAQ data
    $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
    $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);
    $question = Filter::filterInput(INPUT_POST, 'question', FILTER_UNSAFE_RAW);
    $categories = Filter::filterInputArray(
        INPUT_POST,
        [
@@ -55,25 +55,25 @@
            ],
        ]
    );
    $recordLang = Filter::filterInput(INPUT_POST, 'lang', FILTER_UNSAFE_RAW);
    $tags = Filter::filterInput(INPUT_POST, 'tags', FILTER_UNSAFE_RAW);
    $active = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
    $sticky = Filter::filterInput(INPUT_POST, 'sticky', FILTER_UNSAFE_RAW);
    $content = Filter::filterInput(INPUT_POST, 'answer', FILTER_SANITIZE_SPECIAL_CHARS);
    $keywords = Filter::filterInput(INPUT_POST, 'keywords', FILTER_UNSAFE_RAW);
    $author = Filter::filterInput(INPUT_POST, 'author', FILTER_UNSAFE_RAW);
    $email = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
    $recordId = Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);
    $solutionId = Filter::filterInput(INPUT_POST, 'solution_id', FILTER_VALIDATE_INT);
    $revisionId = Filter::filterInput(INPUT_POST, 'revision_id', FILTER_VALIDATE_INT);
    $changed = Filter::filterInput(INPUT_POST, 'changed', FILTER_UNSAFE_RAW);
    $date = Filter::filterInput(INPUT_POST, 'date', FILTER_UNSAFE_RAW);
    $notes = Filter::filterInput(INPUT_POST, 'notes', FILTER_UNSAFE_RAW);

    // Permissions
    $permissions = [];
    if ('all' === Filter::filterInput(INPUT_POST, 'userpermission', FILTER_UNSAFE_RAW)) {
        $permissions += [
            'restricted_user' => [
                -1,
@@ -87,7 +87,7 @@
        ];
    }

    if ('all' === Filter::filterInput(INPUT_POST, 'grouppermission', FILTER_UNSAFE_RAW)) {
        $permissions += [
            'restricted_groups' => [
                -1,
@@ -203,7 +203,7 @@
                // notify the user who added the question
                try {
                    $notifyEmail = Filter::filterInput(INPUT_POST, 'notifyEmail', FILTER_SANITIZE_EMAIL);
                    $notifyUser = Filter::filterInput(INPUT_POST, 'notifyUser', FILTER_UNSAFE_RAW);
                    $notification->sendOpenQuestionAnswered($notifyEmail, $notifyUser, $oLink->toString());
                } catch (Exception $e) {
                    printf('<p class=""alert alert-warning"">%s</p>', $e->getMessage());

@@ -110,7 +110,7 @@
            $queryString = 'insertentry';
        }

        $faqData['lang'] = Filter::filterInput(INPUT_POST, 'lang', FILTER_UNSAFE_RAW);
        $selectedCategory = Filter::filterInputArray(
            INPUT_POST,
            [
@@ -125,25 +125,25 @@
                $categories[] = ['category_id' => $cats, 'category_lang' => $faqData['lang']];
            }
        }
        $faqData['active'] = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
        $faqData['keywords'] = Filter::filterInput(INPUT_POST, 'keywords', FILTER_UNSAFE_RAW);
        $faqData['title'] = Filter::filterInput(INPUT_POST, 'thema', FILTER_UNSAFE_RAW);
        $faqData['content'] = Filter::filterInput(INPUT_POST, 'content', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['author'] = Filter::filterInput(INPUT_POST, 'author', FILTER_UNSAFE_RAW);
        $faqData['email'] = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
        $faqData['comment'] = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
        $faqData['solution_id'] = Filter::filterInput(INPUT_POST, 'solution_id', FILTER_VALIDATE_INT);
        $faqData['revision_id'] = Filter::filterInput(INPUT_POST, 'revision_id', FILTER_VALIDATE_INT, 0);
        $faqData['sticky'] = Filter::filterInput(INPUT_POST, 'sticky', FILTER_VALIDATE_INT);
        $faqData['tags'] = Filter::filterInput(INPUT_POST, 'tags', FILTER_UNSAFE_RAW);
        $faqData['changed'] = Filter::filterInput(INPUT_POST, 'changed', FILTER_UNSAFE_RAW);
        $faqData['dateStart'] = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
        $faqData['dateEnd'] = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);
        $faqData['content'] = html_entity_decode($faqData['content']);
    } elseif ('editentry' === $action) {
        $id = Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);
        $lang = Filter::filterInput(INPUT_GET, 'lang', FILTER_UNSAFE_RAW);
        $translateTo = Filter::filterInput(INPUT_GET, 'translateTo', FILTER_UNSAFE_RAW);
        $categoryId = Filter::filterInput(INPUT_GET, 'cat', FILTER_VALIDATE_INT);

        if (!is_null($translateTo)) {
@@ -168,7 +168,7 @@
        }
    } elseif ('copyentry' === $action) {
        $faqData['id'] = Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);
        $faqData['lang'] = Filter::filterInput(INPUT_GET, 'lang', FILTER_UNSAFE_RAW);
        $categories = $categoryRelation->getCategories($faqData['id'], $faqData['lang']);

        $faq->getRecord($faqData['id'], null, true);

@@ -50,9 +50,9 @@
    );

    // FAQ data
    $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
    $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);
    $question = Filter::filterInput(INPUT_POST, 'question', FILTER_UNSAFE_RAW);
    $categories = Filter::filterInputArray(
        INPUT_POST,
        [
@@ -62,31 +62,31 @@
            ],
        ]
    );
    $recordLang = Filter::filterInput(INPUT_POST, 'lang', FILTER_UNSAFE_RAW);
    $tags = Filter::filterInput(INPUT_POST, 'tags', FILTER_UNSAFE_RAW);
    $active = 'yes' == Filter::filterInput(
        INPUT_POST,
        'active',
        FILTER_UNSAFE_RAW
    ) && $user->perm->hasPermission($user->getUserId(), 'approverec') ? 'yes' : 'no';
    $sticky = Filter::filterInput(INPUT_POST, 'sticky', FILTER_UNSAFE_RAW);
    $content = Filter::filterInput(INPUT_POST, 'answer', FILTER_SANITIZE_SPECIAL_CHARS);
    $keywords = Filter::filterInput(INPUT_POST, 'keywords', FILTER_UNSAFE_RAW);
    $author = Filter::filterInput(INPUT_POST, 'author', FILTER_UNSAFE_RAW);
    $email = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
    $recordId = Filter::filterInput(INPUT_POST, 'record_id', FILTER_VALIDATE_INT);
    $solutionId = Filter::filterInput(INPUT_POST, 'solution_id', FILTER_VALIDATE_INT);
    $revision = Filter::filterInput(INPUT_POST, 'revision', FILTER_UNSAFE_RAW);
    $revisionId = Filter::filterInput(INPUT_POST, 'revision_id', FILTER_VALIDATE_INT);
    $changed = Filter::filterInput(INPUT_POST, 'changed', FILTER_UNSAFE_RAW);
    $date = Filter::filterInput(INPUT_POST, 'date', FILTER_UNSAFE_RAW);
    $notes = Filter::filterInput(INPUT_POST, 'notes', FILTER_UNSAFE_RAW);

    // Permissions
    $faqPermission = new FaqPermission($faqConfig);
    $permissions = [];
    if ('all' === Filter::filterInput(INPUT_POST, 'userpermission', FILTER_UNSAFE_RAW)) {
        $permissions += [
            'restricted_user' => [
                -1,
@@ -100,7 +100,7 @@
        ];
    }

    if ('all' === Filter::filterInput(INPUT_POST, 'grouppermission', FILTER_UNSAFE_RAW)) {
        $permissions += [
            'restricted_groups' => [
                -1,
@@ -231,7 +231,7 @@
        }

        // All the other translations
        $languages = Filter::filterInput(INPUT_POST, 'used_translated_languages', FILTER_UNSAFE_RAW);
        ?>
      <script>
        (() => {

","32
phpmyfaq/admin/record.add.php
@@ -43,9 +43,9 @@

if ($user->perm->hasPermission($user->getUserId(), 'add_faq')) {
    // FAQ data
    $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
    $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);
    $question = Filter::filterInput(INPUT_POST, 'question', FILTER_UNSAFE_RAW);
    $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_SANITIZE_SPECIAL_CHARS);
    $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_SANITIZE_SPECIAL_CHARS);
    $question = Filter::filterInput(INPUT_POST, 'question', FILTER_SANITIZE_SPECIAL_CHARS);
    $categories = Filter::filterInputArray(
        INPUT_POST,
        [
@@ -55,25 +55,25 @@
            ],
        ]
    );
    $recordLang = Filter::filterInput(INPUT_POST, 'lang', FILTER_UNSAFE_RAW);
    $tags = Filter::filterInput(INPUT_POST, 'tags', FILTER_UNSAFE_RAW);
    $active = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
    $sticky = Filter::filterInput(INPUT_POST, 'sticky', FILTER_UNSAFE_RAW);
    $recordLang = Filter::filterInput(INPUT_POST, 'lang', FILTER_SANITIZE_SPECIAL_CHARS);
    $tags = Filter::filterInput(INPUT_POST, 'tags', FILTER_SANITIZE_SPECIAL_CHARS);
    $active = Filter::filterInput(INPUT_POST, 'active', FILTER_SANITIZE_SPECIAL_CHARS);
    $sticky = Filter::filterInput(INPUT_POST, 'sticky', FILTER_SANITIZE_SPECIAL_CHARS);
    $content = Filter::filterInput(INPUT_POST, 'answer', FILTER_SANITIZE_SPECIAL_CHARS);
    $keywords = Filter::filterInput(INPUT_POST, 'keywords', FILTER_UNSAFE_RAW);
    $author = Filter::filterInput(INPUT_POST, 'author', FILTER_UNSAFE_RAW);
    $keywords = Filter::filterInput(INPUT_POST, 'keywords', FILTER_SANITIZE_SPECIAL_CHARS);
    $author = Filter::filterInput(INPUT_POST, 'author', FILTER_SANITIZE_SPECIAL_CHARS);
    $email = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_SANITIZE_SPECIAL_CHARS);
    $recordId = Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);
    $solutionId = Filter::filterInput(INPUT_POST, 'solution_id', FILTER_VALIDATE_INT);
    $revisionId = Filter::filterInput(INPUT_POST, 'revision_id', FILTER_VALIDATE_INT);
    $changed = Filter::filterInput(INPUT_POST, 'changed', FILTER_UNSAFE_RAW);
    $date = Filter::filterInput(INPUT_POST, 'date', FILTER_UNSAFE_RAW);
    $notes = Filter::filterInput(INPUT_POST, 'notes', FILTER_UNSAFE_RAW);
    $changed = Filter::filterInput(INPUT_POST, 'changed', FILTER_SANITIZE_SPECIAL_CHARS);
    $date = Filter::filterInput(INPUT_POST, 'date', FILTER_SANITIZE_SPECIAL_CHARS);
    $notes = Filter::filterInput(INPUT_POST, 'notes', FILTER_SANITIZE_SPECIAL_CHARS);

    // Permissions
    $permissions = [];
    if ('all' === Filter::filterInput(INPUT_POST, 'userpermission', FILTER_UNSAFE_RAW)) {
    if ('all' === Filter::filterInput(INPUT_POST, 'userpermission', FILTER_SANITIZE_SPECIAL_CHARS)) {
        $permissions += [
            'restricted_user' => [
                -1,
@@ -87,7 +87,7 @@
        ];
    }

    if ('all' === Filter::filterInput(INPUT_POST, 'grouppermission', FILTER_UNSAFE_RAW)) {
    if ('all' === Filter::filterInput(INPUT_POST, 'grouppermission', FILTER_SANITIZE_SPECIAL_CHARS)) {
        $permissions += [
            'restricted_groups' => [
                -1,
@@ -203,7 +203,7 @@
                // notify the user who added the question
                try {
                    $notifyEmail = Filter::filterInput(INPUT_POST, 'notifyEmail', FILTER_SANITIZE_EMAIL);
                    $notifyUser = Filter::filterInput(INPUT_POST, 'notifyUser', FILTER_UNSAFE_RAW);
                    $notifyUser = Filter::filterInput(INPUT_POST, 'notifyUser', FILTER_SANITIZE_SPECIAL_CHARS);
                    $notification->sendOpenQuestionAnswered($notifyEmail, $notifyUser, $oLink->toString());
                } catch (Exception $e) {
                    printf('<p class=""alert alert-warning"">%s</p>', $e->getMessage());
26
phpmyfaq/admin/record.edit.php
@@ -110,7 +110,7 @@
            $queryString = 'insertentry';
        }

        $faqData['lang'] = Filter::filterInput(INPUT_POST, 'lang', FILTER_UNSAFE_RAW);
        $faqData['lang'] = Filter::filterInput(INPUT_POST, 'lang', FILTER_SANITIZE_SPECIAL_CHARS);
        $selectedCategory = Filter::filterInputArray(
            INPUT_POST,
            [
@@ -125,25 +125,25 @@
                $categories[] = ['category_id' => $cats, 'category_lang' => $faqData['lang']];
            }
        }
        $faqData['active'] = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
        $faqData['keywords'] = Filter::filterInput(INPUT_POST, 'keywords', FILTER_UNSAFE_RAW);
        $faqData['title'] = Filter::filterInput(INPUT_POST, 'thema', FILTER_UNSAFE_RAW);
        $faqData['active'] = Filter::filterInput(INPUT_POST, 'active', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['keywords'] = Filter::filterInput(INPUT_POST, 'keywords', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['title'] = Filter::filterInput(INPUT_POST, 'thema', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['content'] = Filter::filterInput(INPUT_POST, 'content', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['author'] = Filter::filterInput(INPUT_POST, 'author', FILTER_UNSAFE_RAW);
        $faqData['author'] = Filter::filterInput(INPUT_POST, 'author', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['email'] = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
        $faqData['comment'] = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
        $faqData['comment'] = Filter::filterInput(INPUT_POST, 'comment', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['solution_id'] = Filter::filterInput(INPUT_POST, 'solution_id', FILTER_VALIDATE_INT);
        $faqData['revision_id'] = Filter::filterInput(INPUT_POST, 'revision_id', FILTER_VALIDATE_INT, 0);
        $faqData['sticky'] = Filter::filterInput(INPUT_POST, 'sticky', FILTER_VALIDATE_INT);
        $faqData['tags'] = Filter::filterInput(INPUT_POST, 'tags', FILTER_UNSAFE_RAW);
        $faqData['changed'] = Filter::filterInput(INPUT_POST, 'changed', FILTER_UNSAFE_RAW);
        $faqData['dateStart'] = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
        $faqData['dateEnd'] = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);
        $faqData['tags'] = Filter::filterInput(INPUT_POST, 'tags', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['changed'] = Filter::filterInput(INPUT_POST, 'changed', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['dateStart'] = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['dateEnd'] = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_SANITIZE_SPECIAL_CHARS);
        $faqData['content'] = html_entity_decode($faqData['content']);
    } elseif ('editentry' === $action) {
        $id = Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);
        $lang = Filter::filterInput(INPUT_GET, 'lang', FILTER_UNSAFE_RAW);
        $translateTo = Filter::filterInput(INPUT_GET, 'translateTo', FILTER_UNSAFE_RAW);
        $lang = Filter::filterInput(INPUT_GET, 'lang', FILTER_SANITIZE_SPECIAL_CHARS);
        $translateTo = Filter::filterInput(INPUT_GET, 'translateTo', FILTER_SANITIZE_SPECIAL_CHARS);
        $categoryId = Filter::filterInput(INPUT_GET, 'cat', FILTER_VALIDATE_INT);

        if (!is_null($translateTo)) {
@@ -168,7 +168,7 @@
        }
    } elseif ('copyentry' === $action) {
        $faqData['id'] = Filter::filterInput(INPUT_GET, 'id', FILTER_VALIDATE_INT);
        $faqData['lang'] = Filter::filterInput(INPUT_GET, 'lang', FILTER_UNSAFE_RAW);
        $faqData['lang'] = Filter::filterInput(INPUT_GET, 'lang', FILTER_SANITIZE_SPECIAL_CHARS);
        $categories = $categoryRelation->getCategories($faqData['id'], $faqData['lang']);

        $faq->getRecord($faqData['id'], null, true);
34
phpmyfaq/admin/record.save.php
@@ -50,9 +50,9 @@
    );

    // FAQ data
    $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
    $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);
    $question = Filter::filterInput(INPUT_POST, 'question', FILTER_UNSAFE_RAW);
    $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_SANITIZE_SPECIAL_CHARS);
    $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_SANITIZE_SPECIAL_CHARS);
    $question = Filter::filterInput(INPUT_POST, 'question', FILTER_SANITIZE_SPECIAL_CHARS);
    $categories = Filter::filterInputArray(
        INPUT_POST,
        [
@@ -62,31 +62,31 @@
            ],
        ]
    );
    $recordLang = Filter::filterInput(INPUT_POST, 'lang', FILTER_UNSAFE_RAW);
    $tags = Filter::filterInput(INPUT_POST, 'tags', FILTER_UNSAFE_RAW);
    $recordLang = Filter::filterInput(INPUT_POST, 'lang', FILTER_SANITIZE_SPECIAL_CHARS);
    $tags = Filter::filterInput(INPUT_POST, 'tags', FILTER_SANITIZE_SPECIAL_CHARS);
    $active = 'yes' == Filter::filterInput(
        INPUT_POST,
        'active',
        FILTER_UNSAFE_RAW
        FILTER_SANITIZE_SPECIAL_CHARS
    ) && $user->perm->hasPermission($user->getUserId(), 'approverec') ? 'yes' : 'no';
    $sticky = Filter::filterInput(INPUT_POST, 'sticky', FILTER_UNSAFE_RAW);
    $sticky = Filter::filterInput(INPUT_POST, 'sticky', FILTER_SANITIZE_SPECIAL_CHARS);
    $content = Filter::filterInput(INPUT_POST, 'answer', FILTER_SANITIZE_SPECIAL_CHARS);
    $keywords = Filter::filterInput(INPUT_POST, 'keywords', FILTER_UNSAFE_RAW);
    $author = Filter::filterInput(INPUT_POST, 'author', FILTER_UNSAFE_RAW);
    $keywords = Filter::filterInput(INPUT_POST, 'keywords', FILTER_SANITIZE_SPECIAL_CHARS);
    $author = Filter::filterInput(INPUT_POST, 'author', FILTER_SANITIZE_SPECIAL_CHARS);
    $email = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_SANITIZE_SPECIAL_CHARS);
    $recordId = Filter::filterInput(INPUT_POST, 'record_id', FILTER_VALIDATE_INT);
    $solutionId = Filter::filterInput(INPUT_POST, 'solution_id', FILTER_VALIDATE_INT);
    $revision = Filter::filterInput(INPUT_POST, 'revision', FILTER_UNSAFE_RAW);
    $revision = Filter::filterInput(INPUT_POST, 'revision', FILTER_SANITIZE_SPECIAL_CHARS);
    $revisionId = Filter::filterInput(INPUT_POST, 'revision_id', FILTER_VALIDATE_INT);
    $changed = Filter::filterInput(INPUT_POST, 'changed', FILTER_UNSAFE_RAW);
    $date = Filter::filterInput(INPUT_POST, 'date', FILTER_UNSAFE_RAW);
    $notes = Filter::filterInput(INPUT_POST, 'notes', FILTER_UNSAFE_RAW);
    $changed = Filter::filterInput(INPUT_POST, 'changed', FILTER_SANITIZE_SPECIAL_CHARS);
    $date = Filter::filterInput(INPUT_POST, 'date', FILTER_SANITIZE_SPECIAL_CHARS);
    $notes = Filter::filterInput(INPUT_POST, 'notes', FILTER_SANITIZE_SPECIAL_CHARS);

    // Permissions
    $faqPermission = new FaqPermission($faqConfig);
    $permissions = [];
    if ('all' === Filter::filterInput(INPUT_POST, 'userpermission', FILTER_UNSAFE_RAW)) {
    if ('all' === Filter::filterInput(INPUT_POST, 'userpermission', FILTER_SANITIZE_SPECIAL_CHARS)) {
        $permissions += [
            'restricted_user' => [
                -1,
@@ -100,7 +100,7 @@
        ];
    }

    if ('all' === Filter::filterInput(INPUT_POST, 'grouppermission', FILTER_UNSAFE_RAW)) {
    if ('all' === Filter::filterInput(INPUT_POST, 'grouppermission', FILTER_SANITIZE_SPECIAL_CHARS)) {
        $permissions += [
            'restricted_groups' => [
                -1,
@@ -231,7 +231,7 @@
        }

        // All the other translations
        $languages = Filter::filterInput(INPUT_POST, 'used_translated_languages', FILTER_UNSAFE_RAW);
        $languages = Filter::filterInput(INPUT_POST, 'used_translated_languages', FILTER_SANITIZE_SPECIAL_CHARS);
        ?>
      <script>
        (() => {",,
https://huntr.dev/bounties/0854328e-eb00-41a3-9573-8da8f00e369c/,XSS in Comment Faq news username parameter in thorsten/phpmyfaq,Stored Cross-Site Scripting (XSS) is a type of security vulnerability that occurs when an attacker injects malicious code into a website that is then stored on the server and served to unsuspecting users. This type of XSS is particularly dangerous because it can persist and continue to impact users even after the initial injection has taken place.,CVE-2023-1758,CWE-75: Failure to Sanitize Special Elements into a Different Plane (Special Element Injection),https://www.github.com/thorsten/phpmyfaq/commit/f3380f46c464d1bc6f3ded29213c79be0de8fc57,"@@ -127,10 +127,10 @@
                <td>
                <span style=""font-weight: bold;"">
                    <a href=""mailto:<?= $newsComment->getEmail() ?>"">
                        <?= $newsComment->getUsername() ?>
                    </a> |
                    <?= $date->format(date('Y-m-d H:i', $faqComment->getDate())) ?> |
                    <a href=""<?php printf('../?action=news&id=%d&artlang=%s', $faqComment->getRecordId(), $faqLangCode) ?>"">
                        <i class=""fa fa-newspaper-o"" aria-hidden=""true""></i>
                    </a>
                </span><br/>

","6
phpmyfaq/admin/record.comments.php
@@ -127,10 +127,10 @@
                <td>
                <span style=""font-weight: bold;"">
                    <a href=""mailto:<?= $newsComment->getEmail() ?>"">
                        <?= $newsComment->getUsername() ?>
                        <?= Strings::htmlentities($newsComment->getUsername()) ?>
                    </a> |
                    <?= $date->format(date('Y-m-d H:i', $faqComment->getDate())) ?> |
                    <a href=""<?php printf('../?action=news&id=%d&artlang=%s', $faqComment->getRecordId(), $faqLangCode) ?>"">
                    <?= $date->format(date('Y-m-d H:i', $newsComment->getDate())) ?> |
                    <a href=""<?php printf('../?action=news&id=%d&artlang=%s', $newsComment->getRecordId(), $faqLangCode) ?>"">
                        <i class=""fa fa-newspaper-o"" aria-hidden=""true""></i>
                    </a>
                </span><br/>",,
https://huntr.dev/bounties/dda73cb6-9344-4822-97a1-2e31efb6a73e/,XSS @ Stop Words in thorsten/phpmyfaq,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,,CWE-79: Cross-site Scripting (XSS) - Generic,https://www.github.com/thorsten/phpmyfaq/commit/7f0f921de74c88038826c46bbd2a123518d9d611,"@@ -106,10 +106,10 @@ function buildStopWordsHTML(data) {
            }

            // id attribute is of the format stopword_<id>_<lang>
            elem_id = buildStopWordInputElemId(data[i].id, data[i].lang);

            html += '<td>';
            html += buildStopWordInputElement(elem_id, data[i].stopword);
            html += '</td>';

            if (i % maxCols === maxCols - 1) {
@@ -136,7 +136,7 @@ function buildStopWordInputElement(elementId, stopword) {
          elementId = elementId || buildStopWordInputElemId();
          stopword = stopword || '';
          const attrs = 'onblur=""saveStopWord(this.id)"" onkeydown=""saveStopWordHandleEnter(this.id, event)"" onfocus=""saveOldValue(this.id)""';
          return '<input class=""form-control form-control-sm"" id=""' + elementId + '"" value=""' + stopword + '"" ' + attrs + '>';
        }

        /**
@@ -286,6 +286,21 @@ function() {
            );
          }
        }















      </script>
    </div>
  </div>

@@ -192,7 +192,7 @@ public function getByLang($lang = null, $wordsOnly = false): array

        if ($wordsOnly) {
            while (($row = $this->config->getDb()->fetchObject($result)) == true) {
                $stopWords[] = $row->stopword;
            }
        } else {
            return $this->config->getDb()->fetchAll($result);

","21
phpmyfaq/admin/stopwords.php
@@ -106,10 +106,10 @@ function buildStopWordsHTML(data) {
            }

            // id attribute is of the format stopword_<id>_<lang>
            elem_id = buildStopWordInputElemId(data[i].id, data[i].lang);
            elem_id = buildStopWordInputElemId(data[i].id, escape(data[i].lang));

            html += '<td>';
            html += buildStopWordInputElement(elem_id, data[i].stopword);
            html += buildStopWordInputElement(elem_id, escape(data[i].stopword));
            html += '</td>';

            if (i % maxCols === maxCols - 1) {
@@ -136,7 +136,7 @@ function buildStopWordInputElement(elementId, stopword) {
          elementId = elementId || buildStopWordInputElemId();
          stopword = stopword || '';
          const attrs = 'onblur=""saveStopWord(this.id)"" onkeydown=""saveStopWordHandleEnter(this.id, event)"" onfocus=""saveOldValue(this.id)""';
          return '<input class=""form-control form-control-sm"" id=""' + elementId + '"" value=""' + stopword + '"" ' + attrs + '>';
          return '<input class=""form-control form-control-sm"" id=""' + elementId + '"" value=""' + escape(stopword) + '"" ' + attrs + '>';
        }

        /**
@@ -286,6 +286,21 @@ function() {
            );
          }
        }

        const escape = (text) => {
          const map = {
            '&': '&amp;',
            '<': '&lt;',
            '>': '&gt;',
            '""': '&quot;',
            ""'"": '&#039;',
          };

          return text.replace(/[&<>""']/g, (mapped) => {
            return map[mapped];
          });
        };

      </script>
    </div>
  </div>
2
phpmyfaq/src/phpMyFAQ/Stopwords.php
@@ -192,7 +192,7 @@ public function getByLang($lang = null, $wordsOnly = false): array

        if ($wordsOnly) {
            while (($row = $this->config->getDb()->fetchObject($result)) == true) {
                $stopWords[] = $row->stopword;
                $stopWords[] = Strings::htmlentities($row->stopword);
            }
        } else {
            return $this->config->getDb()->fetchAll($result);",,
https://huntr.dev/bounties/e4a58835-96b5-412c-a17e-3ceed30231e1/,User with only "edit" can delete post and somethimes can add post in thorsten/phpmyfaq,"If you create a user with edit-only user rights, they should not be able to perform delete or add actions. This is really an admin error, because users with edit permissions can delete posts, and in the case of FAQs, they can also add posts.",,CWE-840: Business Logic Errors,https://www.github.com/thorsten/phpmyfaq/commit/400d9cd988d3287515c56b2ad6343026966f1a89,"@@ -8,12 +8,12 @@
 * v. 2.0. If a copy of the MPL was not distributed with this file, You can
 * obtain one at http://mozilla.org/MPL/2.0/.
 *
 * @package phpMyFAQ
 * @author Thorsten Rinne <thorsten@phpmyfaq.de>
 * @copyright 2003-2022 phpMyFAQ Team
 * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
 * @link https://www.phpmyfaq.de
 * @since 2003-02-23
 */

use Abraham\TwitterOAuth\TwitterOAuth;
@@ -41,7 +41,7 @@
    exit();
}

if ($user->perm->hasPermission($user->getUserId(), 'edit_faq') || $user->perm->hasPermission($user->getUserId(), 'add_faq')) {
    // FAQ data
    $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
    $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);

","12
phpmyfaq/admin/record.add.php
@@ -8,12 +8,12 @@
 * v. 2.0. If a copy of the MPL was not distributed with this file, You can
 * obtain one at http://mozilla.org/MPL/2.0/.
 *
 * @package phpMyFAQ
 * @author Thorsten Rinne <thorsten@phpmyfaq.de>
 * @package   phpMyFAQ
 * @author    Thorsten Rinne <thorsten@phpmyfaq.de>
 * @copyright 2003-2022 phpMyFAQ Team
 * @license http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
 * @link https://www.phpmyfaq.de
 * @since 2003-02-23
 * @license   http://www.mozilla.org/MPL/2.0/ Mozilla Public License Version 2.0
 * @link      https://www.phpmyfaq.de
 * @since     2003-02-23
 */

use Abraham\TwitterOAuth\TwitterOAuth;
@@ -41,7 +41,7 @@
    exit();
}

if ($user->perm->hasPermission($user->getUserId(), 'edit_faq') || $user->perm->hasPermission($user->getUserId(), 'add_faq')) {
if ($user->perm->hasPermission($user->getUserId(), 'add_faq')) {
    // FAQ data
    $dateStart = Filter::filterInput(INPUT_POST, 'dateStart', FILTER_UNSAFE_RAW);
    $dateEnd = Filter::filterInput(INPUT_POST, 'dateEnd', FILTER_UNSAFE_RAW);",,
https://huntr.dev/bounties/2f1e417d-cf64-4cfb-954b-3a9cb2f38191/,Broken access control - Someone still can comment in unactive FAQ NEWS in thorsten/phpmyfaq,when a NEWS FAQ turns on the comments feature and disables post like this settings.,,CWE-284: Improper Access Control,https://www.github.com/thorsten/phpmyfaq/commit/db77df888178766987398597d4f153831c62a503,"@@ -185,13 +185,8 @@
        }

        if (
            !is_null($username) && !is_null($mailer) && !is_null($comment) && $stopWords->checkBannedWord(
                $comment
            ) && !$faq->commentDisabled(
                $id,
                $languageCode,
                $type
            )
        ) {
            try {
                $faqSession->userTracking('save_comment', $id);

@@ -1258,6 +1258,39 @@ public function hasTranslation(int $recordId, string $recordLang): bool
        return false;
    }


































    /**
     * Checks, if comments are disabled for the FAQ record.
     *
@@ -1268,7 +1301,7 @@ public function hasTranslation(int $recordId, string $recordLang): bool
     */
    public function commentDisabled(int $recordId, string $recordLang, string $commentType = 'faq'): bool
    {
        if ('news' == $commentType) {
            $table = 'faqnews';
        } else {
            $table = 'faqdata';

","9
phpmyfaq/ajaxservice.php
@@ -185,13 +185,8 @@
        }

        if (
            !is_null($username) && !is_null($mailer) && !is_null($comment) && $stopWords->checkBannedWord(
                $comment
            ) && !$faq->commentDisabled(
                $id,
                $languageCode,
                $type
            )
            !is_null($username) && !is_null($mailer) && !is_null($comment) && $stopWords->checkBannedWord($comment) &&
            !$faq->commentDisabled($id, $languageCode, $type) && !$faq->isActive($id, $languageCode, $type)
        ) {
            try {
                $faqSession->userTracking('save_comment', $id);
35
phpmyfaq/src/phpMyFAQ/Faq.php
@@ -1258,6 +1258,39 @@ public function hasTranslation(int $recordId, string $recordLang): bool
        return false;
    }

    public function isActive(int $recordId, string $recordLang, string $commentType = 'faq'): bool
    {
        if ('news' === $commentType) {
            $table = 'faqnews';
        } else {
            $table = 'faqdata';
        }

        $query = sprintf(
            ""
            SELECT
                active
            FROM
                %s%s
            WHERE
                id = %d
            AND
                lang = '%s'"",
            Database::getTablePrefix(),
            $table,
            $recordId,
            $this->config->getDb()->escape($recordLang)
        );

        $result = $this->config->getDb()->query($query);

        if ($row = $this->config->getDb()->fetchObject($result)) {
            return !(($row->active === 'y' || $row->active === 'yes'));
        } else {
            return true;
        }
    }

    /**
     * Checks, if comments are disabled for the FAQ record.
     *
@@ -1268,7 +1301,7 @@ public function hasTranslation(int $recordId, string $recordLang): bool
     */
    public function commentDisabled(int $recordId, string $recordLang, string $commentType = 'faq'): bool
    {
        if ('news' == $commentType) {
        if ('news' === $commentType) {
            $table = 'faqnews';
        } else {
            $table = 'faqdata';",,
https://huntr.dev/bounties/bce84c02-abb2-474f-a67b-1468c9dcabb8/,stored XSS in the Category Field Name in thorsten/phpmyfaq,"After all XSS Mitigations, I detected a XSS Bypass Possibility in the Naming of the category.",,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/thorsten/phpmyfaq/commit/fecc803ab9c3e82718c4bcea7fe919d7a22ec024,"@@ -21,6 +21,7 @@
use phpMyFAQ\Category\CategoryRelation;
use phpMyFAQ\Database;
use phpMyFAQ\Filter;


if (!defined('IS_VALID_PHPMYFAQ')) {
    http_response_code(400);
@@ -319,9 +320,10 @@
            foreach ($category->getCategoryTree() as $id => $cat) {
                // CategoryHelper translated in this language?
                if ($cat['lang'] == $lang) {
                    $categoryName = $cat['name'];
                } else {
                    $categoryName = $cat['name'] . ' (' . $languageCodes[strtoupper($cat['lang'])] . ')';

                }



","6
phpmyfaq/admin/category.main.php
@@ -21,6 +21,7 @@
use phpMyFAQ\Category\CategoryRelation;
use phpMyFAQ\Database;
use phpMyFAQ\Filter;
use phpMyFAQ\Strings;

if (!defined('IS_VALID_PHPMYFAQ')) {
    http_response_code(400);
@@ -319,9 +320,10 @@
            foreach ($category->getCategoryTree() as $id => $cat) {
                // CategoryHelper translated in this language?
                if ($cat['lang'] == $lang) {
                    $categoryName = $cat['name'];
                    $categoryName = Strings::htmlentities($cat['name']);
                } else {
                    $categoryName = $cat['name'] . ' (' . $languageCodes[strtoupper($cat['lang'])] . ')';
                    $categoryName = Strings::htmlentities($cat['name']) .
                        ' (' . $languageCodes[strtoupper($cat['lang'])] . ')';
                }",,
https://huntr.dev/bounties/1dc7f818-c8ea-4f80-b000-31b48a426334/,Stored XSS @ updatecategory in thorsten/phpmyfaq,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/thorsten/phpmyfaq/commit/0dc8e527c375007cd4b8dbf61f7167393a6f6e91,"@@ -19,6 +19,7 @@
use phpMyFAQ\Category\CategoryPermission;
use phpMyFAQ\Filter;
use phpMyFAQ\Helper\UserHelper;


if (!defined('IS_VALID_PHPMYFAQ')) {
    http_response_code(400);
@@ -58,7 +59,8 @@
        $restrictedGroups = true;
    }

    $header = $PMF_LANG['ad_categ_edit_1'] . ' ""' . $categoryData->getName() . '"" ' . $PMF_LANG['ad_categ_edit_2'];

    ?>
        <div class=""d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"">
          <h1 class=""h2"">
@@ -81,7 +83,7 @@
                  <?= $PMF_LANG['ad_categ_titel'] ?>:
              </label>
              <div class=""col-lg-4"">
                <input type=""text"" id=""name"" name=""name"" value=""<?= $categoryData->getName() ?>""
                       class=""form-control"">
              </div>
            </div>
@@ -92,7 +94,7 @@ class=""form-control"">
              </label>
              <div class=""col-lg-4"">
                <textarea id=""description"" name=""description"" rows=""3""
                          class=""form-control""><?= $categoryData->getDescription() ?></textarea>
              </div>
            </div>


@@ -155,8 +155,8 @@

                $parentId = Filter::filterInput(INPUT_POST, 'parent_id', FILTER_VALIDATE_INT);
                $categoryId = Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);
                $categoryLang = Filter::filterInput(INPUT_POST, 'catlang', FILTER_UNSAFE_RAW);
                $existingImage = Filter::filterInput(INPUT_POST, 'existing_image', FILTER_UNSAFE_RAW);
                $image = count($uploadedFile) ? $categoryImage->getFileName(
                    $categoryId,
                    $categoryLang

","8
phpmyfaq/admin/category.edit.php
@@ -19,6 +19,7 @@
use phpMyFAQ\Category\CategoryPermission;
use phpMyFAQ\Filter;
use phpMyFAQ\Helper\UserHelper;
use phpMyFAQ\Strings;

if (!defined('IS_VALID_PHPMYFAQ')) {
    http_response_code(400);
@@ -58,7 +59,8 @@
        $restrictedGroups = true;
    }

    $header = $PMF_LANG['ad_categ_edit_1'] . ' ""' . $categoryData->getName() . '"" ' . $PMF_LANG['ad_categ_edit_2'];
    $header = $PMF_LANG['ad_categ_edit_1'] . ' ""' . Strings::htmlentities($categoryData->getName()) .
        '"" ' . $PMF_LANG['ad_categ_edit_2'];
    ?>
        <div class=""d-flex justify-content-between flex-wrap flex-md-nowrap align-items-center pt-3 pb-2 mb-3 border-bottom"">
          <h1 class=""h2"">
@@ -81,7 +83,7 @@
                  <?= $PMF_LANG['ad_categ_titel'] ?>:
              </label>
              <div class=""col-lg-4"">
                <input type=""text"" id=""name"" name=""name"" value=""<?= $categoryData->getName() ?>""
                <input type=""text"" id=""name"" name=""name"" value=""<?= Strings::htmlentities($categoryData->getName()) ?>""
                       class=""form-control"">
              </div>
            </div>
@@ -92,7 +94,7 @@ class=""form-control"">
              </label>
              <div class=""col-lg-4"">
                <textarea id=""description"" name=""description"" rows=""3""
                          class=""form-control""><?= $categoryData->getDescription() ?></textarea>
                          class=""form-control""><?= Strings::htmlentities($categoryData->getDescription()) ?></textarea>
              </div>
            </div>

4
phpmyfaq/admin/category.main.php
@@ -155,8 +155,8 @@

                $parentId = Filter::filterInput(INPUT_POST, 'parent_id', FILTER_VALIDATE_INT);
                $categoryId = Filter::filterInput(INPUT_POST, 'id', FILTER_VALIDATE_INT);
                $categoryLang = Filter::filterInput(INPUT_POST, 'catlang', FILTER_UNSAFE_RAW);
                $existingImage = Filter::filterInput(INPUT_POST, 'existing_image', FILTER_UNSAFE_RAW);
                $categoryLang = Filter::filterInput(INPUT_POST, 'catlang', FILTER_SANITIZE_SPECIAL_CHARS);
                $existingImage = Filter::filterInput(INPUT_POST, 'existing_image', FILTER_SANITIZE_SPECIAL_CHARS);
                $image = count($uploadedFile) ? $categoryImage->getFileName(
                    $categoryId,
                    $categoryLang",,
https://huntr.dev/bounties/93f981a3-231d-460d-a239-bb960e8c2fdc/,Stored XSS in the adminlog functionality. in thorsten/phpmyfaq,"There is a stored XSS in the 'adminlog' functionality. E.g. the page http://phpmyfaq.local/admin/?action=adminlog shows (failed) login attempts. If a user with the username '<script>alert(1);</script>' tries to log in, it gets logged and displayed on the adminlog unsanitized.",,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/thorsten/phpmyfaq/commit/e018823f8e3bca103c11e5a98b0dd469e41ed417,"@@ -35,7 +35,7 @@
    $deleteLog = true;
}

if ($user->perm->hasPermission($user->getUserId(), 'adminlog') && 'adminlog' == $action) {
    $date = new Date($faqConfig);
    $perpage = 15;
    $pages = Filter::filterInput(INPUT_GET, 'pages', FILTER_VALIDATE_INT);
@@ -117,7 +117,7 @@
            <td><?= Strings::htmlentities($user->getLogin()) ?></td>
            <td><?= $loggingValue['ip'] ?></td>
            <td><small><?php
            $text = $loggingValue['text'];
            $text = str_replace('Loginerror', $PMF_LANG['ad_log_lger'], $text);
            $text = str_replace('Session expired', $PMF_LANG['ad_log_sess'], $text);
            $text = str_replace('Useredit, ', $PMF_LANG['ad_log_edit'], $text);
@@ -138,7 +138,7 @@
    </table>

    <?php
} elseif ($user->perm->hasPermission($user->getUserId(), 'adminlog') && 'deleteadminlog' == $action && $deleteLog) {
    if ($logging->delete()) {
        printf('<p class=""alert alert-success"">%s</p>', $PMF_LANG['ad_adminlog_delete_success']);
    } else {

","6
phpmyfaq/admin/stat.adminlog.php
@@ -35,7 +35,7 @@
    $deleteLog = true;
}

if ($user->perm->hasPermission($user->getUserId(), 'adminlog') && 'adminlog' == $action) {
if ($user->perm->hasPermission($user->getUserId(), 'adminlog') && 'adminlog' === $action) {
    $date = new Date($faqConfig);
    $perpage = 15;
    $pages = Filter::filterInput(INPUT_GET, 'pages', FILTER_VALIDATE_INT);
@@ -117,7 +117,7 @@
            <td><?= Strings::htmlentities($user->getLogin()) ?></td>
            <td><?= $loggingValue['ip'] ?></td>
            <td><small><?php
            $text = $loggingValue['text'];
            $text = Strings::htmlentities($loggingValue['text']);
            $text = str_replace('Loginerror', $PMF_LANG['ad_log_lger'], $text);
            $text = str_replace('Session expired', $PMF_LANG['ad_log_sess'], $text);
            $text = str_replace('Useredit, ', $PMF_LANG['ad_log_edit'], $text);
@@ -138,7 +138,7 @@
    </table>

    <?php
} elseif ($user->perm->hasPermission($user->getUserId(), 'adminlog') && 'deleteadminlog' == $action && $deleteLog) {
} elseif ($user->perm->hasPermission($user->getUserId(), 'adminlog') && 'deleteadminlog' === $action && $deleteLog) {
    if ($logging->delete()) {
        printf('<p class=""alert alert-success"">%s</p>', $PMF_LANG['ad_adminlog_delete_success']);
    } else {",,
https://huntr.dev/bounties/15b06488-5849-47ce-aaf4-81d4c3c202e2/,Restrictive composer.json makes Dompdf vulnerable to URI validation failure on SVG parsing in microweber/microweber,"The URI validation on dompdf 2.0.1 can be bypassed on SVG parsing by passing <image> tags with uppercase letters. This might lead to arbitrary object unserialize on PHP < 8, through the phar URL wrapper.",,CWE-502: Deserialization of Untrusted Data,https://www.github.com/microweber/microweber/commit/039e33b446a5bc0dc028c5bc6e0a1c4056046b03,"@@ -34,7 +34,7 @@
        ""composer/installers"": ""1.9.0"",
        ""darkaonline/l5-swagger"": ""*"",
        ""doctrine/dbal"": ""3.3.3"",
        ""dompdf/dompdf"": ""2.0.2"",
        ""enshrined/svg-sanitize"": ""0.15.0"",
        ""erusev/parsedown"": ""1.7.4"",
        ""ezyang/htmlpurifier"": ""*"",
@@ -169,6 +169,7 @@
                ""blade-ui-kit/blade-ui-kit"",
                ""blade-ui-kit/blade-icons"",
                ""laravel/passport"",

                ""laravel/sanctum"",
                ""laravel/cashier"",
                ""laravel/fortify"",

","3
composer.json
@@ -34,7 +34,7 @@
        ""composer/installers"": ""1.9.0"",
        ""darkaonline/l5-swagger"": ""*"",
        ""doctrine/dbal"": ""3.3.3"",
        ""dompdf/dompdf"": ""2.0.2"",
        ""dompdf/dompdf"": ""2.0.3"",
        ""enshrined/svg-sanitize"": ""0.15.0"",
        ""erusev/parsedown"": ""1.7.4"",
        ""ezyang/htmlpurifier"": ""*"",
@@ -169,6 +169,7 @@
                ""blade-ui-kit/blade-ui-kit"",
                ""blade-ui-kit/blade-icons"",
                ""laravel/passport"",
                ""laravel/passport"",
                ""laravel/sanctum"",
                ""laravel/cashier"",
                ""laravel/fortify"",
15
composer.lock
Load diff
Some generated files are not rendered by default. Learn more about how customized files appear on GitHub.",,
https://huntr.dev/bounties/71fe4b3b-20ac-448c-8191-7b99d7ffaf55/,RCE by Server Side Template Injection in microweber/microweber,"Hi, During my testing, I discovered that it is possible to inject code into the system through the ""first name"" field.",,CWE-77: Command Injection,https://www.github.com/microweber/microweber/commit/93a906d0bf096c3ab1674012a90c88d101e76c8d,"@@ -18,6 +18,8 @@ public function handle(Request $request, Closure $next)
            array_walk_recursive($input, function (&$input) use ($clean) {
                if (is_string($input)) {
                    $input = $clean->clean($input);


                }
            });
        }

","2
src/MicroweberPackages/App/Http/Middleware/XSS.php
@@ -18,6 +18,8 @@ public function handle(Request $request, Closure $next)
            array_walk_recursive($input, function (&$input) use ($clean) {
                if (is_string($input)) {
                    $input = $clean->clean($input);
                    // clean also blade curly braces
                    $input = str_replace(['{{', '}}'], ['&#123;&#123;', '&#125;&#125;'], $input);
                }
            });
        }",,
https://huntr.dev/bounties/d5ebc2bd-8638-41c4-bf72-7c906c601344/,Stored XSS From Visitor to Acc Takeover in microweber/microweber,Using X-Forwarded-For Header Visitor can manipulate ip to trigger xss,,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/microweber/microweber/commit/8d039de2d615956f6df8df0bb1045ff3be88f183,"@@ -4,10 +4,11 @@
function user_ip()
{
    $ipaddress = '127.0.0.1';


    if (isset($_SERVER['HTTP_CF_CONNECTING_IP'])) {
        $ipaddress = $_SERVER['HTTP_CF_CONNECTING_IP'];
    }  else if (isset($_SERVER['HTTP_CLIENT_IP'])) {
        $ipaddress = $_SERVER['HTTP_CLIENT_IP'];
    } else if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {
        $ipaddress = $_SERVER['HTTP_X_FORWARDED_FOR'];
@@ -25,6 +26,15 @@ function user_ip()
        $ipaddress = $_SERVER['REMOTE_ADDR'];
    }










    return $ipaddress;
}

@@ -241,7 +251,7 @@ function only_admin_access()

function is_admin()
{
    if(app()->bound('user_manager')){
        return app()->user_manager->is_admin();
    }
}
@@ -264,12 +274,12 @@ function is_live_edit()
        return true;
    }

    $editModeParam2 = app()->url_manager->param('editmode',true);
    if ($editModeParam2 == 'y') {
        return true;
    }

    if(defined('IN_EDIT') and IN_EDIT){
        return true;
    }

@@ -334,16 +344,16 @@ function get_users($params = false)
 *
 * get_user get the user info from the DB
 *
 * @category users
 *
 * @author   Microweber
 *

 * @link     http://microweber.com
 *
 * @param bool $id
 *

 *
 * @return array
 */
function get_user($id = false)
{
@@ -363,7 +373,7 @@ function user_can_access($permission)
    }

    return false;
   // return $user->can($permission);
}

function module_permissions($module)
@@ -374,7 +384,7 @@ function module_permissions($module)

function user_can_destroy_module($module)
{
 //   $permissions = \MicroweberPackages\Role\Repositories\Permission::generateModulePermissionsSlugs($module);

    $user = \Illuminate\Support\Facades\Auth::user();
    if (!$user) {
@@ -385,9 +395,9 @@ function user_can_destroy_module($module)
        return true;
    }

   /* if ($user->can($permissions['destroy'])) {
        return true;
    }*/

    return false;
}
@@ -406,17 +416,17 @@ function user_can_view_module($module)
        return true;
    }

 /*   if ($user->can($permissions['index'])) {
        return true;
    }*/

    return false;

}



function detect_user_id_from_params($params){

    if (!empty($params)) {
        if (isset($params['username']) || isset($params['email'])) {

@@ -80,7 +80,9 @@ function process_buffer($track_data = false)
                $browser_id = false;
                $language = false;

                if (isset($item['language']) and $item['language']) {


                    $language = $item['language'];
                }
                if (isset($item['browser_agent']) and $item['browser_agent']) {
@@ -256,9 +258,11 @@ private function _collect_user_data()
                $ref = $_POST['referrer'];
            }
        }


        if ($last_page) {


            $last_page = rtrim($last_page, '?');
            $last_page = rtrim($last_page, '#');
        }

","46
src/MicroweberPackages/User/helpers/helpers.php
@@ -4,10 +4,11 @@
function user_ip()
{
    $ipaddress = '127.0.0.1';
    $ipaddressDefault = '127.0.0.1';

    if (isset($_SERVER['HTTP_CF_CONNECTING_IP'])) {
        $ipaddress = $_SERVER['HTTP_CF_CONNECTING_IP'];
    }  else if (isset($_SERVER['HTTP_CLIENT_IP'])) {
    } else if (isset($_SERVER['HTTP_CLIENT_IP'])) {
        $ipaddress = $_SERVER['HTTP_CLIENT_IP'];
    } else if (isset($_SERVER['HTTP_X_FORWARDED_FOR'])) {
        $ipaddress = $_SERVER['HTTP_X_FORWARDED_FOR'];
@@ -25,6 +26,15 @@ function user_ip()
        $ipaddress = $_SERVER['REMOTE_ADDR'];
    }

    $ipv4_validation_regex = ""/^(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/"";
    $ipv6_validation_regex = ""/^(([0-9a-fA-F]{1,4}:){7,7}[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,7}:|([0-9a-fA-F]{1,4}:){1,6}:[0-9a-fA-F]{1,4}|([0-9a-fA-F]{1,4}:){1,5}(:[0-9a-fA-F]{1,4}){1,2}|([0-9a-fA-F]{1,4}:){1,4}(:[0-9a-fA-F]{1,4}){1,3}|([0-9a-fA-F]{1,4}:){1,3}(:[0-9a-fA-F]{1,4}){1,4}|([0-9a-fA-F]{1,4}:){1,2}(:[0-9a-fA-F]{1,4}){1,5}|[0-9a-fA-F]{1,4}:((:[0-9a-fA-F]{1,4}){1,6})|:((:[0-9a-fA-F]{1,4}){1,7}|:)|fe80:(:[0-9a-fA-F]{0,4}){0,4}%[0-9a-zA-Z]{1,}|::(ffff(:0{1,4}){0,1}:){0,1}((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])|([0-9a-fA-F]{1,4}:){1,4}:((25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9])\\.){3,3}(25[0-5]|(2[0-4]|1{0,1}[0-9]){0,1}[0-9]))$/"";

    if (!preg_match($ipv4_validation_regex, $ipaddress) and !preg_match($ipv6_validation_regex, $ipaddress)) {
        //invalid ip is sent, so we return default ip
        return $ipaddressDefault;
    }


    return $ipaddress;
}

@@ -241,7 +251,7 @@ function only_admin_access()

function is_admin()
{
    if(app()->bound('user_manager')){
    if (app()->bound('user_manager')) {
        return app()->user_manager->is_admin();
    }
}
@@ -264,12 +274,12 @@ function is_live_edit()
        return true;
    }

    $editModeParam2 = app()->url_manager->param('editmode',true);
    $editModeParam2 = app()->url_manager->param('editmode', true);
    if ($editModeParam2 == 'y') {
        return true;
    }

    if(defined('IN_EDIT') and IN_EDIT){
    if (defined('IN_EDIT') and IN_EDIT) {
        return true;
    }

@@ -334,16 +344,16 @@ function get_users($params = false)
 *
 * get_user get the user info from the DB
 *
 * @category users
 * @param bool $id
 *
 * @author   Microweber
 *
 * @return array
 * @link     http://microweber.com
 *
 * @param bool $id
 * @category users
 *
 * @author   Microweber
 *
 * @return array
 */
function get_user($id = false)
{
@@ -363,7 +373,7 @@ function user_can_access($permission)
    }

    return false;
   // return $user->can($permission);
    // return $user->can($permission);
}

function module_permissions($module)
@@ -374,7 +384,7 @@ function module_permissions($module)

function user_can_destroy_module($module)
{
 //   $permissions = \MicroweberPackages\Role\Repositories\Permission::generateModulePermissionsSlugs($module);
    //   $permissions = \MicroweberPackages\Role\Repositories\Permission::generateModulePermissionsSlugs($module);

    $user = \Illuminate\Support\Facades\Auth::user();
    if (!$user) {
@@ -385,9 +395,9 @@ function user_can_destroy_module($module)
        return true;
    }

   /* if ($user->can($permissions['destroy'])) {
        return true;
    }*/
    /* if ($user->can($permissions['destroy'])) {
         return true;
     }*/

    return false;
}
@@ -406,17 +416,17 @@ function user_can_view_module($module)
        return true;
    }

 /*   if ($user->can($permissions['index'])) {
        return true;
    }*/
    /*   if ($user->can($permissions['index'])) {
           return true;
       }*/

    return false;

}



function detect_user_id_from_params($params){
function detect_user_id_from_params($params)
{

    if (!empty($params)) {
        if (isset($params['username']) || isset($params['email'])) {
8
userfiles/modules/site_stats/src/Tracker.php
@@ -80,7 +80,9 @@ function process_buffer($track_data = false)
                $browser_id = false;
                $language = false;

                if (isset($item['language']) and $item['language']) {
                $item = array_map('strip_tags', $item);
                $item = array_map('e', $item);
                 if (isset($item['language']) and $item['language']) {
                    $language = $item['language'];
                }
                if (isset($item['browser_agent']) and $item['browser_agent']) {
@@ -256,9 +258,11 @@ private function _collect_user_data()
                $ref = $_POST['referrer'];
            }
        }

        $ref = e($ref);

        if ($last_page) {
            $last_page = e($last_page);

            $last_page = rtrim($last_page, '?');
            $last_page = rtrim($last_page, '#');
        }",,
https://huntr.dev/bounties/01d6ae23-3a8f-42a8-99f4-10246187d71b/,weak Password Policy while creating a new User with the Admin Account in thorsten/phpmyfaq,I was able to detect weak Password Policy while allowing an administrator to create a new account.,CVE-2023-1753,CWE-521: Weak Password Requirements,https://www.github.com/thorsten/phpmyfaq/commit/f612a72494080e04947da7028340fee4493fe8a5,"@@ -143,6 +143,8 @@
                if (strlen($userPassword) <= 7 || strlen($userPasswordConfirm) <= 7) {
                    $errorMessage[] = $PMF_LANG['ad_passwd_fail'];
                }


            }

            if (count($errorMessage) === 0) {

","2
phpmyfaq/admin/ajax.user.php
@@ -143,6 +143,8 @@
                if (strlen($userPassword) <= 7 || strlen($userPasswordConfirm) <= 7) {
                    $errorMessage[] = $PMF_LANG['ad_passwd_fail'];
                }
            } else {
                $userPassword = ''; // set password to empty, so a new one is created
            }

            if (count($errorMessage) === 0) {",,
https://huntr.dev/bounties/e495b443-b328-42f5-aed5-d68b929b4cb9/,stored XSS after XSS Filter Bypass through exporting an HTML-Document in thorsten/phpmyfaq,After mitigation of all submitted XSS Vulnerabilities i was able to detect another XSS and bypass the XSS Filters in the FAQ Site while generating an HTML Export.,CVE-2023-1756,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/thorsten/phpmyfaq/commit/ca75f4688a8b0f14d5d0697b9f4b6ea66088f726,"@@ -93,6 +93,10 @@ public function generate(int $categoryId = 0, bool $downwards = true, string $la
        $this->xml->startElement('meta');
        $this->xml->writeAttribute('charset', 'utf-8');
        $this->xml->endElement();




        $this->xml->endElement(); // </head>

        $this->xml->startElement('body');

","4
phpmyfaq/src/phpMyFAQ/Export/Html5.php
@@ -93,6 +93,10 @@ public function generate(int $categoryId = 0, bool $downwards = true, string $la
        $this->xml->startElement('meta');
        $this->xml->writeAttribute('charset', 'utf-8');
        $this->xml->endElement();
        $this->xml->startElement('meta');
        $this->xml->writeAttribute('http-equiv', 'Content-Security-Policy');
        $this->xml->writeAttribute('content', 'default-src \'self\'; img-src https://*; child-src \'none\';');
        $this->xml->endElement();
        $this->xml->endElement(); // </head>

        $this->xml->startElement('body');",,
https://huntr.dev/bounties/584a200a-6ff8-4d53-a3c0-e7893edff60c/,XSS in hyperlink when create FAQ News in thorsten/phpmyfaq,"Stored Cross-Site Scripting (XSS) through hyperlinks refers to a type of security vulnerability that occurs when an attacker injects malicious code into a hyperlink, which is then stored in the application's database or web server. When a user clicks on the infected hyperlink, the malicious script is executed in the user's browser, allowing the attacker to steal sensitive information, modify the appearance of the website, deliver malware, and perform other malicious actions.",CVE-2023-1757,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/thorsten/phpmyfaq/commit/5061e5841be6c218ebb0de0cbf7b7f195dc46d19,"@@ -47,7 +47,8 @@

        <div class=""row"">
            <div class=""col-12"">
                <form id=""faqEditor"" name=""faqEditor"" action=""?action=save-news"" method=""post"" novalidate>


                    <div class=""form-group row"">
                        <label class=""col-3 col-form-label"" for=""newsheader"">
@@ -112,7 +113,7 @@
                    <div class=""form-group row"">
                        <label class=""col-3 col-form-label"" for=""link""><?= $PMF_LANG['ad_news_link_url'] ?></label>
                        <div class=""col-9"">
                            <input class=""form-control"" type=""text"" name=""link"" id=""link""
                            placeholder=""http://www.example.com/"">
                        </div>
                    </div>
@@ -256,7 +257,8 @@

        <div class=""row"">
            <div class=""col-12"">
                <form  action=""?action=update-news"" method=""post"" accept-charset=""utf-8"">

                    <input type=""hidden"" name=""id"" value=""<?= $newsData['id'] ?>"">

                    <div class=""form-group row"">
@@ -328,7 +330,7 @@
                    <div class=""form-group row"">
                        <label class=""col-3 col-form-label"" for=""link""><?= $PMF_LANG['ad_news_link_url'] ?></label>
                        <div class=""col-9"">
                            <input type=""text"" id=""link"" name=""link""
                            value=""<?= Strings::htmlentities($newsData['link']) ?>"" class=""form-control"">
                        </div>
                    </div>
@@ -449,8 +451,8 @@
    $email = Filter::filterInput(INPUT_POST, 'authorEmail', FILTER_VALIDATE_EMAIL);
    $active = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_SANITIZE_SPECIAL_CHARS);
    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_SANITIZE_SPECIAL_CHARS);
    $newsLang = Filter::filterInput(INPUT_POST, 'langTo', FILTER_UNSAFE_RAW);
    $target = Filter::filterInput(INPUT_POST, 'target', FILTER_UNSAFE_RAW);

@@ -500,8 +502,8 @@
    $email = Filter::filterInput(INPUT_POST, 'authorEmail', FILTER_VALIDATE_EMAIL);
    $active = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_UNSAFE_RAW);
    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_UNSAFE_RAW);
    $newsLang = Filter::filterInput(INPUT_POST, 'langTo', FILTER_UNSAFE_RAW);
    $target = Filter::filterInput(INPUT_POST, 'target', FILTER_UNSAFE_RAW);


@@ -95,7 +95,7 @@ public function getNews(bool $showArchive = false, bool $active = true): string
                    $this->pmfLang['msgInfo'],
                    Strings::htmlentities($item['link']),
                    $item['target'],
                    $item['linkTitle']
                );
            }


","18
phpmyfaq/admin/news.php
@@ -47,7 +47,8 @@

        <div class=""row"">
            <div class=""col-12"">
                <form id=""faqEditor"" name=""faqEditor"" action=""?action=save-news"" method=""post"" novalidate>
                <form id=""faqEditor"" name=""faqEditor"" action=""?action=save-news"" method=""post"" class=""needs-validation""
                      novalidate>

                    <div class=""form-group row"">
                        <label class=""col-3 col-form-label"" for=""newsheader"">
@@ -112,7 +113,7 @@
                    <div class=""form-group row"">
                        <label class=""col-3 col-form-label"" for=""link""><?= $PMF_LANG['ad_news_link_url'] ?></label>
                        <div class=""col-9"">
                            <input class=""form-control"" type=""text"" name=""link"" id=""link""
                            <input class=""form-control"" type=""url"" name=""link"" id=""link""
                            placeholder=""http://www.example.com/"">
                        </div>
                    </div>
@@ -256,7 +257,8 @@

        <div class=""row"">
            <div class=""col-12"">
                <form  action=""?action=update-news"" method=""post"" accept-charset=""utf-8"">
                <form action=""?action=update-news"" method=""post"" accept-charset=""utf-8"" class=""needs-validation""
                      novalidate>
                    <input type=""hidden"" name=""id"" value=""<?= $newsData['id'] ?>"">

                    <div class=""form-group row"">
@@ -328,7 +330,7 @@
                    <div class=""form-group row"">
                        <label class=""col-3 col-form-label"" for=""link""><?= $PMF_LANG['ad_news_link_url'] ?></label>
                        <div class=""col-9"">
                            <input type=""text"" id=""link"" name=""link""
                            <input type=""url"" id=""link"" name=""link""
                            value=""<?= Strings::htmlentities($newsData['link']) ?>"" class=""form-control"">
                        </div>
                    </div>
@@ -449,8 +451,8 @@
    $email = Filter::filterInput(INPUT_POST, 'authorEmail', FILTER_VALIDATE_EMAIL);
    $active = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_SANITIZE_SPECIAL_CHARS);
    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_SANITIZE_SPECIAL_CHARS);
    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_VALIDATE_URL);
    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_SANITIZE_ENCODED);
    $newsLang = Filter::filterInput(INPUT_POST, 'langTo', FILTER_UNSAFE_RAW);
    $target = Filter::filterInput(INPUT_POST, 'target', FILTER_UNSAFE_RAW);

@@ -500,8 +502,8 @@
    $email = Filter::filterInput(INPUT_POST, 'authorEmail', FILTER_VALIDATE_EMAIL);
    $active = Filter::filterInput(INPUT_POST, 'active', FILTER_UNSAFE_RAW);
    $comment = Filter::filterInput(INPUT_POST, 'comment', FILTER_UNSAFE_RAW);
    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_UNSAFE_RAW);
    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_UNSAFE_RAW);
    $link = Filter::filterInput(INPUT_POST, 'link', FILTER_VALIDATE_URL);
    $linkTitle = Filter::filterInput(INPUT_POST, 'linkTitle', FILTER_SANITIZE_ENCODED);
    $newsLang = Filter::filterInput(INPUT_POST, 'langTo', FILTER_UNSAFE_RAW);
    $target = Filter::filterInput(INPUT_POST, 'target', FILTER_UNSAFE_RAW);

2
phpmyfaq/src/phpMyFAQ/News.php
@@ -95,7 +95,7 @@ public function getNews(bool $showArchive = false, bool $active = true): string
                    $this->pmfLang['msgInfo'],
                    Strings::htmlentities($item['link']),
                    $item['target'],
                    $item['linkTitle']
                    Strings::htmlentities($item['linkTitle'])
                );
            }",,
https://huntr.dev/bounties/b7d244b7-5ac3-4964-81ee-8dbb5bb5e33a/,Captcha Bypass allows sending unlimited Comments in thorsten/phpmyfaq,I identified a CAPTCHA Bypass after trying many Posts in the Comments Section.,,CWE-294: Authentication Bypass by Capture-replay,https://www.github.com/thorsten/phpmyfaq/commit/27eaaae16850694634ac52416a0bd38b35d7330a,"@@ -116,8 +116,8 @@
$captcha->setUserIsLoggedIn($isLoggedIn);

if (
'savevoting' !== $action && 'saveuserdata' !== $action && 'changepassword' !== $action && !is_null($code) &&
    !$captcha->checkCaptchaCode($code)
) {
    $message = ['error' => $PMF_LANG['msgCaptcha']];
}

@@ -155,7 +155,7 @@
$PMF_LANG['err_noTopTen'] = ""Derzeit sind keine beliebten FAQs verfgbar."";
$PMF_LANG['err_nothingFound'] = ""Es wurde kein Eintrag gefunden."";
$PMF_LANG['err_SaveEntries'] = ""Pflichtfelder sind <strong>Name</strong>, <strong>E-Mail-Adresse</strong>, <strong>Kategorie</strong>, <strong>Frage</strong> und <strong>Antwort</strong>!"";
$PMF_LANG['err_SaveComment'] = ""Pflichtfelder sind <strong>Name</strong>, <strong>E-Mail-Adresse</strong> und <strong>Kommentar</strong>!"";
$PMF_LANG['err_VoteTooMuch'] = ""Leider konnte die Bewertung nicht gespeichert werden, da mit der IP bereits bewertet wurde."";
$PMF_LANG['err_noVote'] = ""Es wurde keine Bewertung abgegeben!"";
$PMF_LANG['err_noMailAdress'] = ""Die angegebene E-Mail-Adresse ist nicht korrekt."";

@@ -491,10 +491,10 @@ private function drawText()
     * This function checks the provided captcha code
     * if the captcha code spam protection has been activated from the general PMF configuration.
     *
     * @param string $code Captcha Code
     * @return bool
     */
    public function checkCaptchaCode(string $code): bool
    {
        if ($this->isUserIsLoggedIn()) {
            return true;

","4
phpmyfaq/ajaxservice.php
@@ -116,8 +116,8 @@
$captcha->setUserIsLoggedIn($isLoggedIn);

if (
'savevoting' !== $action && 'saveuserdata' !== $action && 'changepassword' !== $action && !is_null($code) &&
    !$captcha->checkCaptchaCode($code)
    'savevoting' !== $action && 'saveuserdata' !== $action && 'changepassword' !== $action &&
    !$captcha->checkCaptchaCode($code ?? '')
) {
    $message = ['error' => $PMF_LANG['msgCaptcha']];
}
2
phpmyfaq/lang/language_de.php
@@ -155,7 +155,7 @@
$PMF_LANG['err_noTopTen'] = ""Derzeit sind keine beliebten FAQs verfgbar."";
$PMF_LANG['err_nothingFound'] = ""Es wurde kein Eintrag gefunden."";
$PMF_LANG['err_SaveEntries'] = ""Pflichtfelder sind <strong>Name</strong>, <strong>E-Mail-Adresse</strong>, <strong>Kategorie</strong>, <strong>Frage</strong> und <strong>Antwort</strong>!"";
$PMF_LANG['err_SaveComment'] = ""Pflichtfelder sind <strong>Name</strong>, <strong>E-Mail-Adresse</strong> und <strong>Kommentar</strong>!"";
$PMF_LANG['err_SaveComment'] = ""Pflichtfelder sind Name, E-Mail-Adresse und Kommentar!"";
$PMF_LANG['err_VoteTooMuch'] = ""Leider konnte die Bewertung nicht gespeichert werden, da mit der IP bereits bewertet wurde."";
$PMF_LANG['err_noVote'] = ""Es wurde keine Bewertung abgegeben!"";
$PMF_LANG['err_noMailAdress'] = ""Die angegebene E-Mail-Adresse ist nicht korrekt."";
4
phpmyfaq/src/phpMyFAQ/Captcha.php
@@ -491,10 +491,10 @@ private function drawText()
     * This function checks the provided captcha code
     * if the captcha code spam protection has been activated from the general PMF configuration.
     *
     * @param string $code Captcha Code
     * @param string|null $code Captcha Code
     * @return bool
     */
    public function checkCaptchaCode(string $code): bool
    public function checkCaptchaCode(string $code = null): bool
    {
        if ($this->isUserIsLoggedIn()) {
            return true;",,
https://huntr.dev/bounties/882ffa07-5397-4dbb-886f-4626859d711a/,Stored XSS on Configuration Version in thorsten/phpmyfaq,"In a form version that appears to have no validation, it means that the website or application is not properly checking user inputs for malicious code before storing it in the database. This lack of validation allows an attacker to inject their own malicious script, which can then be executed by other users who access the affected page. This can lead to sensitive information being stolen, unauthorized actions being taken, and a variety of other security risks.",CVE-2023-1755,CWE-79: Cross-site Scripting (XSS) - Generic,https://www.github.com/thorsten/phpmyfaq/commit/2156573100fd3abf4c65270def77aed20ffc8994,"@@ -52,7 +52,10 @@

        // Special checks
        if (isset($editData['edit']['main.enableMarkdownEditor'])) {
            $editData['edit']['main.enableWysiwygEditor'] = false; // Disable WYSIWG editor if Markdown is enabled



        }

        foreach ($editData['edit'] as $key => $value) {

","5
phpmyfaq/admin/configuration.php
@@ -52,7 +52,10 @@

        // Special checks
        if (isset($editData['edit']['main.enableMarkdownEditor'])) {
            $editData['edit']['main.enableWysiwygEditor'] = false; // Disable WYSIWG editor if Markdown is enabled
            $editData['edit']['main.enableWysiwygEditor'] = false; // Disable WYSIWYG editor if Markdown is enabled
        }
        if (isset($editData['edit']['main.currentVersion'])) {
            unset($editData['edit']['main.currentVersion']); // don't update the version number
        }

        foreach ($editData['edit'] as $key => $value) {",,
https://huntr.dev/bounties/39715aaf-e798-4c60-97c4-45f4f2cd5c61/,stored XSS Protection bypass by changing the User Profile Name in thorsten/phpmyfaq,I was able to bypass the XSS Vulnerability i reported before by using this Payload.,,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/thorsten/phpmyfaq/commit/dcf7dd43a3412aa951d7087b86a8b917fae2133a,"@@ -114,9 +114,9 @@
            $message .= sprintf('<p class=""alert alert-danger"">%s</p>', $PMF_LANG['ad_user_error_noId']);
        } else {
            $userData = [];
            $userData['display_name'] = Filter::filterInput(INPUT_POST, 'display_name', FILTER_UNSAFE_RAW);
            $userData['email'] = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
            $userData['last_modified'] = Filter::filterInput(INPUT_POST, 'last_modified', FILTER_UNSAFE_RAW);
            $userStatus = Filter::filterInput(INPUT_POST, 'user_status', FILTER_UNSAFE_RAW, $defaultUserStatus);
            $isSuperAdmin = Filter::filterInput(INPUT_POST, 'is_superadmin', FILTER_UNSAFE_RAW);
            $isSuperAdmin = $isSuperAdmin === 'on';

","4
phpmyfaq/admin/user.php
@@ -114,9 +114,9 @@
            $message .= sprintf('<p class=""alert alert-danger"">%s</p>', $PMF_LANG['ad_user_error_noId']);
        } else {
            $userData = [];
            $userData['display_name'] = Filter::filterInput(INPUT_POST, 'display_name', FILTER_UNSAFE_RAW);
            $userData['display_name'] = Filter::filterInput(INPUT_POST, 'display_name', FILTER_SANITIZE_SPECIAL_CHARS);
            $userData['email'] = Filter::filterInput(INPUT_POST, 'email', FILTER_VALIDATE_EMAIL);
            $userData['last_modified'] = Filter::filterInput(INPUT_POST, 'last_modified', FILTER_UNSAFE_RAW);
            $userData['last_modified'] = Filter::filterInput(INPUT_POST, 'last_modified', FILTER_SANITIZE_SPECIAL_CHARS);
            $userStatus = Filter::filterInput(INPUT_POST, 'user_status', FILTER_UNSAFE_RAW, $defaultUserStatus);
            $isSuperAdmin = Filter::filterInput(INPUT_POST, 'is_superadmin', FILTER_UNSAFE_RAW);
            $isSuperAdmin = $isSuperAdmin === 'on';",,
https://huntr.dev/bounties/529f2361-eb2e-476f-b7ef-4e561a712e28/,XSS @ group in thorsten/phpmyfaq,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,CVE-2023-1754,CWE-20: Improper Input Validation,https://www.github.com/thorsten/phpmyfaq/commit/d773df925cb74e874527458beed1f66f966ec491,"@@ -18,6 +18,7 @@
 */

use phpMyFAQ\Filter;

use phpMyFAQ\User;
use phpMyFAQ\User\CurrentUser;

@@ -171,7 +172,7 @@
        <div class=""col-lg-12"">
          <h2 class=""page-header"">
            <i aria-hidden=""true"" class=""fa fa-users fa-fw""></i>
              <?= $PMF_LANG['ad_group_deleteGroup'] ?> ""<?= $groupData['name'] ?>""
          </h2>
        </div>
      </header>
@@ -226,8 +227,8 @@
    $user = new User($faqConfig);
    $message = '';
    $messages = [];
    $groupName = Filter::filterInput(INPUT_POST, 'group_name', FILTER_UNSAFE_RAW, '');
    $groupDescription = Filter::filterInput(INPUT_POST, 'group_description', FILTER_UNSAFE_RAW, '');
    $groupAutoJoin = Filter::filterInput(INPUT_POST, 'group_auto_join', FILTER_UNSAFE_RAW, '');
    $csrfOkay = true;
    $csrfToken = Filter::filterInput(INPUT_POST, 'csrf', FILTER_UNSAFE_RAW);
@@ -236,7 +237,7 @@
        $csrfOkay = false;
    }
    // check group name
    if ($groupName == '') {
        $messages[] = $PMF_LANG['ad_group_error_noName'];
    }
    // ok, let's go
@@ -336,60 +337,6 @@
    <?php
}

// Import LDAP groups
/*
if ('import-ldap-groups' === $groupAction && $user->perm->hasPermission($user->getUserId(), 'addgroup')) {
    $user = new CurrentUser($faqConfig);
    $message = '';
    $messages = [];

    // Temporary data
    $groupName = 'LDAP Group';
    $groupDescription = 'This is a LDAP group import demo';
    $groupAutoJoin = false;

    $csrfOkay = true;
    $csrfToken = Filter::filterInput(INPUT_POST, 'csrf', FILTER_UNSAFE_RAW);

    if (!isset($_SESSION['phpmyfaq_csrf_token']) || $_SESSION['phpmyfaq_csrf_token'] !== $csrfToken) {
        $csrfOkay = false;
    }

    // check group name
    if ($groupName == '') {
        $messages[] = $PMF_LANG['ad_group_error_noName'];
    }

    // ok, let's go
    if (count($messages) == 0 && $csrfOkay) {
        // create group
        $groupData = [
            'name' => $groupName,
            'description' => $groupDescription,
            'auto_join' => $groupAutoJoin,
        ];

        if ($user->perm->addGroup($groupData) <= 0) {
            $messages[] = $PMF_LANG['ad_adus_dberr'];
        }
    }

    // no errors, show list
    if (count($messages) == 0) {
        $groupAction = $defaultGroupAction;
        $message = sprintf('<p class=""alert alert-success"">%s</p>', $PMF_LANG['ad_group_suc']);
        // display error messages and show form again
    } else {
        $groupAction = 'import-ldap-groups';
        $message = '<p class=""alert alert-danger"">';
        foreach ($messages as $err) {
            $message .= $err . '<br>';
        }
        $message .= '</p>';
    }
}
*/

// show list of users
if ('list' === $groupAction) {
    ?>
@@ -416,20 +363,6 @@

    <div class=""col-lg-4"" id=""group_list"">

      <!--
      <div class=""card mb-4"">
        <div class=""card-header py-3"">
          <form id=""group-import-ldap-groups"" method=""post""
                name=""group-import-ldap-groups"" action=""?action=group&amp;group_action=import-ldap-groups"">
            <input type=""hidden"" name=""csrf"" value=""<?= $currentUser->getCsrfTokenFromSession() ?>"">
            <button class=""btn btn-success"" type=""submit"">
              Import LDAP groups
            </button>
          </form>
        </div>
      </div>
      -->

      <div class=""card mb-4"">
        <form id=""group_select"" name=""group_select"" action=""?action=group&amp;group_action=delete_confirm""
              method=""post"">

","77
phpmyfaq/admin/group.php
@@ -18,6 +18,7 @@
 */

use phpMyFAQ\Filter;
use phpMyFAQ\Strings;
use phpMyFAQ\User;
use phpMyFAQ\User\CurrentUser;

@@ -171,7 +172,7 @@
        <div class=""col-lg-12"">
          <h2 class=""page-header"">
            <i aria-hidden=""true"" class=""fa fa-users fa-fw""></i>
              <?= $PMF_LANG['ad_group_deleteGroup'] ?> ""<?= $groupData['name'] ?>""
              <?= $PMF_LANG['ad_group_deleteGroup'] ?> ""<?= Strings::htmlentities($groupData['name']) ?>""
          </h2>
        </div>
      </header>
@@ -226,8 +227,8 @@
    $user = new User($faqConfig);
    $message = '';
    $messages = [];
    $groupName = Filter::filterInput(INPUT_POST, 'group_name', FILTER_UNSAFE_RAW, '');
    $groupDescription = Filter::filterInput(INPUT_POST, 'group_description', FILTER_UNSAFE_RAW, '');
    $groupName = Filter::filterInput(INPUT_POST, 'group_name', FILTER_SANITIZE_SPECIAL_CHARS, '');
    $groupDescription = Filter::filterInput(INPUT_POST, 'group_description', FILTER_SANITIZE_SPECIAL_CHARS, '');
    $groupAutoJoin = Filter::filterInput(INPUT_POST, 'group_auto_join', FILTER_UNSAFE_RAW, '');
    $csrfOkay = true;
    $csrfToken = Filter::filterInput(INPUT_POST, 'csrf', FILTER_UNSAFE_RAW);
@@ -236,7 +237,7 @@
        $csrfOkay = false;
    }
    // check group name
    if ($groupName == '') {
    if ($groupName === '') {
        $messages[] = $PMF_LANG['ad_group_error_noName'];
    }
    // ok, let's go
@@ -336,60 +337,6 @@
    <?php
}

// Import LDAP groups
/*
if ('import-ldap-groups' === $groupAction && $user->perm->hasPermission($user->getUserId(), 'addgroup')) {
    $user = new CurrentUser($faqConfig);
    $message = '';
    $messages = [];
    // Temporary data
    $groupName = 'LDAP Group';
    $groupDescription = 'This is a LDAP group import demo';
    $groupAutoJoin = false;
    $csrfOkay = true;
    $csrfToken = Filter::filterInput(INPUT_POST, 'csrf', FILTER_UNSAFE_RAW);
    if (!isset($_SESSION['phpmyfaq_csrf_token']) || $_SESSION['phpmyfaq_csrf_token'] !== $csrfToken) {
        $csrfOkay = false;
    }
    // check group name
    if ($groupName == '') {
        $messages[] = $PMF_LANG['ad_group_error_noName'];
    }
    // ok, let's go
    if (count($messages) == 0 && $csrfOkay) {
        // create group
        $groupData = [
            'name' => $groupName,
            'description' => $groupDescription,
            'auto_join' => $groupAutoJoin,
        ];
        if ($user->perm->addGroup($groupData) <= 0) {
            $messages[] = $PMF_LANG['ad_adus_dberr'];
        }
    }
    // no errors, show list
    if (count($messages) == 0) {
        $groupAction = $defaultGroupAction;
        $message = sprintf('<p class=""alert alert-success"">%s</p>', $PMF_LANG['ad_group_suc']);
        // display error messages and show form again
    } else {
        $groupAction = 'import-ldap-groups';
        $message = '<p class=""alert alert-danger"">';
        foreach ($messages as $err) {
            $message .= $err . '<br>';
        }
        $message .= '</p>';
    }
}
*/

// show list of users
if ('list' === $groupAction) {
    ?>
@@ -416,20 +363,6 @@

    <div class=""col-lg-4"" id=""group_list"">

      <!--
      <div class=""card mb-4"">
        <div class=""card-header py-3"">
          <form id=""group-import-ldap-groups"" method=""post""
                name=""group-import-ldap-groups"" action=""?action=group&amp;group_action=import-ldap-groups"">
            <input type=""hidden"" name=""csrf"" value=""<?= $currentUser->getCsrfTokenFromSession() ?>"">
            <button class=""btn btn-success"" type=""submit"">
              Import LDAP groups
            </button>
          </form>
        </div>
      </div>
      -->

      <div class=""card mb-4"">
        <form id=""group_select"" name=""group_select"" action=""?action=group&amp;group_action=delete_confirm""
              method=""post"">",,
https://huntr.dev/bounties/3c2374cc-7082-44b7-a6a6-ccff7a650a3a/,Privilege escalation from user with "add user" to super admin in thorsten/phpmyfaq,"Before I created this submission, I read this report: https://huntr.dev/bounties/258cd498-7275-4b12-ac73-79c9ba3e58e4/. I was afraid that my submission would be a duplicate of that. After reading it carefully, I decided to make a report because my report is not exploiting the backup file feature, but it pure from an admin mistake.",CVE-2023-1762,CWE-269: Improper Privilege Management,https://www.github.com/thorsten/phpmyfaq/commit/ae6c1d8c3eab05d6e2227c7a9998707f4f891514,"@@ -121,6 +121,10 @@
            $isSuperAdmin = Filter::filterInput(INPUT_POST, 'is_superadmin', FILTER_UNSAFE_RAW);
            $isSuperAdmin = $isSuperAdmin === 'on';





            // Sanity check
            if (is_null($userData['email'])) {
                $message .= sprintf('<p class=""alert alert-danger"">%s</p>', $PMF_LANG['err_noMailAdress']);
@@ -705,6 +709,7 @@ class=""form-control"">
              </div>
            </div>


            <div class=""form-group row"">
              <div class=""col-lg-4""></div>
              <div class=""col-lg-8"">
@@ -716,6 +721,7 @@ class=""form-control"">
                </div>
              </div>
            </div>


          </form>
        </div>

","6
phpmyfaq/admin/user.php
@@ -121,6 +121,10 @@
            $isSuperAdmin = Filter::filterInput(INPUT_POST, 'is_superadmin', FILTER_UNSAFE_RAW);
            $isSuperAdmin = $isSuperAdmin === 'on';

            if (!$user->isSuperAdmin()) {
                $isSuperAdmin = false;
            }

            // Sanity check
            if (is_null($userData['email'])) {
                $message .= sprintf('<p class=""alert alert-danger"">%s</p>', $PMF_LANG['err_noMailAdress']);
@@ -705,6 +709,7 @@ class=""form-control"">
              </div>
            </div>

            <?php if ($user->isSuperAdmin()) { ?>
            <div class=""form-group row"">
              <div class=""col-lg-4""></div>
              <div class=""col-lg-8"">
@@ -716,6 +721,7 @@ class=""form-control"">
                </div>
              </div>
            </div>
            <?php } ?>

          </form>
        </div>",,
https://huntr.dev/bounties/8ab09a1c-cfd5-4ce0-aae3-d33c93318957/,Stored XSS edit Config Link in thorsten/phpmyfaq,"Stored Cross-Site Scripting (XSS) through hyperlinks refers to a type of security vulnerability that occurs when an attacker injects malicious code into a hyperlink, which is then stored in the application's database or web server. When a user clicks on the infected hyperlink, the malicious script is executed in the user's browser, allowing the attacker to steal sensitive information, modify the appearance of the website, deliver malware, and perform other malicious actions.",,CWE-79: Cross-site Scripting (XSS) - DOM,https://www.github.com/thorsten/phpmyfaq/commit/49db615c300ae0f87795f20570f6f5bdccb1d2f2,"@@ -49,7 +49,7 @@
        'msgContactOwnText' => nl2br(Strings::htmlspecialchars($faqConfig->get('main.contactInformations'))),
        'msgContactEMail' => $PMF_LANG['msgContactEMail'],
        'msgContactPrivacyNote' => $PMF_LANG['msgContactPrivacyNote'],
        'privacyURL' => $faqConfig->get('main.privacyURL'),
        'msgPrivacyNote' => $PMF_LANG['msgPrivacyNote'],
        'msgNewContentName' => $PMF_LANG['msgNewContentName'],
        'msgNewContentMail' => $PMF_LANG['msgNewContentMail'],

@@ -619,7 +619,7 @@
        'msgGlossary' => '<a href=""./glossary.html"">' . $PMF_LANG['ad_menu_glossary'] . '</a>',
        'privacyLink' => sprintf(
            '<a target=""_blank"" href=""%s"">%s</a>',
            $faqConfig->get('main.privacyURL'),
            $PMF_LANG['msgPrivacyNote']
        ),
        'backToHome' => '<a href=""./index.html"">' . $PMF_LANG['msgHome'] . '</a>',
@@ -642,7 +642,7 @@
        'msgGlossary' => '<a href=""index.php?' . $sids . 'action=glossary"">' . $PMF_LANG['ad_menu_glossary'] . '</a>',
        'privacyLink' => sprintf(
            '<a target=""_blank"" href=""%s"">%s</a>',
            $faqConfig->get('main.privacyURL'),
            $PMF_LANG['msgPrivacyNote']
        ),
        'allCategories' => '<a class=""nav-link"" href=""index.php?' . $sids . 'action=show"">' .

@@ -18,6 +18,7 @@
use phpMyFAQ\Captcha;
use phpMyFAQ\Core\Exception;
use phpMyFAQ\Helper\CaptchaHelper;

use phpMyFAQ\User\CurrentUser;

if (!defined('IS_VALID_PHPMYFAQ')) {
@@ -50,7 +51,7 @@
        'msgContactRemove' => $PMF_LANG['msgContactRemove'],
        'msgContactPrivacyNote' => $PMF_LANG['msgContactPrivacyNote'],
        'msgPrivacyNote' => $PMF_LANG['msgPrivacyNote'],
        'privacyURL' => $faqConfig->get('main.privacyURL'),
        'msgNewContentName' => $PMF_LANG['msgNewContentName'],
        'msgNewContentMail' => $PMF_LANG['msgNewContentMail'],
        'ad_user_loginname' => $PMF_LANG['ad_user_loginname'],

","2
phpmyfaq/contact.php
@@ -49,7 +49,7 @@
        'msgContactOwnText' => nl2br(Strings::htmlspecialchars($faqConfig->get('main.contactInformations'))),
        'msgContactEMail' => $PMF_LANG['msgContactEMail'],
        'msgContactPrivacyNote' => $PMF_LANG['msgContactPrivacyNote'],
        'privacyURL' => $faqConfig->get('main.privacyURL'),
        'privacyURL' => Strings::htmlentities($faqConfig->get('main.privacyURL')),
        'msgPrivacyNote' => $PMF_LANG['msgPrivacyNote'],
        'msgNewContentName' => $PMF_LANG['msgNewContentName'],
        'msgNewContentMail' => $PMF_LANG['msgNewContentMail'],
4
phpmyfaq/index.php
@@ -619,7 +619,7 @@
        'msgGlossary' => '<a href=""./glossary.html"">' . $PMF_LANG['ad_menu_glossary'] . '</a>',
        'privacyLink' => sprintf(
            '<a target=""_blank"" href=""%s"">%s</a>',
            $faqConfig->get('main.privacyURL'),
            Strings::htmlentities($faqConfig->get('main.privacyURL')),
            $PMF_LANG['msgPrivacyNote']
        ),
        'backToHome' => '<a href=""./index.html"">' . $PMF_LANG['msgHome'] . '</a>',
@@ -642,7 +642,7 @@
        'msgGlossary' => '<a href=""index.php?' . $sids . 'action=glossary"">' . $PMF_LANG['ad_menu_glossary'] . '</a>',
        'privacyLink' => sprintf(
            '<a target=""_blank"" href=""%s"">%s</a>',
            $faqConfig->get('main.privacyURL'),
            Strings::htmlentities($faqConfig->get('main.privacyURL')),
            $PMF_LANG['msgPrivacyNote']
        ),
        'allCategories' => '<a class=""nav-link"" href=""index.php?' . $sids . 'action=show"">' .
3
phpmyfaq/request-removal.php
@@ -18,6 +18,7 @@
use phpMyFAQ\Captcha;
use phpMyFAQ\Core\Exception;
use phpMyFAQ\Helper\CaptchaHelper;
use phpMyFAQ\Strings;
use phpMyFAQ\User\CurrentUser;

if (!defined('IS_VALID_PHPMYFAQ')) {
@@ -50,7 +51,7 @@
        'msgContactRemove' => $PMF_LANG['msgContactRemove'],
        'msgContactPrivacyNote' => $PMF_LANG['msgContactPrivacyNote'],
        'msgPrivacyNote' => $PMF_LANG['msgPrivacyNote'],
        'privacyURL' => $faqConfig->get('main.privacyURL'),
        'privacyURL' => Strings::htmlentities($faqConfig->get('main.privacyURL')),
        'msgNewContentName' => $PMF_LANG['msgNewContentName'],
        'msgNewContentMail' => $PMF_LANG['msgNewContentMail'],
        'ad_user_loginname' => $PMF_LANG['ad_user_loginname'],",,
https://huntr.dev/bounties/ece5f051-674e-4919-b998-594714910f9e/,Reflected XSS in send2friend.php in thorsten/phpmyfaq,There is a reflected XSS in send2friend because the 'artlang' parameter is not sanitized.,,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/thorsten/phpmyfaq/commit/bbc5d4aa4a4375c14e34dd9fcad2042066fe476d,"@@ -65,7 +65,7 @@
$template->parse(
    'mainPageContent',
    [
        'lang' => $faqLanguage,
        'msgSend2Friend' => $PMF_LANG['msgSend2Friend'],
        'msgS2FReferrer' => 'link',
        'msgS2FName' => $PMF_LANG['msgS2FName'],

@@ -22,7 +22,6 @@
use phpMyFAQ\Date;
use phpMyFAQ\Export;
use phpMyFAQ\Faq;
use phpMyFAQ\Init;
use phpMyFAQ\Strings;
use XMLWriter;

@@ -108,7 +107,7 @@ public function generate(int $categoryId = 0, bool $downwards = true, string $la

                $this->xml->startElement('h2');
                $this->xml->writeAttribute('id', ""entry-"" . $data['solution_id']);
                $this->xml->text(strip_tags($data['topic']));
                $this->xml->endElement();
                $this->xml->startElement('p');
                $this->xml->writeCdata(html_entity_decode($data['content'], ENT_HTML5, 'UTF-8'));

","2
phpmyfaq/send2friend.php
@@ -65,7 +65,7 @@
$template->parse(
    'mainPageContent',
    [
        'lang' => $faqLanguage,
        'lang' => Strings::htmlentities($faqLanguage),
        'msgSend2Friend' => $PMF_LANG['msgSend2Friend'],
        'msgS2FReferrer' => 'link',
        'msgS2FName' => $PMF_LANG['msgS2FName'],
3
phpmyfaq/src/phpMyFAQ/Export/Html5.php
@@ -22,7 +22,6 @@
use phpMyFAQ\Date;
use phpMyFAQ\Export;
use phpMyFAQ\Faq;
use phpMyFAQ\Init;
use phpMyFAQ\Strings;
use XMLWriter;

@@ -108,7 +107,7 @@ public function generate(int $categoryId = 0, bool $downwards = true, string $la

                $this->xml->startElement('h2');
                $this->xml->writeAttribute('id', ""entry-"" . $data['solution_id']);
                $this->xml->text(strip_tags($data['topic']));
                $this->xml->text(Strings::htmlentities($data['topic']));
                $this->xml->endElement();
                $this->xml->startElement('p');
                $this->xml->writeCdata(html_entity_decode($data['content'], ENT_HTML5, 'UTF-8'));",,
https://huntr.dev/bounties/b3f8c480-f5df-4b29-8010-cd82a8e30fc2/,AWS credentials exposure in jgraph/drawio,"app.diagrams.net allow the insertion of PlantUML objects. This feature is using an old and misconfigured version of PlantUML (1.2022.6), therefore, it is possible to exploit dangerous functions such as %getenv to read environment variables in the machine where PlantUML is running.",,CWE-497: Exposure of Sensitive System Information to an Unauthorized Control Sphere,https://www.github.com/jgraph/drawio/commit/8d9a9926f9bbd2b5a1fa678dbae6194c76a27311,"@@ -1,3 +1,11 @@








23-MAR-2023: 21.1.1

- Fixes possible f.replace is not a function

@@ -10,7 +10,7 @@ The source code in this repo is licensed under the Apache v2.

The JGraph provided icons and diagram templates are licensed under the [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/). Additional terms may also apply where the icons are originally defined by a third-party copyright holder. We have checked in all cases that the original license allows use in this project. Also see the terms for using the draw.io logo below.

Additional minified JavaScript files and Java libraries are used in this project. All of the licenses are deemed compatible with the Apache 2.0, nothing is GPL or AGPL ,due dilgence is performed on all third-party code.

Scope of the Project
--------------------

@@ -1 +1 @@
21.1.1
@@ -1648,7 +1648,8 @@ var EditDataDialog = function(ui, cell)
  var name = nameInput.value;

  // Avoid ':' in attribute names which seems to be valid in Chrome
  if (name.length > 0 && name != 'label' && name != 'placeholders' && name.indexOf(':') < 0)

  {
   try
   {

@@ -12842,6 +12842,17 @@ if (typeof mxVertexHandler !== 'undefined')
   return result;
  };












  /**
   * Creates the shape used to draw the selection border.
   */

","8
ChangeLog
@@ -1,3 +1,11 @@
29-MAR-2023: 21.1.2

- Fixes handling of ctrl+shift+v on Mac [drawio-291]
- Fixes properties cannot be named id [drawio-3460]
- [vsdx]] Adds overflow=width to improve support label alignment [DID-7420]
- Fixes change of title size in tables [drawio-3468]
- Adds live preview for change of swimlane title size

23-MAR-2023: 21.1.1

- Fixes possible f.replace is not a function
2
README.md
@@ -10,7 +10,7 @@ The source code in this repo is licensed under the Apache v2.

The JGraph provided icons and diagram templates are licensed under the [CC BY 4.0](https://creativecommons.org/licenses/by/4.0/). Additional terms may also apply where the icons are originally defined by a third-party copyright holder. We have checked in all cases that the original license allows use in this project. Also see the terms for using the draw.io logo below.

Additional minified JavaScript files and Java libraries are used in this project. All of the licenses are deemed compatible with the Apache 2.0, nothing is GPL or AGPL ,due dilgence is performed on all third-party code.
Additional minified JavaScript files and Java libraries are used in this project. All of the licenses are deemed compatible with the Apache 2.0, nothing is GPL or AGPL, due dilgence is performed on all third-party code.

Scope of the Project
--------------------
2
VERSION
@@ -1 +1 @@
21.1.1
21.1.2
2,847
src/main/webapp/js/app.min.js
Load diff
Large diffs are not rendered by default.
1
src/main/webapp/js/diagramly/vsdx/importer.js
@@ -10379,6 +10379,7 @@ var com;
                            if (txtChildren != null) {
                                /* put */ (this.styleMap[mxConstants.STYLE_VERTICAL_ALIGN] = this.getAlignVertical());
                                /* put */ (this.styleMap[mxConstants.STYLE_ALIGN] = this.getHorizontalAlign(""0"", false));
                                this.styleMap['overflow'] = 'width';
                                return this.getHtmlTextContent(txtChildren);
                            }
                        }
4
src/main/webapp/js/extensions.min.js
Load diff
Some generated files are not rendered by default. Learn more about how customized files appear on GitHub.
3
src/main/webapp/js/grapheditor/Dialogs.js
@@ -1648,7 +1648,8 @@ var EditDataDialog = function(ui, cell)
  var name = nameInput.value;

  // Avoid ':' in attribute names which seems to be valid in Chrome
  if (name.length > 0 && name != 'label' && name != 'placeholders' && name.indexOf(':') < 0)
  if (name.length > 0 && name != 'label' && name != 'id' &&
   name != 'placeholders' && name.indexOf(':') < 0)
  {
   try
   {
11
src/main/webapp/js/grapheditor/Graph.js
@@ -12842,6 +12842,17 @@ if (typeof mxVertexHandler !== 'undefined')
   return result;
  };

  /**
   * Forces preview for title size in tables, table rows, table cells and swimlanes.
   */
  var vertexHandlerIsGhostPreview = mxVertexHandler.prototype.isGhostPreview;
  mxVertexHandler.prototype.isGhostPreview = function()
  {
   return vertexHandlerIsGhostPreview.apply(this, arguments) && !this.graph.isTable(this.state.cell) &&
    !this.graph.isTableRow(this.state.cell) && !this.graph.isTableCell(this.state.cell) &&
    !this.graph.isSwimlane(this.state.cell);
  };

  /**
   * Creates the shape used to draw the selection border.
   */",,
https://huntr.dev/bounties/9a6b1fb4-ec9b-4cfa-af1e-9ce304924829/,Annotation tool: token forgery using jwt secret to claim super admin role in deepset-ai/haystack,The vulnerability is based on the hard coded value of config.jwt.secret = Hm************tA which is located at config/config.production.js Using this value it is possible to create new jwt tokens that have the super_admin role and allow a low level user to make previously restricted actions.,CVE-2023-1712,"CWE-547: Use of Hard-coded, Security-relevant Constants",https://www.github.com/deepset-ai/haystack/commit/5fc84904f198de661d5b933fde756aa922bf09f1,"@@ -19,14 +19,17 @@ The credentials should match in database image and application configuration.
    DEFAULT_ADMIN_EMAIL: ""example@example.com""
    DEFAULT_ADMIN_PASSWORD: ""DEMO-PASSWORD""

    PROD_DB_NAME: ""databasename""
    PROD_DB_USERNAME: ""somesafeuser""
    PROD_DB_PASSWORD: ""somesafepassword""


    POSTGRES_USER: ""somesafeuser""
    POSTGRES_PASSWORD: ""somesafepassword""
    POSTGRES_DB: ""databasename""





2. Run docker-compose by executing `docker-compose up`.

@@ -3,13 +3,16 @@ services:
  backend:
    image: deepset/haystack-annotation:latest
    environment:
      DEFAULT_ADMIN_EMAIL: ""example@example.com""
      DEFAULT_ADMIN_PASSWORD: ""DEMO_PASSWORD""
      NODE_ENV: ""production""
      PROD_DB_HOSTNAME: ""db""
      PROD_DB_NAME: ""databasename""
      PROD_DB_USERNAME: ""somesafeuser""
      PROD_DB_PASSWORD: ""somesafepassword""





    ports:
      - ""7001:7001""
    links:

","11
annotation_tool/README.md
@@ -19,14 +19,17 @@ The credentials should match in database image and application configuration.
    DEFAULT_ADMIN_EMAIL: ""example@example.com""
    DEFAULT_ADMIN_PASSWORD: ""DEMO-PASSWORD""

    PROD_DB_NAME: ""databasename""
    PROD_DB_USERNAME: ""somesafeuser""
    PROD_DB_PASSWORD: ""somesafepassword""

    DB_HOSTNAME: ""db""
    DB_NAME: ""databasename""
    DB_USERNAME: ""somesafeuser""
    DB_PASSWORD: ""somesafepassword""

    POSTGRES_USER: ""somesafeuser""
    POSTGRES_PASSWORD: ""somesafepassword""
    POSTGRES_DB: ""databasename""

    COOKIE_KEYS: ""somesafecookiekeys""
    JWT_SECRET: ""somesafesecret""


2. Run docker-compose by executing `docker-compose up`.
15
annotation_tool/docker-compose.yml
@@ -3,13 +3,16 @@ services:
  backend:
    image: deepset/haystack-annotation:latest
    environment:
      DEFAULT_ADMIN_EMAIL: ""example@example.com""
      DEFAULT_ADMIN_PASSWORD: ""DEMO_PASSWORD""
      NODE_ENV: ""production""
      PROD_DB_HOSTNAME: ""db""
      PROD_DB_NAME: ""databasename""
      PROD_DB_USERNAME: ""somesafeuser""
      PROD_DB_PASSWORD: ""somesafepassword""
      DB_HOSTNAME: ""db""
      DB_NAME: ""databasename""
      DB_USERNAME: ""somesafeuser""
      DB_PASSWORD: ""somesafepassword""
      # IMPORTANT: please configure credentials with secure strings.
      # DEFAULT_ADMIN_EMAIL: ""example@example.com""
      # DEFAULT_ADMIN_PASSWORD: ""DEMO_PASSWORD""
      # COOKIE_KEYS: ""somesafecookiekeys""
      # JWT_SECRET: ""somesafesecret""
    ports:
      - ""7001:7001""
    links:",,
https://huntr.dev/bounties/87921835-8375-4df0-bb9e-f4fbe41eb408/,Stored HTML injection to XSS in kimai/kimai,I hope you are all doing well.,,CWE-94: Code Injection,https://www.github.com/kimai/kimai/commit/01226a12434a6379c1c8f50e70035821cfa2d4a5,"@@ -115,18 +115,24 @@ export default class KimaiFormSelect extends KimaiFormPlugin {
        if (node.dataset['renderer'] !== undefined && node.dataset['renderer'] === 'color') {
            options.render = {...render, ...{
                option: function(data, escape) {
                    let color = data.value;
                    if (data.color !== undefined) {
                        color = data.color;


                    }
                    return '<div class=""list-group-item border-0 p-1 ps-2 text-nowrap""><span style=""background-color:' + color + '"" class=""color-choice-item"">&nbsp;</span>' + escape(data.text) + '</div>';

                },
                item: function(data, escape) {
                    let color = data.value;
                    if (data.color !== undefined) {
                        color = data.color;


                    }
                    return '<div class=""text-nowrap""><span style=""background-color:' + color + '"" class=""color-choice-item"">&nbsp;</span>' + escape(data.text) + '</div>';

                }
            }};
        } else {

@@ -65,18 +65,20 @@ export default class KimaiTeamForm extends KimaiFormPlugin {
     */
    _createMember(option)
    {


        const prototype = this._getPrototype();
        let counter = prototype.dataset['widgetCounter'] || prototype.childNodes.length;
        let newWidget = prototype.dataset['prototype'];

        newWidget = newWidget.replace(/__name__/g, counter);

        newWidget = newWidget.replace(/#000000/g, KimaiColor.calculateContrastColor(option.dataset.color));
        newWidget = newWidget.replace(/__DISPLAY__/g, option.dataset.display);
        newWidget = newWidget.replace(/__COLOR__/g, option.dataset.color);
        newWidget = newWidget.replace(/__INITIALS__/g, option.dataset.initials);
        newWidget = newWidget.replace(/__TITLE__/g, option.dataset.title);
        newWidget = newWidget.replace(/__USERNAME__/g, option.text);

        prototype.dataset['widgetCounter'] = (++counter).toString();


@@ -163,7 +163,12 @@ export default class KimaiToolbar extends KimaiPlugin {
            event.preventDefault();
            event.stopPropagation();
            let urlParts = target.href.split('/');
            pager.value = urlParts[urlParts.length-1];





            pager.dispatchEvent(new Event('change'));
            document.dispatchEvent(new Event('pagination-change'));
            return false;

@@ -34,7 +34,7 @@
        ""friendsofsymfony/rest-bundle"": ""^3.0"",
        ""gedmo/doctrine-extensions"": ""^3.6"",
        ""jms/serializer-bundle"": ""^5.0"",
        ""kevinpapst/tabler-bundle"": ""dev-main"",
        ""league/csv"": ""^9.4"",
        ""mpdf/mpdf"": ""^8.0"",
        ""nelmio/api-doc-bundle"": ""^4.0"",

@@ -1310,41 +1310,11 @@ parameters:
            count: 1
            path: src/Controller/Reporting/ProjectViewController.php

        -
            message: ""#^Cannot call method modify\\(\\) on DateTime\\|null\\.$#""
            count: 4
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Cannot clone non\\-object variable \\$start of type DateTime\\|null\\.$#""
            count: 3
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Method App\\\\Controller\\\\Reporting\\\\ReportUsersMonthController\\:\\:getData\\(\\) return type has no value type specified in iterable type array\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#1 \\$begin of class App\\\\Model\\\\DailyStatistic constructor expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#1 \\$begin of method App\\\\Timesheet\\\\TimesheetStatisticService\\:\\:getDailyStatistics\\(\\) expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#2 \\$end of class App\\\\Model\\\\DailyStatistic constructor expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#2 \\$end of method App\\\\Timesheet\\\\TimesheetStatisticService\\:\\:getDailyStatistics\\(\\) expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#3 \\$users of method App\\\\Timesheet\\\\TimesheetStatisticService\\:\\:getDailyStatistics\\(\\) expects array\\<App\\\\Entity\\\\User\\>, iterable\\<App\\\\Entity\\\\User\\> given\\.$#""
            count: 1
@@ -1385,51 +1355,11 @@ parameters:
            count: 1
            path: src/Controller/Reporting/ReportUsersYearController.php

        -
            message: ""#^Cannot call method modify\\(\\) on DateTime\\|null\\.$#""
            count: 4
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Cannot clone non\\-object variable \\$start of type DateTime\\|null\\.$#""
            count: 3
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Method App\\\\Controller\\\\Reporting\\\\UserMonthController\\:\\:getData\\(\\) return type has no value type specified in iterable type array\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#1 \\$begin of class App\\\\Model\\\\DailyStatistic constructor expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#1 \\$begin of method App\\\\Controller\\\\Reporting\\\\AbstractUserReportController\\:\\:prepareReport\\(\\) expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#2 \\$end of class App\\\\Model\\\\DailyStatistic constructor expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#2 \\$end of method App\\\\Controller\\\\Reporting\\\\AbstractUserReportController\\:\\:prepareReport\\(\\) expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#3 \\$user of class App\\\\Model\\\\DailyStatistic constructor expects App\\\\Entity\\\\User, App\\\\Entity\\\\User\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#3 \\$user of method App\\\\Controller\\\\Reporting\\\\AbstractUserReportController\\:\\:prepareReport\\(\\) expects App\\\\Entity\\\\User, App\\\\Entity\\\\User\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Method App\\\\Controller\\\\Reporting\\\\UserWeekController\\:\\:getData\\(\\) return type has no value type specified in iterable type array\\.$#""
            count: 1

@@ -3,7 +3,7 @@








@@ -63,7 +63,7 @@


















@@ -17,11 +17,11 @@ class Constants














@@ -87,6 +87,7 @@ private function getData(Request $request, TimesheetStatisticService $statisticS








@@ -9,6 +9,7 @@







@@ -64,12 +65,14 @@ private function getData(Request $request): array















@@ -55,12 +55,12 @@ public function load(ObjectManager $manager): void
















@@ -10,7 +10,6 @@







@@ -58,12 +57,8 @@ public function getRandomFirstDay(): \DateTime













@@ -47,6 +47,10 @@ public function onActions(PageActionsEvent $event): void











@@ -60,7 +60,7 @@ public function reverseTransform(mixed $stringOfTags): mixed









@@ -11,6 +11,7 @@







@@ -39,6 +40,13 @@ public function configureOptions(OptionsResolver $resolver): void














@@ -80,7 +80,7 @@ public function buildForm(FormBuilderInterface $builder, array $options): void









@@ -11,24 +11,21 @@




























@@ -42,7 +39,7 @@ private function setupDays(): void









@@ -116,7 +116,7 @@ public function getLocale(): string








@@ -141,7 +141,7 @@ public function isWeekend(DateTime|string|null $dateTime): bool








@@ -158,17 +158,17 @@ public function createDate(string $date, ?User $user = null): \DateTime




















@@ -192,12 +192,12 @@ public function getMonthNames(?string $year = null): array















@@ -283,7 +283,7 @@ public function time(\DateTimeInterface|string|null $date): ?string








@@ -303,12 +303,12 @@ private function formatIntl(\DateTime $dateTime, string $format): string















","18
assets/js/forms/KimaiFormSelect.js
@@ -115,18 +115,24 @@ export default class KimaiFormSelect extends KimaiFormPlugin {
        if (node.dataset['renderer'] !== undefined && node.dataset['renderer'] === 'color') {
            options.render = {...render, ...{
                option: function(data, escape) {
                    let color = data.value;
                    let item = '<div class=""list-group-item border-0 p-1 ps-2 text-nowrap"">';
                    if (data.color !== undefined) {
                        color = data.color;
                        item += '<span style=""background-color:' + data.color + '"" class=""color-choice-item"">&nbsp;</span>';
                    } else {
                        item += '<span class=""color-choice-item"">&nbsp;</span>';
                    }
                    return '<div class=""list-group-item border-0 p-1 ps-2 text-nowrap""><span style=""background-color:' + color + '"" class=""color-choice-item"">&nbsp;</span>' + escape(data.text) + '</div>';
                    item += escape(data.text) + '</div>';
                    return item;
                },
                item: function(data, escape) {
                    let color = data.value;
                    let item = '<div class=""text-nowrap"">';
                    if (data.color !== undefined) {
                        color = data.color;
                        item += '<span style=""background-color:' + data.color + '"" class=""color-choice-item"">&nbsp;</span>';
                    } else {
                        item += '<span class=""color-choice-item"">&nbsp;</span>';
                    }
                    return '<div class=""text-nowrap""><span style=""background-color:' + color + '"" class=""color-choice-item"">&nbsp;</span>' + escape(data.text) + '</div>';
                    item += escape(data.text) + '</div>';
                    return item;
                }
            }};
        } else {
10
assets/js/forms/KimaiTeamForm.js
@@ -65,18 +65,20 @@ export default class KimaiTeamForm extends KimaiFormPlugin {
     */
    _createMember(option)
    {
        /** @type {KimaiEscape} ESCAPER */
        const ESCAPER = this.getPlugin('escape');
        const prototype = this._getPrototype();
        let counter = prototype.dataset['widgetCounter'] || prototype.childNodes.length;
        let newWidget = prototype.dataset['prototype'];

        newWidget = newWidget.replace(/__name__/g, counter);

        newWidget = newWidget.replace(/#000000/g, KimaiColor.calculateContrastColor(option.dataset.color));
        newWidget = newWidget.replace(/__DISPLAY__/g, option.dataset.display);
        newWidget = newWidget.replace(/__DISPLAY__/g, ESCAPER.escapeForHtml(option.dataset.display));
        newWidget = newWidget.replace(/__COLOR__/g, option.dataset.color);
        newWidget = newWidget.replace(/__INITIALS__/g, option.dataset.initials);
        newWidget = newWidget.replace(/__TITLE__/g, option.dataset.title);
        newWidget = newWidget.replace(/__USERNAME__/g, option.text);
        newWidget = newWidget.replace(/__INITIALS__/g, ESCAPER.escapeForHtml(option.dataset.initials));
        newWidget = newWidget.replace(/__TITLE__/g, ESCAPER.escapeForHtml(option.dataset.title));
        newWidget = newWidget.replace(/__USERNAME__/g, ESCAPER.escapeForHtml(option.text));

        prototype.dataset['widgetCounter'] = (++counter).toString();

7
assets/js/plugins/KimaiToolbar.js
@@ -163,7 +163,12 @@ export default class KimaiToolbar extends KimaiPlugin {
            event.preventDefault();
            event.stopPropagation();
            let urlParts = target.href.split('/');
            pager.value = urlParts[urlParts.length-1];
            let pageNumber = urlParts[urlParts.length - 1];
            // page number usually is the default value and is therefor missing from the URL
            if (!/\d/.test(pageNumber)) {
                pageNumber = 1;
            }
            pager.value = pageNumber;
            pager.dispatchEvent(new Event('change'));
            document.dispatchEvent(new Event('pagination-change'));
            return false;
2
composer.json
@@ -34,7 +34,7 @@
        ""friendsofsymfony/rest-bundle"": ""^3.0"",
        ""gedmo/doctrine-extensions"": ""^3.6"",
        ""jms/serializer-bundle"": ""^5.0"",
        ""kevinpapst/tabler-bundle"": ""dev-main"",
        ""kevinpapst/tabler-bundle"": ""^0.14"",
        ""league/csv"": ""^9.4"",
        ""mpdf/mpdf"": ""^8.0"",
        ""nelmio/api-doc-bundle"": ""^4.0"",
70
composer.lock
Load diff
Some generated files are not rendered by default. Learn more about how customized files appear on GitHub.
70
phpstan.neon
@@ -1310,41 +1310,11 @@ parameters:
            count: 1
            path: src/Controller/Reporting/ProjectViewController.php

        -
            message: ""#^Cannot call method modify\\(\\) on DateTime\\|null\\.$#""
            count: 4
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Cannot clone non\\-object variable \\$start of type DateTime\\|null\\.$#""
            count: 3
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Method App\\\\Controller\\\\Reporting\\\\ReportUsersMonthController\\:\\:getData\\(\\) return type has no value type specified in iterable type array\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#1 \\$begin of class App\\\\Model\\\\DailyStatistic constructor expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#1 \\$begin of method App\\\\Timesheet\\\\TimesheetStatisticService\\:\\:getDailyStatistics\\(\\) expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#2 \\$end of class App\\\\Model\\\\DailyStatistic constructor expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#2 \\$end of method App\\\\Timesheet\\\\TimesheetStatisticService\\:\\:getDailyStatistics\\(\\) expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/ReportUsersMonthController.php

        -
            message: ""#^Parameter \\#3 \\$users of method App\\\\Timesheet\\\\TimesheetStatisticService\\:\\:getDailyStatistics\\(\\) expects array\\<App\\\\Entity\\\\User\\>, iterable\\<App\\\\Entity\\\\User\\> given\\.$#""
            count: 1
@@ -1385,51 +1355,11 @@ parameters:
            count: 1
            path: src/Controller/Reporting/ReportUsersYearController.php

        -
            message: ""#^Cannot call method modify\\(\\) on DateTime\\|null\\.$#""
            count: 4
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Cannot clone non\\-object variable \\$start of type DateTime\\|null\\.$#""
            count: 3
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Method App\\\\Controller\\\\Reporting\\\\UserMonthController\\:\\:getData\\(\\) return type has no value type specified in iterable type array\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#1 \\$begin of class App\\\\Model\\\\DailyStatistic constructor expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#1 \\$begin of method App\\\\Controller\\\\Reporting\\\\AbstractUserReportController\\:\\:prepareReport\\(\\) expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#2 \\$end of class App\\\\Model\\\\DailyStatistic constructor expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#2 \\$end of method App\\\\Controller\\\\Reporting\\\\AbstractUserReportController\\:\\:prepareReport\\(\\) expects DateTime, DateTime\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#3 \\$user of class App\\\\Model\\\\DailyStatistic constructor expects App\\\\Entity\\\\User, App\\\\Entity\\\\User\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Parameter \\#3 \\$user of method App\\\\Controller\\\\Reporting\\\\AbstractUserReportController\\:\\:prepareReport\\(\\) expects App\\\\Entity\\\\User, App\\\\Entity\\\\User\\|null given\\.$#""
            count: 1
            path: src/Controller/Reporting/UserMonthController.php

        -
            message: ""#^Method App\\\\Controller\\\\Reporting\\\\UserWeekController\\:\\:getData\\(\\) return type has no value type specified in iterable type array\\.$#""
            count: 1
2
public/build/app.a6b63f34.js
Load diff
This file was deleted.
2
public/build/app.cd312ca8.js
Load diff
Large diffs are not rendered by default.
0
public/build/app.a6b63f34.js.LICENSE.txt ?public/build/app.cd312ca8.js.LICENSE.txt
File renamed without changes.",,
https://huntr.dev/bounties/6b9a32e3-825c-4610-b651-0809998c3b5e/,Autenticated Stored Cross-Site Scripting (XSS) in pluck-cms/pluck,Login to the admin account. Use the following URL (http://192.168.0.211/admin.php?action=files) or navigate to pages -> manage files.,,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/pluck-cms/pluck/commit/11e3b0517f3bb18748896f7f4fe131550f665e76,"@@ -1,3 +1,4 @@

<FilesMatch \.php$>
    SetHandler None
</FilesMatch>

@@ -1,3 +1,5 @@


<FilesMatch \.php$>
    SetHandler None
</FilesMatch>

@@ -1,3 +1,4 @@

<FilesMatch \.php$>
    SetHandler None
</FilesMatch>

@@ -1,3 +1,4 @@

<FilesMatch \.php$>
    SetHandler None
</FilesMatch>

","1
data/themes/.htaccess
@@ -1,3 +1,4 @@
AddHandler default-handler
<FilesMatch \.php$>
    SetHandler None
</FilesMatch>
2
data/trash/files/.htaccess
@@ -1,3 +1,5 @@
AddHandler default-handler

<FilesMatch \.php$>
    SetHandler None
</FilesMatch>
1
files/.htaccess
@@ -1,3 +1,4 @@
AddHandler default-handler
<FilesMatch \.php$>
    SetHandler None
</FilesMatch>
1
images/.htaccess
@@ -1,3 +1,4 @@
AddHandler default-handler
<FilesMatch \.php$>
    SetHandler None
</FilesMatch>",,
https://huntr.dev/bounties/84419c7b-ae29-401b-bdfd-5d0c498d320f/,Cross site scripting on setting module in pimcore/pimcore,pimcore is vulnerable to XSS in translate module.,CVE-2023-1704,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/pimcore/pimcore/commit/295f5e8d108b68198e36399bea0f69598eb108a0,"@@ -29,7 +29,7 @@ pimcore.settings.translation.editor = Class.create({
        if (editorType === 'wysiwyg') {
            this.editableDivId = ""translationeditor_"" + uniqid();

            var html = '<div class=""pimcore_editable_wysiwyg"" id=""' + this.editableDivId + '"" contenteditable=""true"">' + value + '</div>';
            var pConf = {
                html: html,
                border: true,
@@ -186,6 +186,7 @@ pimcore.settings.translation.editor = Class.create({

        try {
            this.ckeditor = CKEDITOR.inline(this.editableDivId, eConfig);


            // disable URL field in image dialog
            this.ckeditor.on(""dialogShow"", function (e) {

","3
bundles/AdminBundle/Resources/public/js/pimcore/settings/translationEditor.js
@@ -29,7 +29,7 @@ pimcore.settings.translation.editor = Class.create({
        if (editorType === 'wysiwyg') {
            this.editableDivId = ""translationeditor_"" + uniqid();

            var html = '<div class=""pimcore_editable_wysiwyg"" id=""' + this.editableDivId + '"" contenteditable=""true"">' + value + '</div>';
            var html = '<div class=""pimcore_editable_wysiwyg"" id=""' + this.editableDivId + '"" contenteditable=""true""></div>';
            var pConf = {
                html: html,
                border: true,
@@ -186,6 +186,7 @@ pimcore.settings.translation.editor = Class.create({

        try {
            this.ckeditor = CKEDITOR.inline(this.editableDivId, eConfig);
            this.ckeditor.setData(this.field.getValue());

            // disable URL field in image dialog
            this.ckeditor.on(""dialogShow"", function (e) {",,
https://huntr.dev/bounties/d12d105c-18fa-4d08-b591-b0e89e39eec1/,cross site scripting in pimcore/pimcore,Impact,CVE-2023-1703,CWE-79: Cross-site Scripting (XSS) - Generic,https://www.github.com/pimcore/pimcore/commit/765832f0dc5f6cfb296a82e089b701066f27bcef,"@@ -455,6 +455,14 @@ public function saveAction(Request $request)
            $class->rename($values['name']);
        }









        unset($values['creationDate']);
        unset($values['userOwner']);
        unset($values['layoutDefinitions']);

@@ -1085,7 +1085,14 @@ pimcore.object.classes.klass = Class.create({
            fieldLabel: t(""key""),
            labelWidth: 100,
            width: 250,
            value: data.index_key







        };

        //fixes data to match store model

","8
bundles/AdminBundle/Controller/Admin/DataObject/ClassController.php
@@ -455,6 +455,14 @@ public function saveAction(Request $request)
            $class->rename($values['name']);
        }

        if ($values['compositeIndices']) {
            foreach ($values['compositeIndices'] as $index => $compositeIndex) {
                if ($compositeIndex['index_key'] !== ($sanitizedKey = preg_replace('/[^a-za-z0-9_\-+]/', '', $compositeIndex['index_key']))) {
                    $values['compositeIndices'][$index]['index_key'] = $sanitizedKey;
                }
            }
        }

        unset($values['creationDate']);
        unset($values['userOwner']);
        unset($values['layoutDefinitions']);
9
bundles/AdminBundle/Resources/public/js/pimcore/object/classes/class.js
@@ -1085,7 +1085,14 @@ pimcore.object.classes.klass = Class.create({
            fieldLabel: t(""key""),
            labelWidth: 100,
            width: 250,
            value: data.index_key
            value: data.index_key,
            validator: function (value) {
                if(value !== value.replace(/[^a-za-z0-9_\-+]/g,'')){
                    this.setvalue(value.replace(/[^a-za-z0-9_\-+]/g,''));
                }

                return true;
            }
        };

        //fixes data to match store model",,
https://huntr.dev/bounties/7b329cfc-bf12-4d6a-a758-4ee8b37bd27d/,Authentication Remote Code Execution in pluck-cms/pluck,Found authenticated Remote Code Execution (RCE) on pluck 4.7.15,,CWE-434: Unrestricted Upload of File with Dangerous Type,https://www.github.com/pluck-cms/pluck/commit/8abdd8a5c0782e7a78cb3d7a5108e3c5d3c41e9a,"@@ -0,0 +1,11 @@











","11
data/trash/files/.htaccess
@@ -0,0 +1,11 @@
<FilesMatch \.php$>
    SetHandler None
</FilesMatch>

<FilesMatch \.phtml>
    SetHandler None
</FilesMatch>

Options -ExecCGI

php_flag engine off",,
https://huntr.dev/bounties/d8a47f29-3297-4fce-b534-e1d95a2b3e19/,XSS in Predefined Asset Metadata module in Settings in pimcore/pimcore,"While testing the pimcore application, I found that it is vulnerable to XSS vulnerability in Predefined Asset Metadata module in Settings, specifically at Name field.",CVE-2023-1702,CWE-79: Cross-site Scripting (XSS) - Generic,https://www.github.com/pimcore/pimcore/commit/2b997737dd6a60be2239a51dd6d9ef5881568e6d,"@@ -215,7 +215,9 @@ pimcore.settings.metadata.predefined = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('predefined_metadata'), data.data.name, function () {


                            grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)

@@ -165,7 +165,9 @@ pimcore.settings.properties.predefined = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('predefined_properties'), data.data.name, function () {


                            grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)

","4
bundles/AdminBundle/Resources/public/js/pimcore/settings/metadata/predefined.js
@@ -215,7 +215,9 @@ pimcore.settings.metadata.predefined = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('predefined_metadata'), data.data.name, function () {
                        pimcore.helpers.deleteConfirm(t('predefined_metadata'),
                            Ext.util.Format.htmlEncode(data.data.name),
                            function () {
                            grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)
4
bundles/AdminBundle/Resources/public/js/pimcore/settings/properties/predefined.js
@@ -165,7 +165,9 @@ pimcore.settings.properties.predefined = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('predefined_properties'), data.data.name, function () {
                        pimcore.helpers.deleteConfirm(t('predefined_properties'),
                            Ext.util.Format.htmlEncode(data.data.name),
                            function () {
                            grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)",,
https://huntr.dev/bounties/64f943c4-68e5-4ef8-82f6-9c4abe928256/,Reflected XSS in Predefined Properties module in Settings in pimcore/pimcore,"During testing the pimcore application, I found that it is vulnerable to XSS vulnerability in Predefined Properties module in Settings, specifically at Name field.",CVE-2023-1701,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/pimcore/pimcore/commit/2b997737dd6a60be2239a51dd6d9ef5881568e6d,"@@ -215,7 +215,9 @@ pimcore.settings.metadata.predefined = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('predefined_metadata'), data.data.name, function () {


                            grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)

@@ -165,7 +165,9 @@ pimcore.settings.properties.predefined = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('predefined_properties'), data.data.name, function () {


                            grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)

","4
bundles/AdminBundle/Resources/public/js/pimcore/settings/metadata/predefined.js
@@ -215,7 +215,9 @@ pimcore.settings.metadata.predefined = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('predefined_metadata'), data.data.name, function () {
                        pimcore.helpers.deleteConfirm(t('predefined_metadata'),
                            Ext.util.Format.htmlEncode(data.data.name),
                            function () {
                            grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)
4
bundles/AdminBundle/Resources/public/js/pimcore/settings/properties/predefined.js
@@ -165,7 +165,9 @@ pimcore.settings.properties.predefined = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('predefined_properties'), data.data.name, function () {
                        pimcore.helpers.deleteConfirm(t('predefined_properties'),
                            Ext.util.Format.htmlEncode(data.data.name),
                            function () {
                            grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)",,
https://huntr.dev/bounties/db8fcbab-6ef0-44ba-b5c6-3b0f17ca22a2/,No Protection Against Bruteforce Attacks on Login Page in linagora/twake,Twake does not limit unsuccessfull login attempts allowing an attacker to brute force the password of an administrator or regular user.,CVE-2023-1665,CWE-307: Improper Restriction of Excessive Authentication Attempts,https://www.github.com/linagora/twake/commit/599f397561a771251dfc7cafb8cecda5ab22b8b3,"@@ -65,6 +65,8 @@ class DriveMigrator {
          company: { id: company.id },
        });
      }


    } while (page.page_token);
  };

@@ -159,158 +161,166 @@ class DriveMigrator {
    logger.info(`Migrating php drive item ${item.id} - parent: ${parentId ?? ""root""}`);

    try {
      const migrationRecord = await this.phpDriveService.getMigrationRecord(
        item.id,
        context.company.id,
      );


      const newDriveItem = getDefaultDriveItem(
        {
          name: item.name || item.id,
          extension: item.extension,
          added: item.added.toString(),
          content_keywords:
            item.content_keywords && item.content_keywords.length
              ? item.content_keywords.join("","")
              : """",
          creator: item.creator || context.user.id,
          is_directory: item.isdirectory,
          is_in_trash: item.isintrash,
          description: item.description,
          tags: item.tags || [],
          parent_id: parentId,
          company_id: context.company.id,
          access_info: access,
        },
        context,
      );

      if (migrationRecord && migrationRecord.company_id === context.company.id) {
        console.debug(`${item.id} is already migrated`);
      } else {
        await this.nodeRepository.save(newDriveItem);
      }

      if (item.isdirectory) {
        const newParentId =
          migrationRecord && migrationRecord.company_id === context.company.id
            ? migrationRecord.new_id
            : newDriveItem.id;

        let page: Pagination = { limitStr: ""100"" };

        do {
          const directoryChildren = await this.phpDriveService.listDirectory(
            page,
            item.id,
            context.workspace_id,
          );
          page = directoryChildren.nextPage as Pagination;

          for (const child of directoryChildren.getEntities()) {
            try {
              await this.migrateDriveFile(child, newParentId, access, context);
            } catch (error) {
              logger.error(`Failed to migrate drive item ${child.id}`);
              console.error(`Failed to migrate drive item ${child.id}`);

            }











          }
        } while (page.page_token);
      } else {
        let versionPage: Pagination = { limitStr: ""100"" };
        if (
          migrationRecord &&
          migrationRecord.item_id === item.id &&
          migrationRecord.company_id === context.company.id
        ) {
          logger.info(`item is already migrated - ${item.id} - skipping`);
          console.log(`item is already migrated - ${item.id} - skipping`);
          return;
        }

        const mime = mimes[item.extension];

        let createdVersions = 0;

        do {
          const itemVersions = await this.phpDriveService.listItemVersions(
            versionPage,
            item.id,
            context,
          );
          versionPage = itemVersions.nextPage as Pagination;

          for (const version of itemVersions.getEntities()) {
            try {
              const newVersion = getDefaultDriveItemVersion(
                {
                  creator_id: version.creator_id || context.user.id,
                  data: version.data,
                  date_added: +version.date_added,
                  drive_item_id: newDriveItem.id,
                  file_size: version.file_size,
                  filename: version.filename,
                  key: version.key,
                  provider: version.provider,
                  realname: version.realname,
                  mode: version.mode,
                },
                context,
              );

              logger.info(
                `Migrating version ${version.id} of item ${item.id}... (downloading then uploading...)`,
              );
              const file = await this.phpDriveService.migrate(
                version.file_id,
                item.workspace_id,
                version.id,
                {
                  filename: version.filename,
                  userId: version.creator_id || context.user.id,
                  totalSize: version.file_size,
                  waitForThumbnail: true,
                  chunkNumber: 1,
                  totalChunks: 1,
                  type: mime,
                },
                context,
              );

              if (!file) {
                throw Error(""cannot download file version"");





















              }

              newVersion.file_metadata = {
                external_id: file.id,
                mime: file.metadata.mime,
                name: file.metadata.name || version.filename,
                size: file.upload_data.size || version.file_size,
              };

              await globalResolver.services.documents.documents.createVersion(
                newDriveItem.id,
                newVersion,
                context,
              );

              createdVersions++;
            } catch (error) {
              logger.error(`Failed to migrate version ${version.id} for drive item ${item.id}`);
              console.error(`Failed to migrate version ${version.id} for drive item ${item.id}`);
            }







          }
        } while (versionPage.page_token);

        if (createdVersions === 0) {
          await this.nodeRepository.remove(newDriveItem);
          return;
        }
      }

      if (!migrationRecord) {
        await this.phpDriveService.markAsMigrated(item.id, newDriveItem.id, context.company.id);
      }
    } catch (error) {
      logger.error(
        `Failed to migrate Drive item ${item.id} / workspace ${item.workspace_id} / company_id: ${context.company.id}`,

","290
twake/backend/node/src/cli/cmds/migration_cmds/php-drive-file/drive-migrator-service.ts
@@ -65,6 +65,8 @@ class DriveMigrator {
          company: { id: company.id },
        });
      }

      console.log(""Loop over companies..."", page.page_token);
    } while (page.page_token);
  };

@@ -159,158 +161,166 @@ class DriveMigrator {
    logger.info(`Migrating php drive item ${item.id} - parent: ${parentId ?? ""root""}`);

    try {
      const migrationRecord = await this.phpDriveService.getMigrationRecord(
        item.id,
        context.company.id,
      );
      await new Promise(async (resolve, reject) => {
        const migrationRecord = await this.phpDriveService.getMigrationRecord(
          item.id,
          context.company.id,
        );

      const newDriveItem = getDefaultDriveItem(
        {
          name: item.name || item.id,
          extension: item.extension,
          added: item.added.toString(),
          content_keywords:
            item.content_keywords && item.content_keywords.length
              ? item.content_keywords.join("","")
              : """",
          creator: item.creator || context.user.id,
          is_directory: item.isdirectory,
          is_in_trash: item.isintrash,
          description: item.description,
          tags: item.tags || [],
          parent_id: parentId,
          company_id: context.company.id,
          access_info: access,
        },
        context,
      );
        const newDriveItem = getDefaultDriveItem(
          {
            name: item.name || item.id,
            extension: item.extension,
            added: item.added.toString(),
            content_keywords:
              item.content_keywords && item.content_keywords.length
                ? item.content_keywords.join("","")
                : """",
            creator: item.creator || context.user.id,
            is_directory: item.isdirectory,
            is_in_trash: item.isintrash,
            description: item.description,
            tags: item.tags || [],
            parent_id: parentId,
            company_id: context.company.id,
            access_info: access,
          },
          context,
        );

      if (migrationRecord && migrationRecord.company_id === context.company.id) {
        console.debug(`${item.id} is already migrated`);
      } else {
        await this.nodeRepository.save(newDriveItem);
      }
        if (migrationRecord && migrationRecord.company_id === context.company.id) {
          console.debug(`${item.id} is already migrated`);
        } else {
          await this.nodeRepository.save(newDriveItem);
        }

      if (item.isdirectory) {
        const newParentId =
          migrationRecord && migrationRecord.company_id === context.company.id
            ? migrationRecord.new_id
            : newDriveItem.id;

        let page: Pagination = { limitStr: ""100"" };

        do {
          const directoryChildren = await this.phpDriveService.listDirectory(
            page,
            item.id,
            context.workspace_id,
          );
          page = directoryChildren.nextPage as Pagination;

          for (const child of directoryChildren.getEntities()) {
            try {
              await this.migrateDriveFile(child, newParentId, access, context);
            } catch (error) {
              logger.error(`Failed to migrate drive item ${child.id}`);
              console.error(`Failed to migrate drive item ${child.id}`);
        if (item.isdirectory) {
          const newParentId =
            migrationRecord && migrationRecord.company_id === context.company.id
              ? migrationRecord.new_id
              : newDriveItem.id;

          let page: Pagination = { limitStr: ""100"" };

          do {
            const directoryChildren = await this.phpDriveService.listDirectory(
              page,
              item.id,
              context.workspace_id,
            );
            page = directoryChildren.nextPage as Pagination;

            for (const child of directoryChildren.getEntities()) {
              try {
                await this.migrateDriveFile(child, newParentId, access, context);
              } catch (error) {
                logger.error(`Failed to migrate drive item ${child.id}`);
                console.error(`Failed to migrate drive item ${child.id}`);
              }
            }
          } while (page.page_token);
        } else {
          let versionPage: Pagination = { limitStr: ""100"" };
          if (
            migrationRecord &&
            migrationRecord.item_id === item.id &&
            migrationRecord.company_id === context.company.id
          ) {
            logger.info(`item is already migrated - ${item.id} - skipping`);
            console.log(`item is already migrated - ${item.id} - skipping`);
            return;
          }
        } while (page.page_token);
      } else {
        let versionPage: Pagination = { limitStr: ""100"" };
        if (
          migrationRecord &&
          migrationRecord.item_id === item.id &&
          migrationRecord.company_id === context.company.id
        ) {
          logger.info(`item is already migrated - ${item.id} - skipping`);
          console.log(`item is already migrated - ${item.id} - skipping`);
          return;
        }

        const mime = mimes[item.extension];

        let createdVersions = 0;

        do {
          const itemVersions = await this.phpDriveService.listItemVersions(
            versionPage,
            item.id,
            context,
          );
          versionPage = itemVersions.nextPage as Pagination;

          for (const version of itemVersions.getEntities()) {
            try {
              const newVersion = getDefaultDriveItemVersion(
                {
                  creator_id: version.creator_id || context.user.id,
                  data: version.data,
                  date_added: +version.date_added,
                  drive_item_id: newDriveItem.id,
                  file_size: version.file_size,
                  filename: version.filename,
                  key: version.key,
                  provider: version.provider,
                  realname: version.realname,
                  mode: version.mode,
                },
                context,
              );

              logger.info(
                `Migrating version ${version.id} of item ${item.id}... (downloading then uploading...)`,
              );
              const file = await this.phpDriveService.migrate(
                version.file_id,
                item.workspace_id,
                version.id,
                {
                  filename: version.filename,
                  userId: version.creator_id || context.user.id,
                  totalSize: version.file_size,
                  waitForThumbnail: true,
                  chunkNumber: 1,
                  totalChunks: 1,
                  type: mime,
                },
                context,
              );

              if (!file) {
                throw Error(""cannot download file version"");
          const mime = mimes[item.extension];

          let createdVersions = 0;

          const timeout = setTimeout(() => reject(""Timeout""), 60000);

          do {
            const itemVersions = await this.phpDriveService.listItemVersions(
              versionPage,
              item.id,
              context,
            );
            versionPage = itemVersions.nextPage as Pagination;

            for (const version of itemVersions.getEntities()) {
              try {
                const newVersion = getDefaultDriveItemVersion(
                  {
                    creator_id: version.creator_id || context.user.id,
                    data: version.data,
                    date_added: +version.date_added,
                    drive_item_id: newDriveItem.id,
                    file_size: version.file_size,
                    filename: version.filename,
                    key: version.key,
                    provider: version.provider,
                    realname: version.realname,
                    mode: version.mode,
                  },
                  context,
                );

                logger.info(
                  `Migrating version ${version.id} of item ${item.id}... (downloading then uploading...)`,
                );
                const file = await this.phpDriveService.migrate(
                  version.file_id,
                  item.workspace_id,
                  version.id,
                  {
                    filename: version.filename,
                    userId: version.creator_id || context.user.id,
                    totalSize: version.file_size,
                    waitForThumbnail: true,
                    chunkNumber: 1,
                    totalChunks: 1,
                    type: mime,
                  },
                  context,
                );

                if (!file) {
                  throw Error(""cannot download file version"");
                }

                newVersion.file_metadata = {
                  external_id: file.id,
                  mime: file.metadata.mime,
                  name: file.metadata.name || version.filename,
                  size: file.upload_data.size || version.file_size,
                };

                await globalResolver.services.documents.documents.createVersion(
                  newDriveItem.id,
                  newVersion,
                  context,
                );

                createdVersions++;
              } catch (error) {
                logger.error(`Failed to migrate version ${version.id} for drive item ${item.id}`);
                console.error(`Failed to migrate version ${version.id} for drive item ${item.id}`);
              }

              newVersion.file_metadata = {
                external_id: file.id,
                mime: file.metadata.mime,
                name: file.metadata.name || version.filename,
                size: file.upload_data.size || version.file_size,
              };

              await globalResolver.services.documents.documents.createVersion(
                newDriveItem.id,
                newVersion,
                context,
              );

              createdVersions++;
            } catch (error) {
              logger.error(`Failed to migrate version ${version.id} for drive item ${item.id}`);
              console.error(`Failed to migrate version ${version.id} for drive item ${item.id}`);
            }
          } while (versionPage.page_token);

          clearTimeout(timeout);

          if (createdVersions === 0) {
            await this.nodeRepository.remove(newDriveItem);
            return;
          }
        } while (versionPage.page_token);
        }

        if (createdVersions === 0) {
          await this.nodeRepository.remove(newDriveItem);
          return;
        if (!migrationRecord) {
          await this.phpDriveService.markAsMigrated(item.id, newDriveItem.id, context.company.id);
        }
      }

      if (!migrationRecord) {
        await this.phpDriveService.markAsMigrated(item.id, newDriveItem.id, context.company.id);
      }
        resolve(true);
      });
    } catch (error) {
      logger.error(
        `Failed to migrate Drive item ${item.id} / workspace ${item.workspace_id} / company_id: ${context.company.id}`,",,
https://huntr.dev/bounties/05f1d1de-bbfd-43fe-bdf9-7f73419ce7c9/,Heap Use-After-Free in GPAC MP4Box's ogg_stream_clear Function When Processing OGG Files in gpac/gpac,Reproduce : ./bin/gcc/MP4Box -dash 1000 POC,CVE-2023-1655,CWE-122: Heap-based Buffer Overflow,https://www.github.com/gpac/gpac/commit/e7f96c2d3774e4ea25f952bcdf55af1dd6e919f4,"@@ -250,6 +250,7 @@ GF_Err pcmreframe_process(GF_Filter *filter)

 if (ctx->probe_wave==1) {
  Bool wav_ok = GF_TRUE;

  GF_BitStream *bs;
  if (ctx->probe_data) {
   ctx->probe_data = gf_realloc(ctx->probe_data, ctx->probe_data_size+pck_size);
@@ -280,6 +281,7 @@ GF_Err pcmreframe_process(GF_Filter *filter)
    continue;
   }
   //parse fmt

   u16 atype = gf_bs_read_u16_le(bs);
   ctx->ch = gf_bs_read_u16_le(bs);
   ctx->sr = gf_bs_read_u32_le(bs);
@@ -312,11 +314,13 @@ GF_Err pcmreframe_process(GF_Filter *filter)
    memcpy(ctx->probe_data, data, pck_size);
    ctx->probe_data_size = pck_size;
   }
   if (ctx->probe_data_size<=10000) {
    gf_filter_pid_drop_packet(ctx->ipid);
    return GF_OK;



   }
   GF_LOG(GF_LOG_WARNING, GF_LOG_MEDIA, (""[PCMReframe] Cannot find wave data chink afetr %d bytes, aborting\n"", ctx->probe_data_size));
   wav_ok = GF_FALSE;
  }


@@ -1266,6 +1266,10 @@ void gf_bs_skip_bytes(GF_BitStream *bs, u64 nbBytes)
   }
  } else {
   bs->position += nbBytes;




  }
  return;
 }

","12
src/filters/reframe_rawpcm.c
@@ -250,6 +250,7 @@ GF_Err pcmreframe_process(GF_Filter *filter)

 if (ctx->probe_wave==1) {
  Bool wav_ok = GF_TRUE;
  Bool hdr_found = GF_FALSE;
  GF_BitStream *bs;
  if (ctx->probe_data) {
   ctx->probe_data = gf_realloc(ctx->probe_data, ctx->probe_data_size+pck_size);
@@ -280,6 +281,7 @@ GF_Err pcmreframe_process(GF_Filter *filter)
    continue;
   }
   //parse fmt
   hdr_found = GF_TRUE;
   u16 atype = gf_bs_read_u16_le(bs);
   ctx->ch = gf_bs_read_u16_le(bs);
   ctx->sr = gf_bs_read_u32_le(bs);
@@ -312,11 +314,13 @@ GF_Err pcmreframe_process(GF_Filter *filter)
    memcpy(ctx->probe_data, data, pck_size);
    ctx->probe_data_size = pck_size;
   }
   if (ctx->probe_data_size<=10000) {
    gf_filter_pid_drop_packet(ctx->ipid);
    return GF_OK;
   if (!hdr_found) {
    if (ctx->probe_data_size<=10000) {
     gf_filter_pid_drop_packet(ctx->ipid);
     return GF_OK;
    }
    GF_LOG(GF_LOG_WARNING, GF_LOG_MEDIA, (""[PCMReframe] Cannot find wave data chunk after %d bytes, aborting\n"", ctx->probe_data_size));
   }
   GF_LOG(GF_LOG_WARNING, GF_LOG_MEDIA, (""[PCMReframe] Cannot find wave data chink afetr %d bytes, aborting\n"", ctx->probe_data_size));
   wav_ok = GF_FALSE;
  }

4
src/utils/bitstream.c
@@ -1266,6 +1266,10 @@ void gf_bs_skip_bytes(GF_BitStream *bs, u64 nbBytes)
   }
  } else {
   bs->position += nbBytes;
   if (bs->position>bs->size) {
    bs->position = bs->size;
    bs->overflow_state = 1;
   }
  }
  return;
 }",,
https://huntr.dev/bounties/33652b56-128f-41a7-afcc-10641f69ff14/,Unhandled SWF Tags in MP4Box: Potential Vulnerability in GPAC in gpac/gpac,POC: # ./MP4Box -dash 1000 POC4 LINK: https://drive.google.com/file/d/1hHzxolxklZDG_wtowwUEmel9-HAya9Az/view?usp=share_link,CVE-2023-1654,CWE-400: Denial of Service,https://www.github.com/gpac/gpac/commit/2c055153d401b8c49422971e3a0159869652d3da,"@@ -62,13 +62,17 @@ void gf_filter_pid_inst_del(GF_FilterPidInst *pidinst)
 gf_list_del(pidinst->pck_reassembly);
 if (pidinst->props) {
  assert(pidinst->props->reference_count);
  if (safe_int_dec(&pidinst->props->reference_count) == 0) {
   //see \ref gf_filter_pid_merge_properties_internal for mutex
   gf_mx_p(pidinst->pid->filter->tasks_mx);
   gf_list_del_item(pidinst->pid->properties, pidinst->props);
   gf_mx_v(pidinst->pid->filter->tasks_mx);
   gf_props_del(pidinst->props);



  }

 }
 gf_free(pidinst);
}
@@ -1044,8 +1048,15 @@ static GF_Err gf_filter_pid_configure(GF_Filter *filter, GF_FilterPid *pid, GF_P
      if (!target->detached_pid_inst) {
       target->detached_pid_inst = gf_list_new();
      }
      //detach props but don't delete them
      if (filter->swap_pidinst_dst->props) {







       filter->swap_pidinst_dst->props = NULL;
      }
      filter->swap_pidinst_dst->pid = NULL;
@@ -1308,7 +1319,7 @@ void gf_filter_pid_detach_task(GF_FSTask *task)
 //first connection of this PID to this filter
 if (!pidinst) {
  GF_LOG(GF_LOG_ERROR, GF_LOG_FILTER, (""Trying to detach PID %s not present in filter %s inputs\n"",  pid->name, filter->name));
  //assert(!new_chain_input->swap_pidinst_dst);
  assert(!new_chain_input->swap_pidinst_src);
  new_chain_input->swap_needs_init = GF_FALSE;
  return;
@@ -5943,7 +5954,7 @@ static GF_Err gf_filter_pid_merge_properties_internal(GF_FilterPid *dst_pid, GF_
  }
  src_props = pidi->props;
 }
 //move to rela pid
 src_pid = src_pid->pid;
 //this is a copy props on output pid
 if (!src_props) {

","29
src/filter_core/filter_pid.c
@@ -62,13 +62,17 @@ void gf_filter_pid_inst_del(GF_FilterPidInst *pidinst)
 gf_list_del(pidinst->pck_reassembly);
 if (pidinst->props) {
  assert(pidinst->props->reference_count);
  if (safe_int_dec(&pidinst->props->reference_count) == 0) {
   //see \ref gf_filter_pid_merge_properties_internal for mutex
   gf_mx_p(pidinst->pid->filter->tasks_mx);
   gf_list_del_item(pidinst->pid->properties, pidinst->props);
   gf_mx_v(pidinst->pid->filter->tasks_mx);
   gf_props_del(pidinst->props);
  gf_mx_p(pidinst->pid->filter->tasks_mx);
  //not in parent pid, may happen when reattaching a pid inst to a different pid
  //in this case do NOT delete the props
  if (gf_list_find(pidinst->pid->properties, pidinst->props)>=0) {
   if (safe_int_dec(&pidinst->props->reference_count) == 0) {
    //see \ref gf_filter_pid_merge_properties_internal for mutex
    gf_list_del_item(pidinst->pid->properties, pidinst->props);
    gf_props_del(pidinst->props);
   }
  }
  gf_mx_v(pidinst->pid->filter->tasks_mx);
 }
 gf_free(pidinst);
}
@@ -1044,8 +1048,15 @@ static GF_Err gf_filter_pid_configure(GF_Filter *filter, GF_FilterPid *pid, GF_P
      if (!target->detached_pid_inst) {
       target->detached_pid_inst = gf_list_new();
      }
      //detach props but don't delete them
      //detach props
      if (filter->swap_pidinst_dst->props) {
       GF_FilterPidInst *swap_pidi = filter->swap_pidinst_dst;
       if (safe_int_dec(&swap_pidi->props->reference_count)==0) {
        gf_mx_p(swap_pidi->pid->filter->tasks_mx);
        gf_list_del_item(swap_pidi->pid->properties, pidinst->props);
        gf_mx_v(swap_pidi->pid->filter->tasks_mx);
        gf_props_del(pidinst->props);
       }
       filter->swap_pidinst_dst->props = NULL;
      }
      filter->swap_pidinst_dst->pid = NULL;
@@ -1308,7 +1319,7 @@ void gf_filter_pid_detach_task(GF_FSTask *task)
 //first connection of this PID to this filter
 if (!pidinst) {
  GF_LOG(GF_LOG_ERROR, GF_LOG_FILTER, (""Trying to detach PID %s not present in filter %s inputs\n"",  pid->name, filter->name));
  //assert(!new_chain_input->swap_pidinst_dst);
  //when swaping encoder, we may have swap_pidinst_dst not NULL so only check swap_pidinst_src
  assert(!new_chain_input->swap_pidinst_src);
  new_chain_input->swap_needs_init = GF_FALSE;
  return;
@@ -5943,7 +5954,7 @@ static GF_Err gf_filter_pid_merge_properties_internal(GF_FilterPid *dst_pid, GF_
  }
  src_props = pidi->props;
 }
 //move to rela pid
 //move to real pid
 src_pid = src_pid->pid;
 //this is a copy props on output pid
 if (!src_props) {",,
https://huntr.dev/bounties/9c229475-7b2f-44bf-ae74-15b23f3d27ce/,CSV Injection in CSV files generated by the backend in limesurvey/limesurvey,2 the demo admin create a user with name "=1+cmd|'/C calc'!A0".,,CWE-1236: Improper Neutralization of Formula Elements in a CSV File,https://www.github.com/limesurvey/limesurvey/commit/9531225d3c7dee73f6114bd41e6461766d01ee3b,"@@ -808,11 +808,11 @@ public function actionExportUser(string $outputFormat, int $uid = 0)
                fprintf($fp, chr(0xEF) . chr(0xBB) . chr(0xBF));
                $header = array('uid', 'users_name', 'full_name', 'email', 'lang', 'password');
                //Add csv header
                fputcsv($fp, $header, ';');

                //add csv row datas
                foreach ($aUsers as $fields) {
                    fputcsv($fp, $fields, ';');
                }
                fclose($fp);
                header('Content-Encoding: UTF-8');

","4
application/controllers/UserManagementController.php
@@ -808,11 +808,11 @@ public function actionExportUser(string $outputFormat, int $uid = 0)
                fprintf($fp, chr(0xEF) . chr(0xBB) . chr(0xBF));
                $header = array('uid', 'users_name', 'full_name', 'email', 'lang', 'password');
                //Add csv header
                fputcsv($fp, $header, ';');
                fputcsv($fp, $header, ';', '""');

                //add csv row datas
                foreach ($aUsers as $fields) {
                    fputcsv($fp, $fields, ';');
                    fputcsv($fp, $fields, ';', '""');
                }
                fclose($fp);
                header('Content-Encoding: UTF-8');",,
https://huntr.dev/bounties/652b5e75-24aa-47de-912e-a98d02094676/,Stored XSS in Notification and Data Management in limesurvey/limesurvey,Please enter a description of the vulnerability.,,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/limesurvey/limesurvey/commit/ef1ca04b9a99643904e18b5dcad5d7db6b0d2451,"@@ -209,7 +209,7 @@
                <div class=""row"">
                    <div class=""col-xs-12 col-sm-12 col-md-8 col-lg-8 content-right"">
                        <label class="" control-label""  for='emailnotificationto'><?php  eT(""Send basic notification email to:""); ?></label>
                            <input class=""form-control inherit-edit <?php echo ($bShowInherited && $emailnotificationto === 'inherit' ? 'hide' : 'show'); ?>"" type='<?php echo ($bShowInherited)?'text':'email'; ?>' size='50' id='emailnotificationto' name='emailnotificationto' value=""<?php echo htmlspecialchars($emailnotificationto); ?>"" data-inherit-value=""inherit"" data-saved-value=""<?php echo $emailnotificationto; ?>""/>
                            <input class=""form-control inherit-readonly <?php echo ($bShowInherited && $emailnotificationto === 'inherit' ? 'show' : 'hide'); ?>"" type='text' size='50' value=""<?php echo htmlspecialchars($oSurveyOptions->emailnotificationto); ?>"" readonly />
                    </div>
                    <div class=""col-xs-12 col-sm-12 col-md-4 col-lg-4 content-right <?php echo ($bShowInherited ? 'show' : 'hide'); ?>"">
@@ -233,7 +233,7 @@
                <div class=""row"">
                    <div class=""col-xs-12 col-sm-12 col-md-8 col-lg-8 content-right"">
                        <label class="" control-label""  for='emailresponseto'><?php  eT(""Send detailed notification email to:""); ?></label>
                            <input class=""form-control inherit-edit <?php echo ($bShowInherited && $emailresponseto === 'inherit' ? 'hide' : 'show'); ?>"" type='<?php echo ($bShowInherited)?'text':'email'; ?>' size='50' id='emailresponseto' name='emailresponseto' value=""<?php echo htmlspecialchars($emailresponseto); ?>"" data-inherit-value=""inherit"" data-saved-value=""<?php echo $emailresponseto; ?>""/>
                            <input class=""form-control inherit-readonly <?php echo ($bShowInherited && $emailresponseto === 'inherit' ? 'show' : 'hide'); ?>"" type='text' size='50' value=""<?php echo htmlspecialchars($oSurveyOptions->emailresponseto); ?>"" readonly />
                    </div>
                    <div class=""col-xs-12 col-sm-12 col-md-4 col-lg-4 content-right <?php echo ($bShowInherited ? 'show' : 'hide'); ?>"">

","4
application/views/admin/survey/subview/accordion/_notification_panel.php
@@ -209,7 +209,7 @@
                <div class=""row"">
                    <div class=""col-xs-12 col-sm-12 col-md-8 col-lg-8 content-right"">
                        <label class="" control-label""  for='emailnotificationto'><?php  eT(""Send basic notification email to:""); ?></label>
                            <input class=""form-control inherit-edit <?php echo ($bShowInherited && $emailnotificationto === 'inherit' ? 'hide' : 'show'); ?>"" type='<?php echo ($bShowInherited)?'text':'email'; ?>' size='50' id='emailnotificationto' name='emailnotificationto' value=""<?php echo htmlspecialchars($emailnotificationto); ?>"" data-inherit-value=""inherit"" data-saved-value=""<?php echo $emailnotificationto; ?>""/>
                            <input class=""form-control inherit-edit <?php echo ($bShowInherited && $emailnotificationto === 'inherit' ? 'hide' : 'show'); ?>"" type='<?php echo ($bShowInherited)?'text':'email'; ?>' size='50' id='emailnotificationto' name='emailnotificationto' value=""<?php echo htmlspecialchars($emailnotificationto); ?>"" data-inherit-value=""inherit"" data-saved-value=""<?php echo htmlspecialchars($emailnotificationto); ?>""/>
                            <input class=""form-control inherit-readonly <?php echo ($bShowInherited && $emailnotificationto === 'inherit' ? 'show' : 'hide'); ?>"" type='text' size='50' value=""<?php echo htmlspecialchars($oSurveyOptions->emailnotificationto); ?>"" readonly />
                    </div>
                    <div class=""col-xs-12 col-sm-12 col-md-4 col-lg-4 content-right <?php echo ($bShowInherited ? 'show' : 'hide'); ?>"">
@@ -233,7 +233,7 @@
                <div class=""row"">
                    <div class=""col-xs-12 col-sm-12 col-md-8 col-lg-8 content-right"">
                        <label class="" control-label""  for='emailresponseto'><?php  eT(""Send detailed notification email to:""); ?></label>
                            <input class=""form-control inherit-edit <?php echo ($bShowInherited && $emailresponseto === 'inherit' ? 'hide' : 'show'); ?>"" type='<?php echo ($bShowInherited)?'text':'email'; ?>' size='50' id='emailresponseto' name='emailresponseto' value=""<?php echo htmlspecialchars($emailresponseto); ?>"" data-inherit-value=""inherit"" data-saved-value=""<?php echo $emailresponseto; ?>""/>
                            <input class=""form-control inherit-edit <?php echo ($bShowInherited && $emailresponseto === 'inherit' ? 'hide' : 'show'); ?>"" type='<?php echo ($bShowInherited)?'text':'email'; ?>' size='50' id='emailresponseto' name='emailresponseto' value=""<?php echo htmlspecialchars($emailresponseto); ?>"" data-inherit-value=""inherit"" data-saved-value=""<?php echo htmlspecialchars($emailresponseto); ?>""/>
                            <input class=""form-control inherit-readonly <?php echo ($bShowInherited && $emailresponseto === 'inherit' ? 'show' : 'hide'); ?>"" type='text' size='50' value=""<?php echo htmlspecialchars($oSurveyOptions->emailresponseto); ?>"" readonly />
                    </div>
                    <div class=""col-xs-12 col-sm-12 col-md-4 col-lg-4 content-right <?php echo ($bShowInherited ? 'show' : 'hide'); ?>"">",,
https://huntr.dev/bounties/d6de3d6e-9551-47d1-b28c-7e965c1b82b6/,Account Takeover and Persistence due to the Oauth Misconfiguration in calcom/cal.com,May you all be well on your side of the screen. :),CVE-2023-1647,CWE-284: Improper Access Control,https://www.github.com/calcom/cal.com/commit/c76e5f46101a826b2de39123c22f50c840dddba0,"@@ -45,7 +45,6 @@
    ""@hookform/resolvers"": ""^2.9.7"",
    ""@next-auth/prisma-adapter"": ""^1.0.4"",
    ""@next/bundle-analyzer"": ""^13.1.6"",
    ""@next/font"": ""^13.1.6"",
    ""@radix-ui/react-avatar"": ""^1.0.0"",
    ""@radix-ui/react-collapsible"": ""^1.0.0"",
    ""@radix-ui/react-dialog"": ""^1.0.0"",

","1
apps/web/package.json
@@ -45,7 +45,6 @@
    ""@hookform/resolvers"": ""^2.9.7"",
    ""@next-auth/prisma-adapter"": ""^1.0.4"",
    ""@next/bundle-analyzer"": ""^13.1.6"",
    ""@next/font"": ""^13.1.6"",
    ""@radix-ui/react-avatar"": ""^1.0.0"",
    ""@radix-ui/react-collapsible"": ""^1.0.0"",
    ""@radix-ui/react-dialog"": ""^1.0.0"",
5
yarn.lock
@@ -5140,11 +5140,6 @@
  dependencies:
    glob ""7.1.7""

""@next/font@^13.1.6"":
  version ""13.2.1""
  resolved ""https://registry.yarnpkg.com/@next/font/-/font-13.2.1.tgz#3723342727193116b904c798a1c054db02e07c22""
  integrity sha512-4sergLt7xp9+mZuKME/xM4tLlHGTcmL7naCq0qCTcAlof6NnttshYgiLOdhSiy0NcI+/yM3BjvdEk++O96UzTg==

""@next/swc-android-arm-eabi@13.2.3"":
  version ""13.2.3""
  resolved ""https://registry.yarnpkg.com/@next/swc-android-arm-eabi/-/swc-android-arm-eabi-13.2.3.tgz#85eed560c87c7996558c868a117be9780778f192""",,
https://huntr.dev/bounties/1fe8f21a-c438-4cba-9add-e8a5dab94e28/,LFI/RFI in MLflow in mlflow/mlflow,Local and Remote File Include in MLflow,CVE-2023-1177,CWE-29: Path Traversal: '\..\filename',https://www.github.com/mlflow/mlflow/commit/7162a50c654792c21f3e4a160eb1a0e6a34f6e6e,"@@ -1573,7 +1573,7 @@ def _download_artifact(artifact_path):
    A request handler for `GET /mlflow-artifacts/artifacts/<artifact_path>` to download an artifact
    from `artifact_path` (a relative path from the root artifact directory).
    """"""
    validate_path_is_safe(validate_path_is_safe)
    tmp_dir = tempfile.TemporaryDirectory()
    artifact_repo = _get_artifact_repo_mlflow_artifacts()
    dst = artifact_repo.download_artifacts(artifact_path, tmp_dir.name)
@@ -1598,7 +1598,7 @@ def _upload_artifact(artifact_path):
    A request handler for `PUT /mlflow-artifacts/artifacts/<artifact_path>` to upload an artifact
    to `artifact_path` (a relative path from the root artifact directory).
    """"""
    validate_path_is_safe(validate_path_is_safe)
    head, tail = posixpath.split(artifact_path)
    with tempfile.TemporaryDirectory() as tmp_dir:
        tmp_path = os.path.join(tmp_dir, tail)

","4
mlflow/server/handlers.py
@@ -1573,7 +1573,7 @@ def _download_artifact(artifact_path):
    A request handler for `GET /mlflow-artifacts/artifacts/<artifact_path>` to download an artifact
    from `artifact_path` (a relative path from the root artifact directory).
    """"""
    validate_path_is_safe(validate_path_is_safe)
    validate_path_is_safe(artifact_path)
    tmp_dir = tempfile.TemporaryDirectory()
    artifact_repo = _get_artifact_repo_mlflow_artifacts()
    dst = artifact_repo.download_artifacts(artifact_path, tmp_dir.name)
@@ -1598,7 +1598,7 @@ def _upload_artifact(artifact_path):
    A request handler for `PUT /mlflow-artifacts/artifacts/<artifact_path>` to upload an artifact
    to `artifact_path` (a relative path from the root artifact directory).
    """"""
    validate_path_is_safe(validate_path_is_safe)
    validate_path_is_safe(artifact_path)
    head, tail = posixpath.split(artifact_path)
    with tempfile.TemporaryDirectory() as tmp_dir:
        tmp_path = os.path.join(tmp_dir, tail)",,
https://huntr.dev/bounties/ae92f814-6a08-435c-8445-eec0ef4f1085/,Blind LFI in register-model/get?name= in mlflow/mlflow,A blind LFI exists in /ajax-api/2.0/mlflow/registered-models/get?name=,CVE-2023-1176,CWE-36: Absolute Path Traversal,https://www.github.com/mlflow/mlflow/commit/63ef72aa4334a6473ce7f889573c92fcae0b3c0d,"@@ -37,7 +37,7 @@
from mlflow.utils.validation import (
    _validate_registered_model_tag,
    _validate_model_version_tag,
    _validate_model_name,
    _validate_model_version,
    _validate_tag_name,
)
@@ -56,6 +56,7 @@
    make_containing_dirs,
    list_all,
    local_file_uri_to_path,

)
from mlflow.utils.time_utils import get_current_time_millis

@@ -67,6 +68,15 @@ def _default_root_dir():
    return get_env(_REGISTRY_DIR_ENV_VAR) or os.path.abspath(DEFAULT_LOCAL_FILE_AND_ARTIFACT_PATH)











class FileStore(AbstractStore):
    MODELS_FOLDER_NAME = ""models""
    META_DATA_FILE_NAME = ""meta.yaml""

@@ -711,3 +711,10 @@ def shutil_copytree_without_file_permissions(src_dir, dst_dir):
            relative_file_path = os.path.relpath(file_path, src_dir)
            abs_file_path = os.path.join(dst_dir, relative_file_path)
            shutil.copyfile(file_path, abs_file_path)







@@ -62,6 +62,14 @@ def test_create_registered_model(store):
    assert model.tags == {}










def _verify_registered_model(fs, name, rm_data):
    rm = fs.get_registered_model(name)
    assert rm.name == name

","12
mlflow/store/model_registry/file_store.py
@@ -37,7 +37,7 @@
from mlflow.utils.validation import (
    _validate_registered_model_tag,
    _validate_model_version_tag,
    _validate_model_name,
    _validate_model_name as _original_validate_model_name,
    _validate_model_version,
    _validate_tag_name,
)
@@ -56,6 +56,7 @@
    make_containing_dirs,
    list_all,
    local_file_uri_to_path,
    contains_path_separator,
)
from mlflow.utils.time_utils import get_current_time_millis

@@ -67,6 +68,15 @@ def _default_root_dir():
    return get_env(_REGISTRY_DIR_ENV_VAR) or os.path.abspath(DEFAULT_LOCAL_FILE_AND_ARTIFACT_PATH)


def _validate_model_name(name):
    _original_validate_model_name(name)
    if contains_path_separator(name):
        raise MlflowException(
            f""Invalid name: '{name}'. Registered model name cannot contain path separator"",
            INVALID_PARAMETER_VALUE,
        )


class FileStore(AbstractStore):
    MODELS_FOLDER_NAME = ""models""
    META_DATA_FILE_NAME = ""meta.yaml""
7
mlflow/utils/file_utils.py
@@ -711,3 +711,10 @@ def shutil_copytree_without_file_permissions(src_dir, dst_dir):
            relative_file_path = os.path.relpath(file_path, src_dir)
            abs_file_path = os.path.join(dst_dir, relative_file_path)
            shutil.copyfile(file_path, abs_file_path)


def contains_path_separator(path):
    """"""
    Returns True if a path contains a path separator, False otherwise.
    """"""
    return any((sep in path) for sep in (os.path.sep, os.path.altsep) if sep is not None)
8
tests/store/model_registry/test_file_store.py
@@ -62,6 +62,14 @@ def test_create_registered_model(store):
    assert model.tags == {}


def test_create_registered_model_with_name_that_looks_like_path(store, tmp_path):
    name = str(tmp_path.joinpath(""test""))
    with pytest.raises(
        MlflowException, match=r""Registered model name cannot contain path separator""
    ):
        store.get_registered_model(name)


def _verify_registered_model(fs, name, rm_data):
    rm = fs.get_registered_model(name)
    assert rm.name == name",,
https://huntr.dev/bounties/9dddcf5b-7dd4-46cc-abf9-172dce20bab2/,SIGSEGV at libr/bin/p/bin_coff.c:509 in patch_relocs() in radareorg/radare2,"radare2 5.8.2 misparses symbol information in COFF files, causing a segmentation fault in patch_relocs at libr/bin/p/bin_coff.c:509",CVE-2023-1605,CWE-400: Denial of Service,https://www.github.com/radareorg/radare2/commit/508a6307045441defd1bef0999a1f7052097613f,"@@ -505,11 +505,13 @@ static RList *patch_relocs(RBin *b) {

 size_t nimports = 0;
 int i;
 for (i = 0; i < bin->hdr.f_nsyms; i++) {
  if (is_imported_symbol (&bin->symbols[i])) {
   nimports++;



  }
  i += bin->symbols[i].n_numaux;
 }
 ut64 m_vaddr = UT64_MAX;
 if (nimports) {

","10
libr/bin/p/bin_coff.c
@@ -505,11 +505,13 @@ static RList *patch_relocs(RBin *b) {

 size_t nimports = 0;
 int i;
 for (i = 0; i < bin->hdr.f_nsyms; i++) {
  if (is_imported_symbol (&bin->symbols[i])) {
   nimports++;
 if (bin->symbols) {
  for (i = 0; i < bin->hdr.f_nsyms; i++) {
   if (is_imported_symbol (&bin->symbols[i])) {
    nimports++;
   }
   i += bin->symbols[i].n_numaux;
  }
  i += bin->symbols[i].n_numaux;
 }
 ut64 m_vaddr = UT64_MAX;
 if (nimports) {",,
https://huntr.dev/bounties/8777916f-81f1-440f-b50b-a41d8c0639b6/,Stored HTML injection and Potential Cross Site Scripting in pixelfed ?0.11.4 in pixelfed/pixelfed,pixelfed ?0.11.4 is affected by HTML injection and Potential Cross Site Scripting vulnerability.,,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/pixelfed/pixelfed/commit/9bbd6dcd2338d2b3e05649240e9e1737687fa59b,"@@ -6,6 +6,7 @@







@@ -17,178 +18,226 @@
















































































































































































































































































































































































































@@ -4,6 +4,7 @@







@@ -157,7 +158,7 @@ protected function create(array $data)









@@ -191,6 +191,7 @@








",,,
https://huntr.dev/bounties/7e441a14-8e55-4ab4-932c-4dc56bb1bc2e/,SQL injection search function in pimcore/pimcore,Please enter a description of the vulnerability.,CVE-2023-1578,CWE-89: SQL Injection,https://www.github.com/pimcore/pimcore/commit/367b74488808d71ec3f66f4ca9e8df5217c2c8d2,"@@ -77,9 +77,9 @@ public function findAction(Request $request, EventDispatcherInterface $eventDisp

        $query = $this->filterQueryParam($allParams['query'] ?? '');

        $types = explode(',', $allParams['type'] ?? '');
        $subtypes = explode(',', $allParams['subtype'] ?? '');
        $classnames = explode(',', $allParams['class'] ?? '');

        $offset = (int)$allParams['start'];
        $limit = (int)$allParams['limit'];

","6
bundles/AdminBundle/Controller/Searchadmin/SearchController.php
@@ -77,9 +77,9 @@ public function findAction(Request $request, EventDispatcherInterface $eventDisp

        $query = $this->filterQueryParam($allParams['query'] ?? '');

        $types = explode(',', $allParams['type'] ?? '');
        $subtypes = explode(',', $allParams['subtype'] ?? '');
        $classnames = explode(',', $allParams['class'] ?? '');
        $types = explode(',', preg_replace(""/[^a-z,]/i"", '', $allParams['type'] ?? ''));
        $subtypes = explode(',', preg_replace(""/[^a-z,]/i"", '', $allParams['subtype'] ?? ''));
        $classnames = explode(',', preg_replace(""/[^a-z0-9_,]/i"", '', $allParams['class'] ?? ''));

        $offset = (int)$allParams['start'];
        $limit = (int)$allParams['limit'];",,
https://huntr.dev/bounties/942c015f-7486-49b1-94ae-b1538d812bc2/,SQL injection in API authorization check in nilsteampassnet/teampass,TeamPass /authorize API endpoint is vulnerable to SQL injection in the login field. It is possible to forge an arbitrary Blowfish hash and use it in the query to bypass the password verification check. Using the same query it is possible to define an arbitrary apikey value too:,CVE-2023-1545,CWE-89: SQL Injection,https://www.github.com/nilsteampassnet/teampass/commit/4780252fdb600ef2ec2758f17a37d738570cbe66,"@@ -41,42 +41,71 @@ class AuthModel extends Database
     */
    public function getUserAuth(string $login, string $password, string $apikey): array
    {
        // Check if user exists
        $userInfoRes = $this->select(""SELECT id, pw, public_key, private_key, personal_folder, fonction_id, groupes_visibles, groupes_interdits, user_api_key FROM "" . prefixTable('users') . "" WHERE login='"".$login.""'"");
        $userInfoRes[0]['special'] = '';
        $userInfo = $userInfoRes[0];















        // Check password
        include_once API_ROOT_PATH . '/../sources/SplClassLoader.php';
        $pwdlib = new SplClassLoader('PasswordLib', API_ROOT_PATH . '/../includes/libraries');
        $pwdlib->register();
        $pwdlib = new PasswordLib\PasswordLib();
        if ($pwdlib->verifyPasswordHash($password, $userInfo['pw']) === true) {
            // Correct credentials
            // Now check apikey
            // We check if it is the correct user api or if it is a generic api key
            $apiInfo = $this->select(""SELECT count(*) FROM "" . prefixTable('api') . "" WHERE value='"".$apikey.""'"");
            if ($apikey === $userInfo['user_api_key'] || (int) $apiInfo[0]['count(*)'] === 1) {

















                // get user keys
                $privateKeyClear = decryptPrivateKey($password, (string) $userInfo['private_key']); //prepareUserEncryptionKeys($userInfo, $password);

                // get user folders list
                $folders = $this->buildUserFoldersList($userInfo);

                // create JWT
                return $this->createUserJWT(
                    $userInfo['id'],
                    $login,
                    $userInfo['personal_folder'],
                    $userInfo['public_key'],
                    $privateKeyClear,
                    implode("","", $folders)
                );
            } else {
                return [""error"" => ""Login failed."", ""apikey"" => ""Not valid""];
            }
        } else {
            return [""error"" => ""Login failed."", ""password"" => $password];
        }
    }
    //end getUserAuth

","69
api/Model/AuthModel.php
@@ -41,42 +41,71 @@ class AuthModel extends Database
     */
    public function getUserAuth(string $login, string $password, string $apikey): array
    {
        // Check if user exists
        $userInfoRes = $this->select(""SELECT id, pw, public_key, private_key, personal_folder, fonction_id, groupes_visibles, groupes_interdits, user_api_key FROM "" . prefixTable('users') . "" WHERE login='"".$login.""'"");
        $userInfoRes[0]['special'] = '';
        $userInfo = $userInfoRes[0];
        // Sanitize
        include_once API_ROOT_PATH . '/../sources/main.functions.php';
        $inputData = dataSanitizer(
            [
                'login' => isset($login) === true ? $login : '',
                'password' => isset($password) === true ? $password : '',
                'apikey' => isset($apikey) === true ? $apikey : '',
            ],
            [
                'login' => 'trim|escape',
                'password' => 'trim|escape',
                'apikey' => 'trim|escape',
            ],
            API_ROOT_PATH . '/..'
        );
        if (empty($inputData['login']) === true || empty($inputData['apikey']) === true) {
            return [""error"" => ""Login failed.""];
        }

        // Check password
        include_once API_ROOT_PATH . '/../sources/SplClassLoader.php';
        $pwdlib = new SplClassLoader('PasswordLib', API_ROOT_PATH . '/../includes/libraries');
        $pwdlib->register();
        $pwdlib = new PasswordLib\PasswordLib();
        if ($pwdlib->verifyPasswordHash($password, $userInfo['pw']) === true) {
            // Correct credentials
            // Now check apikey
            // We check if it is the correct user api or if it is a generic api key
            $apiInfo = $this->select(""SELECT count(*) FROM "" . prefixTable('api') . "" WHERE value='"".$apikey.""'"");
            if ($apikey === $userInfo['user_api_key'] || (int) $apiInfo[0]['count(*)'] === 1) {
        // Check apikey
        if (empty($inputData['password']) === true) {
            // case where it is a generic key
            $apiInfo = $this->select(""SELECT count(*) FROM "" . prefixTable('api') . "" WHERE value='"".$inputData['apikey'].""' AND label='"".$inputData['login'].""'"");
            if ((int) $apiInfo[0]['count(*)'] === 0) {
                return [""error"" => ""Login failed."", ""apikey"" => ""Not valid""];
            }

            return [""error"" => ""Not managed.""];
        } else {
            // case where it is a user api key
            $apiInfo = $this->select(""SELECT count(*) FROM "" . prefixTable('users') . "" WHERE user_api_key='"".$inputData['apikey'].""' AND login='"".$inputData['login'].""'"");
            if ((int) $apiInfo[0]['count(*)'] === 0) {
                return [""error"" => ""Login failed."", ""apikey"" => ""Not valid""];
            }

            // Check if user exists
            $userInfoRes = $this->select(""SELECT id, pw, public_key, private_key, personal_folder, fonction_id, groupes_visibles, groupes_interdits, user_api_key FROM "" . prefixTable('users') . "" WHERE login='"".$inputData['login'].""'"");
            $userInfoRes[0]['special'] = '';
            $userInfo = $userInfoRes[0];

            // Check password
            include_once API_ROOT_PATH . '/../sources/SplClassLoader.php';
            $pwdlib = new SplClassLoader('PasswordLib', API_ROOT_PATH . '/../includes/libraries');
            $pwdlib->register();
            $pwdlib = new PasswordLib\PasswordLib();
            if ($pwdlib->verifyPasswordHash($inputData['password'], $userInfo['pw']) === true) {
                // Correct credentials
                // get user keys
                $privateKeyClear = decryptPrivateKey($password, (string) $userInfo['private_key']); //prepareUserEncryptionKeys($userInfo, $password);
                $privateKeyClear = decryptPrivateKey($inputData['password'], (string) $userInfo['private_key']);

                // get user folders list
                $folders = $this->buildUserFoldersList($userInfo);

                // create JWT
                return $this->createUserJWT(
                    $userInfo['id'],
                    $login,
                    $inputData['login'],
                    $userInfo['personal_folder'],
                    $userInfo['public_key'],
                    $privateKeyClear,
                    implode("","", $folders)
                );
            } else {
                return [""error"" => ""Login failed."", ""apikey"" => ""Not valid""];
                return [""error"" => ""Login failed."", ""password"" => ""Not valid""];
            }
        } else {
            return [""error"" => ""Login failed."", ""password"" => $password];
        }
    }
    //end getUserAuth",,
https://huntr.dev/bounties/f82388d6-dfc3-4fbc-bea6-eb40cf5b2683/,Authorization Token Never Expires in answerdev/answer,"The vulnerability is related to the Authorization header used for user login. After logging out, the token in the Authorization header remains valid and does not expire. Additionally, the token has an excessively long duration of 10 hours, as confirmed by a request.",CVE-2023-1543,CWE-613: Insufficient Session Expiration,https://www.github.com/answerdev/answer/commit/cd742b75605c99776f32d271c0a60e0f468e181c,"@@ -203,6 +203,7 @@ func (uc *UserController) UserLogout(ctx *gin.Context) {
  return
 }
 _ = uc.authService.RemoveUserCacheInfo(ctx, accessToken)

 handler.HandleResponse(ctx, nil, nil)
}


","1
internal/controller/user_controller.go
@@ -203,6 +203,7 @@ func (uc *UserController) UserLogout(ctx *gin.Context) {
  return
 }
 _ = uc.authService.RemoveUserCacheInfo(ctx, accessToken)
 _ = uc.authService.RemoveAdminUserCacheInfo(ctx, accessToken)
 handler.HandleResponse(ctx, nil, nil)
}",,
https://huntr.dev/bounties/d947417c-5a12-407a-9a2f-fa696f65126f/,Insecure Business Logic - Client Side Enforcement Bypass on User Account Deletion in answerdev/answer,"The application enforces account deletion on the client-side with a popup that states the admin account cannot be deleted. Additionally, regular users do not have an option in the interface to delete their own account.",CVE-2023-1542,CWE-840: Business Logic Errors,https://www.github.com/answerdev/answer/commit/4ca2429d190a6e614f5bbee1173c80a7cffcc568,"@@ -37,6 +37,8 @@ backend:
    admin:
      cannot_update_their_password:
        other: You cannot modify your password.


      email_or_password_wrong:
        other: Email and password do not match.
    answer:

@@ -65,4 +65,5 @@ const (
 NotAllowedRegistration           = ""error.user.not_allowed_registration""
 SMTPConfigFromNameCannotBeEmail  = ""error.smtp.config_from_name_cannot_be_email""
 AdminCannotUpdateTheirPassword   = ""error.admin.cannot_update_their_password""

)
@@ -34,6 +34,8 @@ func (uc *UserAdminController) UpdateUserStatus(ctx *gin.Context) {
  return
 }



 err := uc.userService.UpdateUserStatus(ctx, req)
 handler.HandleResponse(ctx, err, nil)
}

@@ -2,10 +2,9 @@ package schema

// UpdateUserStatusReq update user request
type UpdateUserStatusReq struct {
 // user id
 UserID string `validate:""required"" json:""user_id""`
 // user status
 Status string `validate:""required,oneof=normal suspended deleted inactive"" json:""status"" enums:""normal,suspended,deleted,inactive""`
}

const (

@@ -61,6 +61,10 @@ func NewUserAdminService(

// UpdateUserStatus update user
func (us *UserAdminService) UpdateUserStatus(ctx context.Context, req *schema.UpdateUserStatusReq) (err error) {




 userInfo, exist, err := us.userRepo.GetUserInfo(ctx, req.UserID)
 if err != nil {
  return

","2
i18n/en_US.yaml
@@ -37,6 +37,8 @@ backend:
    admin:
      cannot_update_their_password:
        other: You cannot modify your password.
      cannot_modify_self_status:
        other: You cannot modify your status.
      email_or_password_wrong:
        other: Email and password do not match.
    answer:
1
internal/base/reason/reason.go
@@ -65,4 +65,5 @@ const (
 NotAllowedRegistration           = ""error.user.not_allowed_registration""
 SMTPConfigFromNameCannotBeEmail  = ""error.smtp.config_from_name_cannot_be_email""
 AdminCannotUpdateTheirPassword   = ""error.admin.cannot_update_their_password""
 AdminCannotModifySelfStatus      = ""error.admin.cannot_modify_self_status""
)
2
internal/controller_admin/user_backyard_controller.go
@@ -34,6 +34,8 @@ func (uc *UserAdminController) UpdateUserStatus(ctx *gin.Context) {
  return
 }

 req.LoginUserID = middleware.GetLoginUserIDFromContext(ctx)

 err := uc.userService.UpdateUserStatus(ctx, req)
 handler.HandleResponse(ctx, err, nil)
}
7
internal/schema/backyard_user_schema.go
@@ -2,10 +2,9 @@ package schema

// UpdateUserStatusReq update user request
type UpdateUserStatusReq struct {
 // user id
 UserID string `validate:""required"" json:""user_id""`
 // user status
 Status string `validate:""required,oneof=normal suspended deleted inactive"" json:""status"" enums:""normal,suspended,deleted,inactive""`
 UserID      string `validate:""required"" json:""user_id""`
 Status      string `validate:""required,oneof=normal suspended deleted inactive"" json:""status"" enums:""normal,suspended,deleted,inactive""`
 LoginUserID string `json:""-""`
}

const (
4
internal/service/user_admin/user_backyard.go
@@ -61,6 +61,10 @@ func NewUserAdminService(

// UpdateUserStatus update user
func (us *UserAdminService) UpdateUserStatus(ctx context.Context, req *schema.UpdateUserStatusReq) (err error) {
 // Admin cannot modify their status
 if req.UserID == req.LoginUserID {
  return errors.BadRequest(reason.AdminCannotModifySelfStatus)
 }
 userInfo, exist, err := us.userRepo.GetUserInfo(ctx, req.UserID)
 if err != nil {
  return",,
https://huntr.dev/bounties/8fd891c6-b04e-4dac-818f-9ea30861cd92/,Admin Able To Perform Operations On Themselves By Interacting With API in answerdev/answer,"When setting a password through /admin/users URI, the admin is not allowed to set their own new password through this URI. If they attempt to do so, they receive an error stating Forbidden to operate on yourself. But this is easily bypassable by interacting with the API: if you set a new password for another user, then change the user_id parameter within the request to the admin user ID.",CVE-2023-1541,CWE-840: Business Logic Errors,https://www.github.com/answerdev/answer/commit/15390adbfcd5fd37af4661f992f8873ae5a6b840,"@@ -35,6 +35,8 @@ backend:
    other: Email and password do not match.
  error:
    admin:


      email_or_password_wrong:
        other: Email and password do not match.
    answer:

@@ -64,4 +64,5 @@ const (
 TagCannotSetSynonymAsItself      = ""error.tag.cannot_set_synonym_as_itself""
 NotAllowedRegistration           = ""error.user.not_allowed_registration""
 SMTPConfigFromNameCannotBeEmail  = ""error.smtp.config_from_name_cannot_be_email""

)
@@ -153,6 +153,10 @@ func (us *UserAdminService) AddUser(ctx context.Context, req *schema.AddUserReq)

// UpdateUserPassword update user password
func (us *UserAdminService) UpdateUserPassword(ctx context.Context, req *schema.UpdateUserPasswordReq) (err error) {




 userInfo, exist, err := us.userRepo.GetUserInfo(ctx, req.UserID)
 if err != nil {
  return err

","2
i18n/en_US.yaml
@@ -35,6 +35,8 @@ backend:
    other: Email and password do not match.
  error:
    admin:
      cannot_update_their_password:
        other: You cannot modify your password.
      email_or_password_wrong:
        other: Email and password do not match.
    answer:
1
internal/base/reason/reason.go
@@ -64,4 +64,5 @@ const (
 TagCannotSetSynonymAsItself      = ""error.tag.cannot_set_synonym_as_itself""
 NotAllowedRegistration           = ""error.user.not_allowed_registration""
 SMTPConfigFromNameCannotBeEmail  = ""error.smtp.config_from_name_cannot_be_email""
 AdminCannotUpdateTheirPassword   = ""error.admin.cannot_update_their_password""
)
4
internal/service/user_admin/user_backyard.go
@@ -153,6 +153,10 @@ func (us *UserAdminService) AddUser(ctx context.Context, req *schema.AddUserReq)

// UpdateUserPassword update user password
func (us *UserAdminService) UpdateUserPassword(ctx context.Context, req *schema.UpdateUserPasswordReq) (err error) {
 // Users cannot modify their password
 if req.UserID == req.LoginUserID {
  return errors.BadRequest(reason.AdminCannotUpdateTheirPassword)
 }
 userInfo, exist, err := us.userRepo.GetUserInfo(ctx, req.UserID)
 if err != nil {
  return err",,
https://huntr.dev/bounties/d8d6c259-a0f2-4209-a3b0-ecbf3eb092f4/,Observable Response Discrepancy in Password Reset Functionality in answerdev/answer,"The password reset functionality leaks information pertaining to use accounts. Where an invalid account is utilized, the application responds that the account could not be found. Where an account is valid, the application responds with a reason ""base.success"" (when intercepted), or that if an account with that name is identified it will receive an email (browser response).",CVE-2023-1540,CWE-204: Observable Response Discrepancy,https://www.github.com/answerdev/answer/commit/1de3ec27e50ba7389c9449c59e8ea3a37a908ee4,"@@ -157,7 +157,7 @@ func (uc *UserController) RetrievePassWord(ctx *gin.Context) {
  return
 }
 _, _ = uc.actionService.ActionRecordAdd(ctx, schema.ActionRecordTypeFindPass, ctx.ClientIP())
 _, err := uc.userService.RetrievePassWord(ctx, req)
 handler.HandleResponse(ctx, err, nil)
}


@@ -149,13 +149,13 @@ func (us *UserService) EmailLogin(ctx context.Context, req *schema.UserEmailLogi
}

// RetrievePassWord .
func (us *UserService) RetrievePassWord(ctx context.Context, req *schema.UserRetrievePassWordRequest) (string, error) {
 userInfo, has, err := us.userRepo.GetByEmail(ctx, req.Email)
 if err != nil {
  return """", err
 }
 if !has {
  return """", errors.BadRequest(reason.UserNotFound)
 }

 // send email
@@ -167,10 +167,10 @@ func (us *UserService) RetrievePassWord(ctx context.Context, req *schema.UserRet
 verifyEmailURL := fmt.Sprintf(""%s/users/password-reset?code=%s"", us.getSiteUrl(ctx), code)
 title, body, err := us.emailService.PassResetTemplate(ctx, verifyEmailURL)
 if err != nil {
  return """", err
 }
 go us.emailService.SendAndSaveCode(ctx, req.Email, title, body, code, data.ToJSONString())
 return code, nil
}

// UseRePassword

","2
internal/controller/user_controller.go
@@ -157,7 +157,7 @@ func (uc *UserController) RetrievePassWord(ctx *gin.Context) {
  return
 }
 _, _ = uc.actionService.ActionRecordAdd(ctx, schema.ActionRecordTypeFindPass, ctx.ClientIP())
 _, err := uc.userService.RetrievePassWord(ctx, req)
 err := uc.userService.RetrievePassWord(ctx, req)
 handler.HandleResponse(ctx, err, nil)
}

10
internal/service/user_service.go
@@ -149,13 +149,13 @@ func (us *UserService) EmailLogin(ctx context.Context, req *schema.UserEmailLogi
}

// RetrievePassWord .
func (us *UserService) RetrievePassWord(ctx context.Context, req *schema.UserRetrievePassWordRequest) (string, error) {
func (us *UserService) RetrievePassWord(ctx context.Context, req *schema.UserRetrievePassWordRequest) error {
 userInfo, has, err := us.userRepo.GetByEmail(ctx, req.Email)
 if err != nil {
  return """", err
  return err
 }
 if !has {
  return """", errors.BadRequest(reason.UserNotFound)
  return nil
 }

 // send email
@@ -167,10 +167,10 @@ func (us *UserService) RetrievePassWord(ctx context.Context, req *schema.UserRet
 verifyEmailURL := fmt.Sprintf(""%s/users/password-reset?code=%s"", us.getSiteUrl(ctx), code)
 title, body, err := us.emailService.PassResetTemplate(ctx, verifyEmailURL)
 if err != nil {
  return """", err
  return err
 }
 go us.emailService.SendAndSaveCode(ctx, req.Email, title, body, code, data.ToJSONString())
 return code, nil
 return nil
}

// UseRePassword",,
https://huntr.dev/bounties/b4df67f4-14ea-4051-97d4-26690c979a28/,Captcha Bypass on login in answerdev/answer,"So if we login incorrectly multiple times, we get captcha. Each captcha has ""captcha_id"" and solve ""captcha_code"" For example: ""captcha_code"":""8awt"" ""captcha_id"":""7nToXDrT6SkJ2BJxKG1u"" You can use same captcha code and captcha id in login without any problem",CVE-2023-1539,CWE-804: Guessable CAPTCHA,https://www.github.com/answerdev/answer/commit/813ad0b9894673b1bdd489a2e9ab60a44fe990af,"@@ -68,3 +68,11 @@ func (cr *captchaRepo) GetCaptcha(ctx context.Context, key string) (captcha stri
 }
 return captcha, nil
}








@@ -16,6 +16,7 @@ import (
type CaptchaRepo interface {
 SetCaptcha(ctx context.Context, key, captcha string) (err error)
 GetCaptcha(ctx context.Context, key string) (captcha string, err error)

 SetActionType(ctx context.Context, ip, actionType string, amount int) (err error)
 GetActionType(ctx context.Context, ip, actionType string) (amount int, err error)
 DelActionType(ctx context.Context, ip, actionType string) (err error)
@@ -143,6 +144,12 @@ func (cs *CaptchaService) GenerateCaptcha(ctx context.Context) (key, captchaBase
func (cs *CaptchaService) VerifyCaptcha(ctx context.Context, key, captcha string) (isCorrect bool, err error) {
 realCaptcha, err := cs.captchaRepo.GetCaptcha(ctx, key)
 if err != nil {






  return false, nil
 }
 return strings.TrimSpace(captcha) == realCaptcha, nil

","8
internal/repo/captcha/captcha.go
@@ -68,3 +68,11 @@ func (cr *captchaRepo) GetCaptcha(ctx context.Context, key string) (captcha stri
 }
 return captcha, nil
}

func (cr *captchaRepo) DelCaptcha(ctx context.Context, key string) (err error) {
 err = cr.data.Cache.Del(ctx, key)
 if err != nil {
  log.Debug(err)
 }
 return nil
}
7
internal/service/action/captcha_service.go
@@ -16,6 +16,7 @@ import (
type CaptchaRepo interface {
 SetCaptcha(ctx context.Context, key, captcha string) (err error)
 GetCaptcha(ctx context.Context, key string) (captcha string, err error)
 DelCaptcha(ctx context.Context, key string) (err error)
 SetActionType(ctx context.Context, ip, actionType string, amount int) (err error)
 GetActionType(ctx context.Context, ip, actionType string) (amount int, err error)
 DelActionType(ctx context.Context, ip, actionType string) (err error)
@@ -143,6 +144,12 @@ func (cs *CaptchaService) GenerateCaptcha(ctx context.Context) (key, captchaBase
func (cs *CaptchaService) VerifyCaptcha(ctx context.Context, key, captcha string) (isCorrect bool, err error) {
 realCaptcha, err := cs.captchaRepo.GetCaptcha(ctx, key)
 if err != nil {
  log.Error(""VerifyCaptcha GetCaptcha Error"", err.Error())
  return false, nil
 }
 err = cs.captchaRepo.DelCaptcha(ctx, key)
 if err != nil {
  log.Error(""VerifyCaptcha DelCaptcha Error"", err.Error())
  return false, nil
 }
 return strings.TrimSpace(captcha) == realCaptcha, nil",,
https://huntr.dev/bounties/ac0271eb-660f-4966-8b57-4bc660a9a1a0/,Observable Timing Discrepancy in Login Portal in answerdev/answer,"An observable discrepancy in response times is present in the login portal. When brute forcing valid email accounts, the timing on a valid account is significantly higher than that of an invalid user account. This is likely due to the use of Bcrypt's compare function being utilized by the application.",CVE-2023-1538,CWE-208: Observable Timing Discrepancy,https://www.github.com/answerdev/answer/commit/813ad0b9894673b1bdd489a2e9ab60a44fe990af,"@@ -68,3 +68,11 @@ func (cr *captchaRepo) GetCaptcha(ctx context.Context, key string) (captcha stri
 }
 return captcha, nil
}








@@ -16,6 +16,7 @@ import (
type CaptchaRepo interface {
 SetCaptcha(ctx context.Context, key, captcha string) (err error)
 GetCaptcha(ctx context.Context, key string) (captcha string, err error)

 SetActionType(ctx context.Context, ip, actionType string, amount int) (err error)
 GetActionType(ctx context.Context, ip, actionType string) (amount int, err error)
 DelActionType(ctx context.Context, ip, actionType string) (err error)
@@ -143,6 +144,12 @@ func (cs *CaptchaService) GenerateCaptcha(ctx context.Context) (key, captchaBase
func (cs *CaptchaService) VerifyCaptcha(ctx context.Context, key, captcha string) (isCorrect bool, err error) {
 realCaptcha, err := cs.captchaRepo.GetCaptcha(ctx, key)
 if err != nil {






  return false, nil
 }
 return strings.TrimSpace(captcha) == realCaptcha, nil

","8
internal/repo/captcha/captcha.go
@@ -68,3 +68,11 @@ func (cr *captchaRepo) GetCaptcha(ctx context.Context, key string) (captcha stri
 }
 return captcha, nil
}

func (cr *captchaRepo) DelCaptcha(ctx context.Context, key string) (err error) {
 err = cr.data.Cache.Del(ctx, key)
 if err != nil {
  log.Debug(err)
 }
 return nil
}
7
internal/service/action/captcha_service.go
@@ -16,6 +16,7 @@ import (
type CaptchaRepo interface {
 SetCaptcha(ctx context.Context, key, captcha string) (err error)
 GetCaptcha(ctx context.Context, key string) (captcha string, err error)
 DelCaptcha(ctx context.Context, key string) (err error)
 SetActionType(ctx context.Context, ip, actionType string, amount int) (err error)
 GetActionType(ctx context.Context, ip, actionType string) (amount int, err error)
 DelActionType(ctx context.Context, ip, actionType string) (err error)
@@ -143,6 +144,12 @@ func (cs *CaptchaService) GenerateCaptcha(ctx context.Context) (key, captchaBase
func (cs *CaptchaService) VerifyCaptcha(ctx context.Context, key, captcha string) (isCorrect bool, err error) {
 realCaptcha, err := cs.captchaRepo.GetCaptcha(ctx, key)
 if err != nil {
  log.Error(""VerifyCaptcha GetCaptcha Error"", err.Error())
  return false, nil
 }
 err = cs.captchaRepo.DelCaptcha(ctx, key)
 if err != nil {
  log.Error(""VerifyCaptcha DelCaptcha Error"", err.Error())
  return false, nil
 }
 return strings.TrimSpace(captcha) == realCaptcha, nil",,
https://huntr.dev/bounties/171cde18-a447-446c-a9ab-297953ad9b86/,Captcha Bypass due to invalidation of previous tokens in answerdev/answer,An attacker can create bypass the captcha mechanism and create multiple accounts directly,CVE-2023-1537,CWE-294: Authentication Bypass by Capture-replay,https://www.github.com/answerdev/answer/commit/813ad0b9894673b1bdd489a2e9ab60a44fe990af,"@@ -68,3 +68,11 @@ func (cr *captchaRepo) GetCaptcha(ctx context.Context, key string) (captcha stri
 }
 return captcha, nil
}








@@ -16,6 +16,7 @@ import (
type CaptchaRepo interface {
 SetCaptcha(ctx context.Context, key, captcha string) (err error)
 GetCaptcha(ctx context.Context, key string) (captcha string, err error)

 SetActionType(ctx context.Context, ip, actionType string, amount int) (err error)
 GetActionType(ctx context.Context, ip, actionType string) (amount int, err error)
 DelActionType(ctx context.Context, ip, actionType string) (err error)
@@ -143,6 +144,12 @@ func (cs *CaptchaService) GenerateCaptcha(ctx context.Context) (key, captchaBase
func (cs *CaptchaService) VerifyCaptcha(ctx context.Context, key, captcha string) (isCorrect bool, err error) {
 realCaptcha, err := cs.captchaRepo.GetCaptcha(ctx, key)
 if err != nil {






  return false, nil
 }
 return strings.TrimSpace(captcha) == realCaptcha, nil

","8
internal/repo/captcha/captcha.go
@@ -68,3 +68,11 @@ func (cr *captchaRepo) GetCaptcha(ctx context.Context, key string) (captcha stri
 }
 return captcha, nil
}

func (cr *captchaRepo) DelCaptcha(ctx context.Context, key string) (err error) {
 err = cr.data.Cache.Del(ctx, key)
 if err != nil {
  log.Debug(err)
 }
 return nil
}
7
internal/service/action/captcha_service.go
@@ -16,6 +16,7 @@ import (
type CaptchaRepo interface {
 SetCaptcha(ctx context.Context, key, captcha string) (err error)
 GetCaptcha(ctx context.Context, key string) (captcha string, err error)
 DelCaptcha(ctx context.Context, key string) (err error)
 SetActionType(ctx context.Context, ip, actionType string, amount int) (err error)
 GetActionType(ctx context.Context, ip, actionType string) (amount int, err error)
 DelActionType(ctx context.Context, ip, actionType string) (err error)
@@ -143,6 +144,12 @@ func (cs *CaptchaService) GenerateCaptcha(ctx context.Context) (key, captchaBase
func (cs *CaptchaService) VerifyCaptcha(ctx context.Context, key, captcha string) (isCorrect bool, err error) {
 realCaptcha, err := cs.captchaRepo.GetCaptcha(ctx, key)
 if err != nil {
  log.Error(""VerifyCaptcha GetCaptcha Error"", err.Error())
  return false, nil
 }
 err = cs.captchaRepo.DelCaptcha(ctx, key)
 if err != nil {
  log.Error(""VerifyCaptcha DelCaptcha Error"", err.Error())
  return false, nil
 }
 return strings.TrimSpace(captcha) == realCaptcha, nil",,
https://huntr.dev/bounties/538207f4-f805-419a-a314-51716643f05e/,Store XSS in create tag in answerdev/answer,Feature create tag permit attacker injection html tag and execute it.,CVE-2023-1536,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/c3743bad4f2a69f69f8f1e1e5b4b6524fc03da25,"@@ -32,7 +32,10 @@ func Markdown2HTML(source string) string {
  log.Error(err)
  return source
 }
 return buf.String()



}

// Markdown2BasicHTML convert markdown to html ,Only basic syntax can be used

","5
pkg/converter/markdown.go
@@ -32,7 +32,10 @@ func Markdown2HTML(source string) string {
  log.Error(err)
  return source
 }
 return buf.String()
 html := buf.String()
 filter := bluemonday.NewPolicy()
 html = filter.Sanitize(html)
 return html
}

// Markdown2BasicHTML convert markdown to html ,Only basic syntax can be used",,
https://huntr.dev/bounties/4d4b0caa-6d8c-4574-ae7e-e9ef5e2e1a40/,Multiple XSS @ answer/question/tag in answerdev/answer,The product does not neutralize or incorrectly neutralizes user-controllable input before it is placed in output that is used as a web page that is served to other users.,CVE-2023-1535,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/c3743bad4f2a69f69f8f1e1e5b4b6524fc03da25,"@@ -32,7 +32,10 @@ func Markdown2HTML(source string) string {
  log.Error(err)
  return source
 }
 return buf.String()



}

// Markdown2BasicHTML convert markdown to html ,Only basic syntax can be used

","5
pkg/converter/markdown.go
@@ -32,7 +32,10 @@ func Markdown2HTML(source string) string {
  log.Error(err)
  return source
 }
 return buf.String()
 html := buf.String()
 filter := bluemonday.NewPolicy()
 html = filter.Sanitize(html)
 return html
}

// Markdown2BasicHTML convert markdown to html ,Only basic syntax can be used",,
https://huntr.dev/bounties/f0272a31-9944-4545-8428-a26154d20348/,Bad Sanitization on "vtlib_purify" function leads to XSS in tsolucio/corebos,"The whole project is using ""vtlib_purify"" for the sanitization of user inputs. It does a good job while stripping HTML tags like <script> <svg> etc. However, it allows <a> tag and we can use javascript protocol on the href attribute via changing : character to &colon;. So, our final payload is <a href=javascript&colon;alert(document.domain)>click",CVE-2023-1527,CWE-79: Cross-site Scripting (XSS) - Generic,https://www.github.com/tsolucio/corebos/commit/aaaca69185bce2be6a82956c69541938dc871268,"@@ -480,6 +480,16 @@ function vtlib_purify($input, $ignore = false) {
    }
   } else { // Simple type
    $value = $__htmlpurifier_instance->purify($input);










   }
  }
 }

","10
include/utils/VtlibUtils.php
@@ -480,6 +480,16 @@ function vtlib_purify($input, $ignore = false) {
    }
   } else { // Simple type
    $value = $__htmlpurifier_instance->purify($input);
    if (strpos($value, '<a') !== false && strpos($value, 'javascript') !== false) {
     $dom = new DOMDocument;
     $dom->loadHTML($value, LIBXML_HTML_NODEFDTD | LIBXML_HTML_NOIMPLIED);
     foreach ($dom->getElementsByTagName('a') as $node) {
      if ($node->hasAttribute('href') && !filter_var($node->getAttribute('href'), FILTER_VALIDATE_URL) !== false) {
       $node->removeAttribute('href');
       $value = trim($dom->saveHTML(), ""\n"");
      }
     }
    }
   }
  }
 }",,
https://huntr.dev/bounties/82adf0dd-8ebd-4d15-9f91-6060c8fa5a0d/,XSS in Schedule tab of Documents in pimcore/pimcore,pimcore is vulnerable to XSS at Time field in Schedule tab of Document.,CVE-2023-1517,CWE-79: Cross-site Scripting (XSS) - DOM,https://www.github.com/pimcore/pimcore/commit/3a22700dacd8a439cffcb208838a4199e732cff7,"@@ -141,6 +141,14 @@ pimcore.element.scheduler = Class.create({
                {text: t(""date""), width: 120, sortable: true, dataIndex: 'date', editor: new Ext.form.DateField()                },
                {text: t(""time""), width: 100, sortable: true, dataIndex: 'time', editor: new Ext.form.TimeField({
                        format: ""H:i"",








                    })
                },
                {text: t(""action""), width: 100, sortable: false, dataIndex: 'action', editor: new Ext.form.ComboBox({

","8
bundles/AdminBundle/Resources/public/js/pimcore/element/scheduler.js
@@ -141,6 +141,14 @@ pimcore.element.scheduler = Class.create({
                {text: t(""date""), width: 120, sortable: true, dataIndex: 'date', editor: new Ext.form.DateField()                },
                {text: t(""time""), width: 100, sortable: true, dataIndex: 'time', editor: new Ext.form.TimeField({
                        format: ""H:i"",
                        listeners: {
                            focus : function(component) {
                                component.setValue(Ext.util.Format.htmlDecode(component.value));
                            },
                            blur: function(component){
                                component.setValue(Ext.util.Format.htmlEncode(component.value));
                            }
                        }
                    })
                },
                {text: t(""action""), width: 100, sortable: false, dataIndex: 'action', editor: new Ext.form.ComboBox({",,
https://huntr.dev/bounties/ae0f2ec4-a245-4d0b-9d4d-bd8310dd6282/,Stored XSS in the Redirects module in pimcore/pimcore,pimcore is vulnerable to Stored XSS at Expiry field in the Redirects module.,CVE-2023-1515,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/pimcore/pimcore/commit/44c6b37aa649a0e3105fa41f3d74a3e511acf964,"@@ -286,7 +286,12 @@ pimcore.settings.redirects = Class.create({
                flex: 150, sortable:true, dataIndex: ""expiry"",
                editor: {
                    xtype: 'datefield',
                    format: 'Y-m-d'





                },
                renderer:
                    function(d) {

","7
bundles/AdminBundle/Resources/public/js/pimcore/settings/redirects.js
@@ -286,7 +286,12 @@ pimcore.settings.redirects = Class.create({
                flex: 150, sortable:true, dataIndex: ""expiry"",
                editor: {
                    xtype: 'datefield',
                    format: 'Y-m-d'
                    format: 'Y-m-d',
                    onChange: function(value) {
                        if(Ext.String.hasHtmlCharacters(value)) {
                            this.reset();
                        }
                    },
                },
                renderer:
                    function(d) {",,
https://huntr.dev/bounties/de603972-935a-401a-96fb-17ddadd282b2/,SVG Sanitization Bypass - XSS in imgproxy/imgproxy,"In imgproxy application, we bypassed the svg sanitization function. In this way, attacker can craft malicious svg file and run javascript on the application.",CVE-2023-1496,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/imgproxy/imgproxy/commit/62f8d08a93d301285dcd1dabcc7ba10c6c65b689,"@@ -8,6 +8,7 @@

### Change
- Make the `expires` processing option set `Expires` and `Cache-Control` headers.


## [3.13.2] - 2023-02-15
### Change

@@ -35,6 +35,8 @@ func Satitize(data *imagedata.ImageData) (*imagedata.ImageData, error) {

 ignoreTag := 0



 for {
  tt, tdata := l.Next()

@@ -67,15 +69,28 @@ func Satitize(data *imagedata.ImageData) (*imagedata.ImageData, error) {

   return &newData, nil
  case xml.StartTagToken:
   if strings.ToLower(string(l.Text())) == ""script"" {


    ignoreTag++
    continue
   }

   buf.Write(tdata)
  case xml.AttributeToken:
   if _, unsafe := unsafeAttrs[strings.ToLower(string(l.Text()))]; unsafe {


    continue
   }








   buf.Write(tdata)
  default:
   buf.Write(tdata)

","1
CHANGELOG.md
@@ -8,6 +8,7 @@

### Change
- Make the `expires` processing option set `Expires` and `Cache-Control` headers.
- Sanitize `use` tags in SVGs.

## [3.13.2] - 2023-02-15
### Change
19
svg/svg.go
@@ -35,6 +35,8 @@ func Satitize(data *imagedata.ImageData) (*imagedata.ImageData, error) {

 ignoreTag := 0

 var curTagName string

 for {
  tt, tdata := l.Next()

@@ -67,15 +69,28 @@ func Satitize(data *imagedata.ImageData) (*imagedata.ImageData, error) {

   return &newData, nil
  case xml.StartTagToken:
   if strings.ToLower(string(l.Text())) == ""script"" {
   curTagName = strings.ToLower(string(l.Text()))

   if curTagName == ""script"" {
    ignoreTag++
    continue
   }

   buf.Write(tdata)
  case xml.AttributeToken:
   if _, unsafe := unsafeAttrs[strings.ToLower(string(l.Text()))]; unsafe {
   attrName := strings.ToLower(string(l.Text()))

   if _, unsafe := unsafeAttrs[attrName]; unsafe {
    continue
   }

   if curTagName == ""use"" && (attrName == ""href"" || attrName == ""xlink:href"") {
    val := strings.TrimSpace(strings.Trim(string(l.AttrVal()), `""'`))
    if len(val) > 0 && val[0] != '#' {
     continue
    }
   }

   buf.Write(tdata)
  default:
   buf.Write(tdata)",,
https://huntr.dev/bounties/b2c2743b-9d2c-4549-bfdd-782d13e86967/,Phar Deserialization of Untrusted Data in knplabs/snappy,"snappy is vulnerable to PHAR deserialization due to a lack of checking on the protocol before passing it into the file_exists() function. If an attacker can upload files of any type to the server he can pass in the phar:// protocol to unserialize the uploaded file and instantiate arbitrary PHP objects. This can lead to remote code execution especially when snappy is used with frameworks with documented POP chains like Laravel/Symfony vulnerable developer code. If user can control the output file from the generateFromHtml() function, it will invoke deserialization.",,CWE-502: Deserialization of Untrusted Data,https://www.github.com/knplabs/snappy/commit/b66f79334421c26d9c244427963fa2d92980b5d3,"@@ -625,6 +625,10 @@ protected function executeCommand($command)
     */
    protected function prepareOutput($filename, $overwrite)
    {




        $directory = \dirname($filename);

        if ($this->fileExists($filename)) {

@@ -938,6 +938,30 @@ protected function configure(): void
        );
    }

























    /**
     * @return null|string
     */

","4
src/Knp/Snappy/AbstractGenerator.php
@@ -625,6 +625,10 @@ protected function executeCommand($command)
     */
    protected function prepareOutput($filename, $overwrite)
    {
        if (\strpos($filename, 'phar://') === 0) {
            throw new InvalidArgumentException('The output file cannot be a phar archive.');
        }

        $directory = \dirname($filename);

        if ($this->fileExists($filename)) {
24
tests/Knp/Snappy/AbstractGeneratorTest.php
@@ -938,6 +938,30 @@ protected function configure(): void
        );
    }

    public function testFailingGenerateWithOutputContainingPharPrefix(): void
    {
        $media = $this->getMockBuilder(AbstractGenerator::class)
            ->setMethods([
                'configure',
                'prepareOutput',
            ])
            ->setConstructorArgs(['the_binary', [], ['PATH' => '/usr/bin']])
            ->getMock()
        ;

        $media->setTimeout(2000);

        $media
            ->expects($this->once())
            ->method('prepareOutput')
            ->with($this->equalTo('phar://the_output_file'))
        ;

        $this->expectException(InvalidArgumentException::class);

        $media->generate('the_input_file', 'phar://the_output_file', ['foo' => 'bar']);
    }

    /**
     * @return null|string
     */",,
https://huntr.dev/bounties/f6683c3b-a0f2-4615-b639-1920c8ae12e6/,IDOR Vulnerability Allow Low-Level User Logout Everyone Includes Admin in nilsteampassnet/teampass,IDOR vulnerability allow low level user to log out everyone in the system by changing the user ID.,CVE-2023-1463,CWE-285: Improper Authorization,https://www.github.com/nilsteampassnet/teampass/commit/4e06fbaf2b78c3615d0599855a72ba7e31157516,"@@ -103,7 +103,7 @@
                <h3><i class=""fa fa-warning text-danger""></i> Oops! <?php echo $errorCode; ?>.</h3>

                <p>
                    For security reason, you have been disconnected. Click to <a href=""./includes/core/logout.php?user_id="" + <?php echo isset($_SESSION['user_id']) === true ? $_SESSION['user_id'] : ''; ?>>log in</a>.
                </p>

            </div>

@@ -482,7 +482,7 @@ function(data) {
                document.location.href = ""index.php?page=profile"";
            } else if ($(this).data('name') === 'logout') {
                // Logout directly to login form
                window.location.href = ""./includes/core/logout.php?user_id="" + <?php echo $_SESSION['user_id']; ?>
            }
        }
    });
@@ -1674,7 +1674,7 @@ function(data) {
                        }
                    );

                    window.location.href = ""./includes/core/logout.php?user_id="" + <?php echo $_SESSION['user_id']; ?>
                } else if (store.get('teampassUser').admin_user_password) {
                    // now select if sending by email
                    $('#dialog-admin-change-user-password-info').html('<i class=""fas fa-envelope-open-text fa-lg warning mr-2""></i><?php echo langHdl('information'); ?><br><br>'+

@@ -38,10 +38,11 @@
// Update table by deleting ID
if (isset($_SESSION['user_id']) === true && empty($_SESSION['user_id']) === false) {
    $user_id = $_SESSION['user_id'];
} elseif (isset($get['user_id']) === true && empty($get['user_id']) === false) {
    $user_id = $get['user_id'];
} else {
    $user_id = '';

}

if (empty($user_id) === false && isset($_SESSION['CPM']) === true) {
@@ -65,8 +66,9 @@
            'timestamp' => '',
            'session_end' => '',
        ],
        'id=%i',
        $user_id

    );
    //Log into DB the user's disconnection
    if (isset($SETTINGS['log_connections']) === true

@@ -121,11 +121,3 @@ h5 {
.hidden {
  display: none;
}

.center-screen {
 position:absolute;
 top:50%;
 left: 50%;
 margin-right: -50%;
 transform: translate(-50%, -50%);
}
@@ -276,7 +276,36 @@ function getSettingValue($val)
                    <div class=""card-header"">
                        <h5>DataBase Informations</h5>
                    </div>
                    <div class=""card-body"">';






























    // check if all database  info are available
    if ($dbSettings === true) {

","2
error.php
@@ -103,7 +103,7 @@
                <h3><i class=""fa fa-warning text-danger""></i> Oops! <?php echo $errorCode; ?>.</h3>

                <p>
                    For security reason, you have been disconnected. Click to <a href=""./includes/core/logout.php?user_id="" + <?php echo isset($_SESSION['user_id']) === true ? $_SESSION['user_id'] : ''; ?>>log in</a>.
                    For security reason, you have been disconnected. Click to <a href=""./includes/core/logout.php?token="" + <?php echo isset($_SESSION['key']) === true ? $_SESSION['key'] : ''; ?>>log in</a>.
                </p>

            </div>
4
includes/core/load.js.php
@@ -482,7 +482,7 @@ function(data) {
                document.location.href = ""index.php?page=profile"";
            } else if ($(this).data('name') === 'logout') {
                // Logout directly to login form
                window.location.href = ""./includes/core/logout.php?user_id="" + <?php echo $_SESSION['user_id']; ?>
                window.location.href = ""./includes/core/logout.php?token=<?php echo $_SESSION['key']; ?>"";
            }
        }
    });
@@ -1674,7 +1674,7 @@ function(data) {
                        }
                    );

                    window.location.href = ""./includes/core/logout.php?user_id="" + <?php echo $_SESSION['user_id']; ?>
                    window.location.href = ""./includes/core/logout.php?token="" + <?php echo $_SESSION['key']; ?>
                } else if (store.get('teampassUser').admin_user_password) {
                    // now select if sending by email
                    $('#dialog-admin-change-user-password-info').html('<i class=""fas fa-envelope-open-text fa-lg warning mr-2""></i><?php echo langHdl('information'); ?><br><br>'+
10
includes/core/logout.php
@@ -38,10 +38,11 @@
// Update table by deleting ID
if (isset($_SESSION['user_id']) === true && empty($_SESSION['user_id']) === false) {
    $user_id = $_SESSION['user_id'];
} elseif (isset($get['user_id']) === true && empty($get['user_id']) === false) {
    $user_id = $get['user_id'];
} elseif (isset($get['token']) === true && empty($get['token']) === false) {
    $user_token = $get['token'];
} else {
    $user_id = '';
    $user_token = '';
}

if (empty($user_id) === false && isset($_SESSION['CPM']) === true) {
@@ -65,8 +66,9 @@
            'timestamp' => '',
            'session_end' => '',
        ],
        'id=%i',
        $user_id
        'id=%i || key_tempo=%s',
        $user_id,
        $user_token
    );
    //Log into DB the user's disconnection
    if (isset($SETTINGS['log_connections']) === true
8
install/css/install.css
@@ -121,11 +121,3 @@ h5 {
.hidden {
  display: none;
}

.center-screen {
 position:absolute;
 top:50%;
 left: 50%;
 margin-right: -50%;
 transform: translate(-50%, -50%);
}
31
install/upgrade.php
@@ -276,7 +276,36 @@ function getSettingValue($val)
                    <div class=""card-header"">
                        <h5>DataBase Informations</h5>
                    </div>
                    <div class=""card-body"">';
                    <div class=""card-body"">
                        <!--<div class=""form-group"">
                            <label>Host</label>
                            <input type=""text"" class=""form-control"" name=""db_host"" id=""db_host"" class=""ui-widget"" value=""'.DB_HOST.'"">
                        </div>
                                                 <div class=""form-group"">
                            <label>Database name</label>
                            <input type=""text"" class=""form-control"" name=""db_name"" id=""db_name"" class=""ui-widget"" value=""'.DB_NAME.'"">
                        </div>
                                                 <div class=""form-group"">
                            <label>Login</label>
                            <input type=""text"" class=""form-control"" name=""db_user"" id=""db_user"" class=""ui-widget"" value=""'.DB_USER.'"">
                        </div>
                                                 <div class=""form-group"">
                            <label>Password</label>
                            <input type=""text"" class=""form-control"" name=""db_pw"" id=""db_pw"" class=""ui-widget"" value=""'.$visible_pwd.'"">
                        </div>
                                                 <div class=""form-group"">
                            <label>Prefix</label>
                            <input type=""text"" class=""form-control"" name=""db_prefix"" id=""db_prefix"" class=""ui-widget"" value=""'.DB_PREFIX.'"">
                        </div>
                                                 <div class=""form-group"">
                            <label>Port</label>
                            <input type=""text"" class=""form-control"" name=""db_port"" id=""db_port"" class=""ui-widget"" value=""'.DB_PORT.'"">
                        </div>-->';

    // check if all database  info are available
    if ($dbSettings === true) {",,
https://huntr.dev/bounties/e0829fea-e458-47b8-84a3-a74476d9638f/,XSS in Document Types module in Settings in pimcore/pimcore,pimcore is vulnerable to XSS at Name field in Document Types module in Settings.,CVE-2023-1429,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/pimcore/pimcore/commit/7588c336edb24050656111b89d69e69cc9feb5f5,"@@ -228,8 +228,10 @@ pimcore.settings.document.doctypes = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('document_type'), data.data.name, function () {
                            grid.getStore().removeAt(rowIndex);


                        }.bind(this));
                    }.bind(this)
                }]

","6
bundles/AdminBundle/Resources/public/js/pimcore/settings/docTypes.js
@@ -228,8 +228,10 @@ pimcore.settings.document.doctypes = Class.create({
                    tooltip: t('delete'),
                    handler: function (grid, rowIndex) {
                        let data = grid.getStore().getAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('document_type'), data.data.name, function () {
                            grid.getStore().removeAt(rowIndex);
                        pimcore.helpers.deleteConfirm(t('document_type'),
                            Ext.util.Format.htmlEncode(data.data.name),
                            function () {
                                grid.getStore().removeAt(rowIndex);
                        }.bind(this));
                    }.bind(this)
                }]",,
https://huntr.dev/bounties/fa77d780-9b23-404b-8c44-12108881d11a/,Cross Site Scripting (XSS) in UrlSlug in pimcore/pimcore,Please enter a description of the vulnerability. Cross Site Scripting (XSS) in UrlSlug of pimcore/pimcore,,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/pimcore/pimcore/commit/c59d0bf1d03a5037b586fe06230694fa3818dbf2,"@@ -162,6 +162,11 @@ protected function addSettingsToDocument(Request $request, Model\Document $docum
        if ($request->get('settings')) {
            if ($document->isAllowed('settings')) {
                $settings = $this->decodeJson($request->get('settings'));





                $document->setValues($settings);
            }
        }

@@ -224,7 +224,7 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac
                                            method: ""POST"",
                                            params: {
                                                id: this.document.id,
                                                path: el.getValue()
                                            },
                                            success: function (res) {
                                                res = Ext.decode(res.responseText);
@@ -238,6 +238,10 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac
                                                }
                                            }
                                        });




                                    }.bind(this)
                                }
                            }

@@ -18,6 +18,10 @@ pimcore.helpers.sanitizeEmail = function (email) {
    return email.replace(/[^a-zA-Z0-9_\-@.+]/g,'');
};





pimcore.helpers.registerKeyBindings = function (bindEl, ExtJS) {

    if (!ExtJS) {

","5
bundles/AdminBundle/Controller/Admin/Document/DocumentControllerBase.php
@@ -162,6 +162,11 @@ protected function addSettingsToDocument(Request $request, Model\Document $docum
        if ($request->get('settings')) {
            if ($document->isAllowed('settings')) {
                $settings = $this->decodeJson($request->get('settings'));

                if(array_key_exists('prettyUrl' , $settings)){
                    $settings['prettyUrl'] = htmlspecialchars($settings['prettyUrl']);
                }

                $document->setValues($settings);
            }
        }
6
bundles/AdminBundle/Resources/public/js/pimcore/document/pages/settings.js
@@ -224,7 +224,7 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac
                                            method: ""POST"",
                                            params: {
                                                id: this.document.id,
                                                path: el.getValue()
                                                path: pimcore.helpers.sanitizeUrlSlug(el.getValue())
                                            },
                                            success: function (res) {
                                                res = Ext.decode(res.responseText);
@@ -238,6 +238,10 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac
                                                }
                                            }
                                        });
                                    }.bind(this),
                                    ""change"": function (el) {
                                        const sanitizedValue = pimcore.helpers.sanitizeUrlSlug(el.getValue());
                                        el.setValue(sanitizedValue);
                                    }.bind(this)
                                }
                            }
4
bundles/AdminBundle/Resources/public/js/pimcore/helpers.js
@@ -18,6 +18,10 @@ pimcore.helpers.sanitizeEmail = function (email) {
    return email.replace(/[^a-zA-Z0-9_\-@.+]/g,'');
};

pimcore.helpers.sanitizeUrlSlug = function (slug) {
    return slug.replace(/[^a-z0-9-_+/]/gi, '');
};

pimcore.helpers.registerKeyBindings = function (bindEl, ExtJS) {

    if (!ExtJS) {",,
https://huntr.dev/bounties/16bc74e2-1825-451f-bff7-bfdc1ea75cc2/,Stored HTML Injection via Company Name in alextselegidis/easyappointments,easyappointments present an html injection vulnerability on the company name field on "/index.php/backend/settings" page.,CVE-2023-1367,CWE-94: Code Injection,https://www.github.com/alextselegidis/easyappointments/commit/453c6e130229718680c91bef450db643a0f263e4,"@@ -43,6 +43,7 @@
                                        // Group services by category, only if there is at least one service
                                        // with a parent category.
                                        $has_category = FALSE;

                                        foreach ($available_services as $service)
                                        {
                                            if ( ! empty($service['category_id']))
@@ -72,6 +73,7 @@
                                            // We need the uncategorized services at the end of the list, so we will use
                                            // another iteration only for the uncategorized services.
                                            $grouped_services['uncategorized'] = [];

                                            foreach ($available_services as $service)
                                            {
                                                if ($service['category_id'] == NULL)
@@ -83,7 +85,7 @@
                                            foreach ($grouped_services as $key => $group)
                                            {
                                                $group_label = $key !== 'uncategorized'
                                                    ? $group[0]['category_name']
                                                    : 'Uncategorized';

                                                if (count($group) > 0)
@@ -93,7 +95,7 @@
                                                    foreach ($group as $service)
                                                    {
                                                        echo '<option value=""' . $service['id'] . '"">'
                                                            . $service['name'] . '</option>';
                                                    }

                                                    echo '</optgroup>';
@@ -105,7 +107,7 @@
                                            foreach ($available_services as $service)
                                            {
                                                echo '<option value=""' . $service['id'] . '"">'
                                                    . $service['name'] . '</option>';
                                            }
                                        }
                                        ?>
@@ -137,8 +139,8 @@
                                    </label>
                                    <select id=""appointment-status"" class=""form-control"">
                                        <?php foreach ($appointment_status_options as $appointment_status_option): ?>
                                            <option value=""<?= $appointment_status_option ?>"">
                                                <?= $appointment_status_option ?>
                                            </option>
                                        <?php endforeach ?>
                                    </select>

@@ -44,7 +44,7 @@

    <div class=""ms-lg-auto"">
        <strong id=""footer-user-display-name"">
            <?= lang('hello') . ', ' . $user_display_name ?>!
        </strong>
    </div>
</div>

@@ -10,7 +10,7 @@
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,""script"",""//www.google-analytics.com/analytics.js"",""ga"");
        ga(""create"", ""<?= $google_analytics_code ?>"", ""auto"");
        ga(""send"", ""pageview"");
    </script>
<?php endif ?>
@@ -21,7 +21,7 @@
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag(""js"", new Date());
        gtag(""config"", ""<?= $google_analytics_code ?>"");
    </script>
<?php endif ?>

@@ -13,7 +13,7 @@
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function () {
            var u = ""<?= $matomo_analytics_url ?>"";
            _paq.push(['setTrackerUrl', u + 'matomo.php']);
            _paq.push(['setSiteId', '1']);
            var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
@@ -24,7 +24,7 @@
    </script>

    <noscript>
        <p><img src=""<?= $matomo_analytics_url ?>matomo.php?idsite=1&amp;rec=1"" style=""border:0;"" alt=""""/></p>
    </noscript>

<?php endif ?>
@@ -16,7 +16,7 @@
<div class=""email-container"" style=""width: 650px; border: 1px solid #eee;"">
    <div id=""header"" style=""background-color: #429a82; height: 45px; padding: 10px 15px;"">
        <strong id=""logo"" style=""color: white; font-size: 20px; margin-top: 10px; display: inline-block"">
            <?= $settings['company_name'] ?>
        </strong>
    </div>

@@ -37,7 +37,7 @@
        </a>
        |
        <a href=""<?= $settings['company_link'] ?>"" style=""text-decoration: none;"">
            <?= $settings['company_name'] ?>
        </a>
    </div>
</div>

@@ -21,7 +21,7 @@
<div class=""email-container"" style=""width: 650px; border: 1px solid #eee;"">
    <div id=""header"" style=""background-color: #429a82; height: 45px; padding: 10px 15px;"">
        <strong id=""logo"" style=""color: white; font-size: 20px; margin-top: 10px; display: inline-block"">
            <?= $settings['company_name'] ?>
        </strong>
    </div>

@@ -44,15 +44,15 @@
                    <?= lang('service') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $service['name'] ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('provider') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $provider['first_name'] . ' ' . $provider['last_name'] ?>
                </td>
            </tr>
            <tr>
@@ -87,7 +87,7 @@
                        <?= lang('location') ?>
                    </td>
                    <td style=""padding: 3px;"">
                        <?= $appointment['location'] ?>
                    </td>
                </tr>
            <?php endif ?>
@@ -98,7 +98,7 @@
                        <?= lang('notes') ?>
                    </td>
                    <td style=""padding: 3px;"">
                        <?= $appointment['notes'] ?>
                    </td>
                </tr>
            <?php endif ?>
@@ -114,31 +114,31 @@
                    <?= lang('name') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['first_name'] . ' ' . $customer['last_name'] ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('email') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['email'] ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('phone_number') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['phone_number'] ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('address') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['address'] ?>
                </td>
            </tr>
        </table>
@@ -148,7 +148,7 @@
        </h2>

        <p>
            <?= $reason ?>
        </p>
    </div>

@@ -159,8 +159,8 @@
            Easy!Appointments
        </a>
        |
        <a href=""<?= $settings['company_link'] ?>"" style=""text-decoration: none;"">
            <?= $settings['company_name'] ?>
        </a>
    </div>
</div>

@@ -25,7 +25,7 @@
<div class=""email-container"" style=""width: 650px; border: 1px solid #eee;"">
    <div id=""header"" style=""background-color: #429a82; height: 45px; padding: 10px 15px;"">
        <strong id=""logo"" style=""color: white; font-size: 20px; margin-top: 10px; display: inline-block"">
            <?= $settings['company_name'] ?>
        </strong>
    </div>

@@ -48,15 +48,15 @@
                    <?= lang('service') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $service['name'] ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('provider') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $provider['first_name'] . ' ' . $provider['last_name'] ?>
                </td>
            </tr>
            <tr>
@@ -91,7 +91,7 @@
                        <?= lang('location') ?>
                    </td>
                    <td style=""padding: 3px;"">
                        <?= $appointment['location'] ?>
                    </td>
                </tr>
            <?php endif ?>
@@ -102,7 +102,7 @@
                        <?= lang('notes') ?>
                    </td>
                    <td style=""padding: 3px;"">
                        <?= $appointment['notes'] ?>
                    </td>
                </tr>
            <?php endif ?>
@@ -118,31 +118,31 @@
                    <?= lang('name') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['first_name'] . ' ' . $customer['last_name'] ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('email') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['email'] ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('phone_number') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['phone_number'] ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('address') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['address'] ?>
                </td>
            </tr>
        </table>
@@ -151,8 +151,8 @@
            <?= lang('appointment_link_title') ?>
        </h2>

        <a href=""<?= $appointment_link ?>"" style=""width: 600px;"">
            <?= $appointment_link ?>
        </a>
    </div>

@@ -163,8 +163,8 @@
            Easy!Appointments
        </a>
        |
        <a href=""<?= $settings['company_link'] ?>"" style=""text-decoration: none;"">
            <?= $settings['company_name'] ?>
        </a>
    </div>
</div>

","12
application/views/components/appointments_modal.php
@@ -43,6 +43,7 @@
                                        // Group services by category, only if there is at least one service
                                        // with a parent category.
                                        $has_category = FALSE;

                                        foreach ($available_services as $service)
                                        {
                                            if ( ! empty($service['category_id']))
@@ -72,6 +73,7 @@
                                            // We need the uncategorized services at the end of the list, so we will use
                                            // another iteration only for the uncategorized services.
                                            $grouped_services['uncategorized'] = [];

                                            foreach ($available_services as $service)
                                            {
                                                if ($service['category_id'] == NULL)
@@ -83,7 +85,7 @@
                                            foreach ($grouped_services as $key => $group)
                                            {
                                                $group_label = $key !== 'uncategorized'
                                                    ? $group[0]['category_name']
                                                    ? e($group[0]['category_name'])
                                                    : 'Uncategorized';

                                                if (count($group) > 0)
@@ -93,7 +95,7 @@
                                                    foreach ($group as $service)
                                                    {
                                                        echo '<option value=""' . $service['id'] . '"">'
                                                            . $service['name'] . '</option>';
                                                            . e($service['name']) . '</option>';
                                                    }

                                                    echo '</optgroup>';
@@ -105,7 +107,7 @@
                                            foreach ($available_services as $service)
                                            {
                                                echo '<option value=""' . $service['id'] . '"">'
                                                    . $service['name'] . '</option>';
                                                    . e($service['name']) . '</option>';
                                            }
                                        }
                                        ?>
@@ -137,8 +139,8 @@
                                    </label>
                                    <select id=""appointment-status"" class=""form-control"">
                                        <?php foreach ($appointment_status_options as $appointment_status_option): ?>
                                            <option value=""<?= $appointment_status_option ?>"">
                                                <?= $appointment_status_option ?>
                                            <option value=""<?= e($appointment_status_option) ?>"">
                                                <?= e($appointment_status_option) ?>
                                            </option>
                                        <?php endforeach ?>
                                    </select>
2
application/views/components/backend_footer.php
@@ -44,7 +44,7 @@

    <div class=""ms-lg-auto"">
        <strong id=""footer-user-display-name"">
            <?= lang('hello') . ', ' . $user_display_name ?>!
            <?= lang('hello') . ', ' . e($user_display_name) ?>!
        </strong>
    </div>
</div>
4
application/views/components/google_analytics_script.php
@@ -10,7 +10,7 @@
            (i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
            m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
        })(window,document,""script"",""//www.google-analytics.com/analytics.js"",""ga"");
        ga(""create"", ""<?= $google_analytics_code ?>"", ""auto"");
        ga(""create"", ""<?= e($google_analytics_code) ?>"", ""auto"");
        ga(""send"", ""pageview"");
    </script>
<?php endif ?>
@@ -21,7 +21,7 @@
        window.dataLayer = window.dataLayer || [];
        function gtag(){dataLayer.push(arguments);}
        gtag(""js"", new Date());
        gtag(""config"", ""<?= $google_analytics_code ?>"");
        gtag(""config"", ""<?= e($google_analytics_code) ?>"");
    </script>
<?php endif ?>

4
application/views/components/matomo_analytics_script.php
@@ -13,7 +13,7 @@
        _paq.push(['trackPageView']);
        _paq.push(['enableLinkTracking']);
        (function () {
            var u = ""<?= $matomo_analytics_url ?>"";
            var u = ""<?= e($matomo_analytics_url) ?>"";
            _paq.push(['setTrackerUrl', u + 'matomo.php']);
            _paq.push(['setSiteId', '1']);
            var d = document, g = d.createElement('script'), s = d.getElementsByTagName('script')[0];
@@ -24,7 +24,7 @@
    </script>

    <noscript>
        <p><img src=""<?= $matomo_analytics_url ?>matomo.php?idsite=1&amp;rec=1"" style=""border:0;"" alt=""""/></p>
        <p><img src=""<?= e($matomo_analytics_url) ?>matomo.php?idsite=1&amp;rec=1"" style=""border:0;"" alt=""""/></p>
    </noscript>

<?php endif ?>
4
application/views/emails/account_recovery_email.php
@@ -16,7 +16,7 @@
<div class=""email-container"" style=""width: 650px; border: 1px solid #eee;"">
    <div id=""header"" style=""background-color: #429a82; height: 45px; padding: 10px 15px;"">
        <strong id=""logo"" style=""color: white; font-size: 20px; margin-top: 10px; display: inline-block"">
            <?= $settings['company_name'] ?>
            <?= e($settings['company_name']) ?>
        </strong>
    </div>

@@ -37,7 +37,7 @@
        </a>
        |
        <a href=""<?= $settings['company_link'] ?>"" style=""text-decoration: none;"">
            <?= $settings['company_name'] ?>
            <?= e($settings['company_name']) ?>
        </a>
    </div>
</div>
24
application/views/emails/appointment_deleted_email.php
@@ -21,7 +21,7 @@
<div class=""email-container"" style=""width: 650px; border: 1px solid #eee;"">
    <div id=""header"" style=""background-color: #429a82; height: 45px; padding: 10px 15px;"">
        <strong id=""logo"" style=""color: white; font-size: 20px; margin-top: 10px; display: inline-block"">
            <?= $settings['company_name'] ?>
            <?= e($settings['company_name']) ?>
        </strong>
    </div>

@@ -44,15 +44,15 @@
                    <?= lang('service') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $service['name'] ?>
                    <?= e($service['name']) ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('provider') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $provider['first_name'] . ' ' . $provider['last_name'] ?>
                    <?= e($provider['first_name'] . ' ' . $provider['last_name']) ?>
                </td>
            </tr>
            <tr>
@@ -87,7 +87,7 @@
                        <?= lang('location') ?>
                    </td>
                    <td style=""padding: 3px;"">
                        <?= $appointment['location'] ?>
                        <?= e($appointment['location']) ?>
                    </td>
                </tr>
            <?php endif ?>
@@ -98,7 +98,7 @@
                        <?= lang('notes') ?>
                    </td>
                    <td style=""padding: 3px;"">
                        <?= $appointment['notes'] ?>
                        <?= e($appointment['notes']) ?>
                    </td>
                </tr>
            <?php endif ?>
@@ -114,31 +114,31 @@
                    <?= lang('name') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['first_name'] . ' ' . $customer['last_name'] ?>
                    <?= e($customer['first_name'] . ' ' . $customer['last_name']) ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('email') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['email'] ?>
                    <?= e($customer['email']) ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('phone_number') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['phone_number'] ?>
                    <?= e($customer['phone_number']) ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('address') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['address'] ?>
                    <?= e($customer['address']) ?>
                </td>
            </tr>
        </table>
@@ -148,7 +148,7 @@
        </h2>

        <p>
            <?= $reason ?>
            <?= e($reason) ?>
        </p>
    </div>

@@ -159,8 +159,8 @@
            Easy!Appointments
        </a>
        |
        <a href=""<?= $settings['company_link'] ?>"" style=""text-decoration: none;"">
            <?= $settings['company_name'] ?>
        <a href=""<?= e($settings['company_link']) ?>"" style=""text-decoration: none;"">
            <?= e($settings['company_name']) ?>
        </a>
    </div>
</div>
26
application/views/emails/appointment_saved_email.php
@@ -25,7 +25,7 @@
<div class=""email-container"" style=""width: 650px; border: 1px solid #eee;"">
    <div id=""header"" style=""background-color: #429a82; height: 45px; padding: 10px 15px;"">
        <strong id=""logo"" style=""color: white; font-size: 20px; margin-top: 10px; display: inline-block"">
            <?= $settings['company_name'] ?>
            <?= e($settings['company_name']) ?>
        </strong>
    </div>

@@ -48,15 +48,15 @@
                    <?= lang('service') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $service['name'] ?>
                    <?= e($service['name']) ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('provider') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $provider['first_name'] . ' ' . $provider['last_name'] ?>
                    <?= e($provider['first_name'] . ' ' . $provider['last_name']) ?>
                </td>
            </tr>
            <tr>
@@ -91,7 +91,7 @@
                        <?= lang('location') ?>
                    </td>
                    <td style=""padding: 3px;"">
                        <?= $appointment['location'] ?>
                        <?= e($appointment['location']) ?>
                    </td>
                </tr>
            <?php endif ?>
@@ -102,7 +102,7 @@
                        <?= lang('notes') ?>
                    </td>
                    <td style=""padding: 3px;"">
                        <?= $appointment['notes'] ?>
                        <?= e($appointment['notes']) ?>
                    </td>
                </tr>
            <?php endif ?>
@@ -118,31 +118,31 @@
                    <?= lang('name') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['first_name'] . ' ' . $customer['last_name'] ?>
                    <?= e($customer['first_name'] . ' ' . $customer['last_name']) ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('email') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['email'] ?>
                    <?= e($customer['email']) ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('phone_number') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['phone_number'] ?>
                    <?= e($customer['phone_number']) ?>
                </td>
            </tr>
            <tr>
                <td class=""label"" style=""padding: 3px;font-weight: bold;"">
                    <?= lang('address') ?>
                </td>
                <td style=""padding: 3px;"">
                    <?= $customer['address'] ?>
                    <?= e($customer['address']) ?>
                </td>
            </tr>
        </table>
@@ -151,8 +151,8 @@
            <?= lang('appointment_link_title') ?>
        </h2>

        <a href=""<?= $appointment_link ?>"" style=""width: 600px;"">
            <?= $appointment_link ?>
        <a href=""<?= e($appointment_link) ?>"" style=""width: 600px;"">
            <?= e($appointment_link) ?>
        </a>
    </div>

@@ -163,8 +163,8 @@
            Easy!Appointments
        </a>
        |
        <a href=""<?= $settings['company_link'] ?>"" style=""text-decoration: none;"">
            <?= $settings['company_name'] ?>
        <a href=""<?= e($settings['company_link']) ?>"" style=""text-decoration: none;"">
            <?= e($settings['company_name']) ?>
        </a>
    </div>
</div>",,
https://huntr.dev/bounties/4d0a9615-d438-4f5c-8dd6-aa22f4b716d9/,null pointer dereference in class_object_index at vim9class.c:1356 in vim/vim,null pointer dereference in class_object_index at vim9class.c:1356,CVE-2023-1355,CWE-476: NULL Pointer Dereference,https://www.github.com/vim/vim/commit/d13dd30240e32071210f55b587182ff48757ea46,"@@ -203,6 +203,13 @@ def Test_returning_null_object()
  v9.CheckScriptSuccess(lines)
enddef








def Test_class_interface_wrong_end()
  var lines =<< trim END
      vim9script

@@ -695,6 +695,8 @@ static char *(features[]) =

static int included_patches[] =
{   /* Add new patch number below this line */


/**/
    1401,
/**/

@@ -1262,6 +1262,12 @@ class_object_index(
 cl = rettv->vval.v_object->obj_class;
    }







    if (*name_end == '(')
    {
 int on_class = rettv->v_type == VAR_CLASS;

","7
src/testdir/test_vim9_class.vim
@@ -203,6 +203,13 @@ def Test_returning_null_object()
  v9.CheckScriptSuccess(lines)
enddef

def Test_using_null_class()
  var lines =<< trim END
      @_ = null_class.member
  END
  v9.CheckDefExecAndScriptFailure(lines, ['E715:', 'E1363:'])
enddef

def Test_class_interface_wrong_end()
  var lines =<< trim END
      vim9script
2
src/version.c
@@ -695,6 +695,8 @@ static char *(features[]) =

static int included_patches[] =
{   /* Add new patch number below this line */
/**/
    1402,
/**/
    1401,
/**/
6
src/vim9class.c
@@ -1262,6 +1262,12 @@ class_object_index(
 cl = rettv->vval.v_object->obj_class;
    }

    if (cl == NULL)
    {
 emsg(_(e_incomplete_type));
 return FAIL;
    }

    if (*name_end == '(')
    {
 int on_class = rettv->v_type == VAR_CLASS;",,
https://huntr.dev/bounties/c2bb34ac-452d-4624-a1b9-c5b54f52f0cd/,Cross-site Scripting (XSS) - Stored in osticket/osticket,"As it is written on github profile, osTicket is a widely-used open source support ticket system. During source code research I discovered bad uploaded file type check, which is controlled by user. Unauthenticated user can upload malicious html/js file.",CVE-2023-1320,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/osticket/osticket/commit/86f9693dc64ed54220ed6c10e13e824ca4f6aacf,"@@ -54,6 +54,15 @@ function exif_imagetype ($filename) {
            }
        }










        if (!isset($_SERVER['REMOTE_ADDR']))
            $_SERVER['REMOTE_ADDR'] = '';
    }

@@ -53,78 +53,72 @@ static function _updateDraft($draft) {
    static function _uploadInlineImage($draft) {
        global $cfg;

        if (!isset($_POST['data']) && !isset($_FILES['file']))
            Http::response(422, ""File not included properly"");

        # Fixup for expected multiple attachments
        if (isset($_FILES['file'])) {
            $file = AttachmentFile::format($_FILES['file']);

            # Allow for data-uri uploaded files
            $fp = fopen($file[0]['tmp_name'], 'rb');
            if (fread($fp, 5) == 'data:') {
                $data = 'data:';
                while ($block = fread($fp, 8192))
                  $data .= $block;
                $file[0] = Format::parseRfc2397($data);
                list(,$ext) = explode('/', $file[0]['type'], 2);
                $file[0] += array(
                    'name' => Misc::randCode(8).'.'.$ext,
                    'size' => strlen($file[0]['data']),
                );
            }
            fclose($fp);









            # TODO: Detect unacceptable attachment extension
            # TODO: Verify content-type and check file-content to ensure image
            $type = $file[0]['type'];
            if (strpos($file[0]['type'], 'image/') !== 0)
                return Http::response(403,
                    JsonDataEncoder::encode(array(
                        'error' => 'File type is not allowed',
                    ))
                );

            # TODO: Verify file size is acceptable
            if ($file[0]['size'] > $cfg->getMaxFileSize())














                return Http::response(403,
                    JsonDataEncoder::encode(array(
                        'error' => 'File is too large',
                    ))
                );

            // Paste uploads in Chrome will have a name of 'blob'
            if ($file[0]['name'] == 'blob')
                $file[0]['name'] = 'screenshot-'.Misc::randCode(4);

            $ids = $draft->attachments->upload($file);

            if (!$ids) {
                if ($file[0]['error']) {
                    return Http::response(403,
                        JsonDataEncoder::encode(array(
                            'error' => $file[0]['error'],
                        ))
                    );
                }
                else
                    return Http::response(500, 'Unable to attach image');
            }

            $id = (is_array($ids)) ? $ids[0] : $ids;
        }
        else {
            $type = explode('/', $_POST['contentType']);
            $info = array(
                'data' => base64_decode($_POST['data']),
                'name' => Misc::randCode(10).'.'.$type[1],
                // TODO: Ensure _POST['contentType']
                'type' => $_POST['contentType'],
            );
            // TODO: Detect unacceptable filetype
            // TODO: Verify content-type and check file-content to ensure image
            $id = $draft->attachments->save($info);
        }


        if (!($f = AttachmentFile::lookup($id)))
            return Http::response(500, 'Unable to attach image');


@@ -1054,12 +1054,8 @@ function setMimeType($type) {
    }

    function getMimeType() {
        if (!isset($this->_mimetype)) {
            // Try to to auto-detect mime type
            $finfo = new finfo(FILEINFO_MIME);
            $this->_mimetype = $finfo->buffer($this->getContents(),
                    FILEINFO_MIME_TYPE);
        }

        return $this->_mimetype;
    }
@@ -1075,6 +1071,21 @@ function getContents() {
    function getData() {
        return $this->getContents();
    }















}

?>
@@ -3911,6 +3911,10 @@ function uploadAttachment(&$file) {
    }

    static function isValidFile($file) {





        // Check invalid image hacks
        if ($file['tmp_name']

","9
bootstrap.php
@@ -54,6 +54,15 @@ function exif_imagetype ($filename) {
            }
        }

        if (!function_exists('exif_imagetype')) {
            function exif_imagetype ($filename) {
                if ((list($width,$height,$type,) = getimagesize($filename)) !== false)
                    return $type;

                return false;
            }
        }

        if (!isset($_SERVER['REMOTE_ADDR']))
            $_SERVER['REMOTE_ADDR'] = '';
    }
114
include/ajax.draft.php
@@ -53,78 +53,72 @@ static function _updateDraft($draft) {
    static function _uploadInlineImage($draft) {
        global $cfg;

        if (!isset($_POST['data']) && !isset($_FILES['file']))
        if (!isset($_FILES['file']))
            Http::response(422, ""File not included properly"");

        # Fixup for expected multiple attachments
        if (isset($_FILES['file'])) {
            $file = AttachmentFile::format($_FILES['file']);

            # Allow for data-uri uploaded files
            $fp = fopen($file[0]['tmp_name'], 'rb');
            if (fread($fp, 5) == 'data:') {
                $data = 'data:';
                while ($block = fread($fp, 8192))
                  $data .= $block;
                $file[0] = Format::parseRfc2397($data);
                list(,$ext) = explode('/', $file[0]['type'], 2);
                $file[0] += array(
                    'name' => Misc::randCode(8).'.'.$ext,
                    'size' => strlen($file[0]['data']),
                );
            }
            fclose($fp);
        $file = AttachmentFile::format($_FILES['file']);

        # Allow for data-uri uploaded files
        $fp = fopen($file[0]['tmp_name'], 'rb');
        if (fread($fp, 5) == 'data:') {
            $data = 'data:';
            while ($block = fread($fp, 8192))
              $data .= $block;
            $file[0] = Format::parseRfc2397($data);
            list(,$ext) = explode('/', $file[0]['type'], 2);
            $file[0] += array(
                'name' => Misc::randCode(8).'.'.$ext,
                'size' => strlen($file[0]['data']),
            );
        }
        fclose($fp);

        // Check file type to ensure image
        $type = $file[0]['type'];
        if (strpos($file[0]['type'], 'image/') !== 0)
            return Http::response(403,
                JsonDataEncoder::encode(array(
                    'error' => 'File type is not allowed',
                ))
            );

            # TODO: Detect unacceptable attachment extension
            # TODO: Verify content-type and check file-content to ensure image
            $type = $file[0]['type'];
            if (strpos($file[0]['type'], 'image/') !== 0)
                return Http::response(403,
                    JsonDataEncoder::encode(array(
                        'error' => 'File type is not allowed',
                    ))
                );
        // Check if file is truly an image
        if (!FileUploadField::isValidFile($file[0]))
            return Http::response(403,
                JsonDataEncoder::encode(array(
                    'error' => 'File is not valid',
                ))
            );

            # TODO: Verify file size is acceptable
            if ($file[0]['size'] > $cfg->getMaxFileSize())
        // Verify file size is acceptable
        if ($file[0]['size'] > $cfg->getMaxFileSize())
            return Http::response(403,
                JsonDataEncoder::encode(array(
                    'error' => 'File is too large',
                ))
            );

        // Paste uploads in Chrome will have a name of 'blob'
        if ($file[0]['name'] == 'blob')
            $file[0]['name'] = 'screenshot-'.Misc::randCode(4);

        $ids = $draft->attachments->upload($file);

        if (!$ids) {
            if ($file[0]['error']) {
                return Http::response(403,
                    JsonDataEncoder::encode(array(
                        'error' => 'File is too large',
                        'error' => $file[0]['error'],
                    ))
                );

            // Paste uploads in Chrome will have a name of 'blob'
            if ($file[0]['name'] == 'blob')
                $file[0]['name'] = 'screenshot-'.Misc::randCode(4);

            $ids = $draft->attachments->upload($file);

            if (!$ids) {
                if ($file[0]['error']) {
                    return Http::response(403,
                        JsonDataEncoder::encode(array(
                            'error' => $file[0]['error'],
                        ))
                    );
                }
                else
                    return Http::response(500, 'Unable to attach image');
            }

            $id = (is_array($ids)) ? $ids[0] : $ids;
        }
        else {
            $type = explode('/', $_POST['contentType']);
            $info = array(
                'data' => base64_decode($_POST['data']),
                'name' => Misc::randCode(10).'.'.$type[1],
                // TODO: Ensure _POST['contentType']
                'type' => $_POST['contentType'],
            );
            // TODO: Detect unacceptable filetype
            // TODO: Verify content-type and check file-content to ensure image
            $id = $draft->attachments->save($info);
            else
                return Http::response(500, 'Unable to attach image');
        }

        $id = (is_array($ids)) ? $ids[0] : $ids;
        if (!($f = AttachmentFile::lookup($id)))
            return Http::response(500, 'Unable to attach image');

23
include/class.file.php
@@ -1054,12 +1054,8 @@ function setMimeType($type) {
    }

    function getMimeType() {
        if (!isset($this->_mimetype)) {
            // Try to to auto-detect mime type
            $finfo = new finfo(FILEINFO_MIME);
            $this->_mimetype = $finfo->buffer($this->getContents(),
                    FILEINFO_MIME_TYPE);
        }
        if (!isset($this->_mimetype))
            $this->_mimetype = self::mime_type($this->getRealPath());

        return $this->_mimetype;
    }
@@ -1075,6 +1071,21 @@ function getContents() {
    function getData() {
        return $this->getContents();
    }

    /*
     * Given a filepath - auto detect the mime type
     *
     */
    static function mime_type($filepath) {
        // Try to to auto-detect mime type
        $type = null;
        if (function_exists('finfo_open')) {
            $finfo = finfo_open(FILEINFO_MIME_TYPE);
            $type = finfo_file($finfo, $filepath);
            finfo_close($finfo);
        }
        return $type ?: mime_content_type($filepath);
    }
}

?>
4
include/class.forms.php
@@ -3911,6 +3911,10 @@ function uploadAttachment(&$file) {
    }

    static function isValidFile($file) {
        // Make sure mime type is valid
        if (strcasecmp(FileObject::mime_type($file['tmp_name']),
                    $file['type']) !== 0)
            return false;

        // Check invalid image hacks
        if ($file['tmp_name']",,
https://huntr.dev/bounties/a822067a-d90d-4c3e-b9ef-9b2a5c2bc97f/,Stored XSS in Roles in osticket/osticket,"Stored cross-site scripting vulnerabilities arise when user input is stored and later embedded into the application's responses in an unsafe way. An attacker can use the vulnerability to inject malicious JavaScript code into the application, which will execute within the browser of any user who views the relevant application content.",CVE-2023-1319,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/osticket/osticket/commit/9fb01bc12fbae06aa2c2b4d1bc9b4a08db4bb3e0,"@@ -156,9 +156,10 @@ private function updatePerms($vars, &$errors=array()) {
    }

    function update($vars, &$errors) {
        if (!$vars['name'])

            $errors['name'] = __('Name required');
        elseif (($r=Role::lookup(array('name'=>$vars['name'])))
                && $r->getId() != $vars['id'])
            $errors['name'] = __('Name already in use');
        elseif (!$vars['perms'] || !count($vars['perms']))
@@ -167,8 +168,8 @@ function update($vars, &$errors) {
        if ($errors)
            return false;

        $this->name = $vars['name'];
        $this->notes = $vars['notes'];

        $this->updatePerms($vars['perms'], $errors);


","9
include/class.role.php
@@ -156,9 +156,10 @@ private function updatePerms($vars, &$errors=array()) {
    }

    function update($vars, &$errors) {
        if (!$vars['name'])
        $name = Format::sanitize($vars['name']);
        if (!$name)
            $errors['name'] = __('Name required');
        elseif (($r=Role::lookup(array('name'=>$vars['name'])))
        elseif (($r=Role::lookup(array('name'=>$name)))
                && $r->getId() != $vars['id'])
            $errors['name'] = __('Name already in use');
        elseif (!$vars['perms'] || !count($vars['perms']))
@@ -167,8 +168,8 @@ function update($vars, &$errors) {
        if ($errors)
            return false;

        $this->name = $vars['name'];
        $this->notes = $vars['notes'];
        $this->name = $name;
        $this->notes = Format::sanitize($vars['notes']);

        $this->updatePerms($vars['perms'], $errors);",,
https://huntr.dev/bounties/e58b38e0-4897-4bb0-84e8-a7ad8efab338/,Multiple XSS Vulnerabilities in Queue Condition in osticket/osticket,"Cross-Site Scripting (XSS) vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.",CVE-2023-1318,CWE-79: Cross-site Scripting (XSS) - Generic,https://www.github.com/osticket/osticket/commit/343a2b47e164dd9090a3c9477ef273f0efa16a7d,"@@ -366,10 +366,10 @@ function get_db_input($index, $vars, $quote=true) {

    static function get_path_info() {
        if(isset($_SERVER['PATH_INFO']))
            return $_SERVER['PATH_INFO'];

        if(isset($_SERVER['ORIG_PATH_INFO']))
            return $_SERVER['ORIG_PATH_INFO'];

        //TODO: conruct possible path info.


","4
include/class.osticket.php
@@ -366,10 +366,10 @@ function get_db_input($index, $vars, $quote=true) {

    static function get_path_info() {
        if(isset($_SERVER['PATH_INFO']))
            return $_SERVER['PATH_INFO'];
            return htmlentities($_SERVER['PATH_INFO']);

        if(isset($_SERVER['ORIG_PATH_INFO']))
            return $_SERVER['ORIG_PATH_INFO'];
            return htmlentities($_SERVER['ORIG_PATH_INFO']);

        //TODO: conruct possible path info.",,
https://huntr.dev/bounties/c3e27af2-358b-490b-9baf-e451663e4e5f/,Reflected XSS in Organizations Search in osticket/osticket,"Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.",CVE-2023-1317,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/osticket/osticket/commit/daee20fdd8ac926d9aee700b201ac2cb35d448ca,"@@ -30,7 +30,7 @@ function search($type = null) {
        if (!$_REQUEST['q'])
            return $this->json_encode(array());

        $q = $_REQUEST['q'];
        $limit = isset($_REQUEST['limit']) ? (int) $_REQUEST['limit']:25;

        if (strlen(Format::searchable($q)) < 3)
@@ -55,7 +55,7 @@ function search($type = null) {
        foreach ($orgs as $O) {
            list($id, $name) = $O;
            $matched[] = array('name' => Format::htmlchars($name), 'info' => $name,
                'id' => $id, '/bin/true' => $_REQUEST['q']);
        }

        return $this->json_encode(array_values($matched));

","4
include/ajax.orgs.php
@@ -30,7 +30,7 @@ function search($type = null) {
        if (!$_REQUEST['q'])
            return $this->json_encode(array());

        $q = $_REQUEST['q'];
        $q = Format::sanitize($_REQUEST['q']);
        $limit = isset($_REQUEST['limit']) ? (int) $_REQUEST['limit']:25;

        if (strlen(Format::searchable($q)) < 3)
@@ -55,7 +55,7 @@ function search($type = null) {
        foreach ($orgs as $O) {
            list($id, $name) = $O;
            $matched[] = array('name' => Format::htmlchars($name), 'info' => $name,
                'id' => $id, '/bin/true' => $_REQUEST['q']);
                'id' => $id, '/bin/true' => Format::htmlchars($q));
        }

        return $this->json_encode(array_values($matched));",,
https://huntr.dev/bounties/c6353bab-c382-47f6-937b-56d253f2e8d3/,XSS Stored in Email in osticket/osticket,"It was discovered that it is possible to inject a malicious payload into the email address field, resulting in a stored XSS vulnerability.",CVE-2023-1316,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/osticket/osticket/commit/091ddba965132d26bdbeb004fcc44bd8fd056b71,"@@ -408,12 +408,12 @@ function update($vars, &$errors=false) {

        $this->mail_errors = 0;
        $this->mail_lastfetch = null;
        $this->email = $vars['email'];
        $this->name = Format::striptags($vars['name']);
        $this->dept_id = $vars['dept_id'];
        $this->priority_id = $vars['priority_id'];
        $this->topic_id = $vars['topic_id'];
        $this->noautoresp = $vars['noautoresp'];
        $this->userid = $vars['userid'];
        $this->mail_active = $vars['mail_active'];
        $this->mail_host = $vars['mail_host'];

","10
include/class.email.php
@@ -408,12 +408,12 @@ function update($vars, &$errors=false) {

        $this->mail_errors = 0;
        $this->mail_lastfetch = null;
        $this->email = $vars['email'];
        $this->email = Format::sanitize($vars['email']);
        $this->name = Format::striptags($vars['name']);
        $this->dept_id = $vars['dept_id'];
        $this->priority_id = $vars['priority_id'];
        $this->topic_id = $vars['topic_id'];
        $this->noautoresp = $vars['noautoresp'];
        $this->dept_id = (int) $vars['dept_id'];
        $this->priority_id = (int) (isset($vars['priority_id']) ? $vars['priority_id'] : 0);
        $this->topic_id = (int) $vars['topic_id'];
        $this->noautoresp = (int) $vars['noautoresp'];
        $this->userid = $vars['userid'];
        $this->mail_active = $vars['mail_active'];
        $this->mail_host = $vars['mail_host'];",,
https://huntr.dev/bounties/70a7fd8c-7e6f-4a43-9f8c-163b8967b16e/,Reflected XSS in Advanced Ticket Search in osticket/osticket,"Reflected cross-site scripting vulnerabilities arise when data is copied from a request and echoed into the application's immediate response in an unsafe way. An attacker can use the vulnerability to construct a request that, if issued by another application user, will cause JavaScript code supplied by the attacker to execute within the user's browser in the context of that user's session with the application.",CVE-2023-1315,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/osticket/osticket/commit/ec6043935b4e30b5c0dfa544e256717182808a2e,"@@ -31,7 +31,7 @@ function getAdvancedSearchDialog($key=false, $context='advsearch') {
        $search = new AdhocSearch(array(
            'root' => 'T',
            'staff_id' => $thisstaff->getId(),
            'parent_id' => @$_GET['parent_id'] ?: 0,
        ));
        if ($search->parent_id) {
            $search->flags |= SavedSearch::FLAG_INHERIT_COLUMNS;
@@ -168,7 +168,7 @@ function createSearch() {
                    'title' => __('Add Queue'),
                    'root' => 'T',
                    'staff_id' => $thisstaff->getId(),
                    'parent_id' =>  $_GET['pid'],
                    ));
        $this->_tryAgain($search);
    }

@@ -1,9 +1,9 @@
<?php
global $thisstaff;

$parent_id = (isset($_REQUEST['parent_id']) && is_numeric($_REQUEST['parent_id']))
        ? $_REQUEST['parent_id']
        : $search->parent_id;
if ($parent_id
    && is_numeric($parent_id)
    && (!($parent = SavedQueue::lookup($parent_id)))

","4
include/ajax.search.php
@@ -31,7 +31,7 @@ function getAdvancedSearchDialog($key=false, $context='advsearch') {
        $search = new AdhocSearch(array(
            'root' => 'T',
            'staff_id' => $thisstaff->getId(),
            'parent_id' => @$_GET['parent_id'] ?: 0,
            'parent_id' => (int) @$_GET['parent_id'] ?: 0,
        ));
        if ($search->parent_id) {
            $search->flags |= SavedSearch::FLAG_INHERIT_COLUMNS;
@@ -168,7 +168,7 @@ function createSearch() {
                    'title' => __('Add Queue'),
                    'root' => 'T',
                    'staff_id' => $thisstaff->getId(),
                    'parent_id' =>  $_GET['pid'],
                    'parent_id' => (int) $_GET['pid'],
                    ));
        $this->_tryAgain($search);
    }
4
include/staff/templates/advanced-search.tmpl.php
@@ -1,9 +1,9 @@
<?php
global $thisstaff;

$parent_id = (isset($_REQUEST['parent_id']) && is_numeric($_REQUEST['parent_id']))
$parent_id = (int) ((isset($_REQUEST['parent_id']) && is_numeric($_REQUEST['parent_id']))
        ? $_REQUEST['parent_id']
        : $search->parent_id;
        : $search->parent_id);
if ($parent_id
    && is_numeric($parent_id)
    && (!($parent = SavedQueue::lookup($parent_id)))",,
https://huntr.dev/bounties/f73eef49-004f-4b3b-9717-90525e65ba61/,File Upload Bypass Leads to Remove Code Execution (RCE) in cockpit-hq/cockpit,There is no extension checks during file upload. Attacker may upload file to execute malicious code in the server.,CVE-2023-1313,CWE-434: Unrestricted Upload of File with Dangerous Type,https://www.github.com/cockpit-hq/cockpit/commit/becca806c7071ecc732521bb5ad0bb9c64299592,"@@ -1,5 +1,9 @@
# Release Notes





## 2.4.0 (2023-03-08)

- Add additional security check editing php files in finder

@@ -80,6 +80,11 @@
                $_isAllowed = $allowed === true ? true : preg_match(""/\.({$allowed})$/i"", $_file);
                $_sizeAllowed = $max_size ? filesize($files['tmp_name'][$i]) < $max_size : true;






                if (!$files['error'][$i] && $_isAllowed && $_sizeAllowed && move_uploaded_file($files['tmp_name'][$i], $_file)) {

                    $_files[]   = $_file;

","4
CHANGELOG.md
@@ -1,5 +1,9 @@
# Release Notes

## WIP

- Prevent uploading php files in assets manager

## 2.4.0 (2023-03-08)

- Add additional security check editing php files in finder
5
modules/Assets/bootstrap.php
@@ -80,6 +80,11 @@
                $_isAllowed = $allowed === true ? true : preg_match(""/\.({$allowed})$/i"", $_file);
                $_sizeAllowed = $max_size ? filesize($files['tmp_name'][$i]) < $max_size : true;

                // prevent uploading php files
                if ($_isAllowed && pathinfo($_file, PATHINFO_EXTENSION) === 'php') {
                    $_isAllowed = false;
                }

                if (!$files['error'][$i] && $_isAllowed && $_sizeAllowed && move_uploaded_file($files['tmp_name'][$i], $_file)) {

                    $_files[]   = $_file;",,
https://huntr.dev/bounties/2a64a32d-b1cc-4def-91da-18040d59f356/,Reflected XSS in Application Logger module in pimcore/pimcore,pimcore is vulnerable to Reflected XSS at From and To fields when searching in the Application Logger module.,CVE-2023-1312,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/pimcore/pimcore/commit/d35d0712858f24d0ec96ddfd4cbe82ff4b5a5fbb,"@@ -261,24 +261,28 @@ pimcore.log.admin = Class.create({
            this.fromDate = new Ext.form.DateField({
                name: 'from_date',
                width: 130,

                xtype: 'datefield'
            });

            this.fromTime = new Ext.form.TimeField({
                name: 'from_time',
                width: 100,

                xtype: 'timefield'
            });

            this.toDate = new Ext.form.DateField({
                name: 'to_date',
                width: 130,

                xtype: 'datefield'
            });

            this.toTime = new Ext.form.TimeField({
                name: 'to_time',
                width: 100,

                xtype: 'timefield'
            });


","4
bundles/AdminBundle/Resources/public/js/pimcore/log/admin.js
@@ -261,24 +261,28 @@ pimcore.log.admin = Class.create({
            this.fromDate = new Ext.form.DateField({
                name: 'from_date',
                width: 130,
                invalidText: 'Enter date as MM/DD/YYYY',
                xtype: 'datefield'
            });

            this.fromTime = new Ext.form.TimeField({
                name: 'from_time',
                width: 100,
                invalidText: 'Enter time as HH:MM AM/PM',
                xtype: 'timefield'
            });

            this.toDate = new Ext.form.DateField({
                name: 'to_date',
                width: 130,
                invalidText: 'Enter date as MM/DD/YYYY',
                xtype: 'datefield'
            });

            this.toTime = new Ext.form.TimeField({
                name: 'to_time',
                width: 100,
                invalidText: 'Enter time as HH:MM AM/PM',
                xtype: 'timefield'
            });",,
https://huntr.dev/bounties/5fe85af4-a667-41a9-a00d-f99e07c5e2f1/,Authentication Bypass for users with MD5 password hash in froxlor/froxlor,OS: Ubuntu 22.04.2 LTS,CVE-2023-1307,CWE-305: Authentication Bypass by Primary Weakness,https://www.github.com/froxlor/froxlor/commit/6777fbf229200f4fd566022e186548391219ab23,"@@ -198,7 +198,7 @@ public static function validatePasswordLogin(
   $update_hash = true;
  }

  if ($pwd_hash == $pwd_check || password_verify($password, $pwd_hash)) {
   // check for update of hash (only if our database is ready to handle the bigger string)
   $is_ready = Froxlor::versionCompare2(""0.9.33"", Froxlor::getVersion()) <= 0;
   if ((password_needs_rehash($pwd_hash, $algo) || $update_hash) && $is_ready) {

","2
lib/Froxlor/System/Crypt.php
@@ -198,7 +198,7 @@ public static function validatePasswordLogin(
   $update_hash = true;
  }

  if ($pwd_hash == $pwd_check || password_verify($password, $pwd_hash)) {
  if ($pwd_hash === $pwd_check || password_verify($password, $pwd_hash)) {
   // check for update of hash (only if our database is ready to handle the bigger string)
   $is_ready = Froxlor::versionCompare2(""0.9.33"", Froxlor::getVersion()) <= 0;
   if ((password_needs_rehash($pwd_hash, $algo) || $update_hash) && $is_ready) {",,
https://huntr.dev/bounties/31d97442-3f87-439f-83f0-1c7862ef0c7c/,Stored xss in print generate and preview pdf in pimcore/pimcore,In pimcore dev url https://11.x-dev.pimcore.fun/admin/ I found one stored xss in generate and preview pdf . The author field and title field is vulnerable to xss,CVE-2023-1286,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/pimcore/pimcore/commit/82cca7f4a7560b160336cce2610481098ca52c18,"@@ -264,15 +264,15 @@ pimcore.document.printpages.pdfpreview = Class.create({
        var data = record.data;
        var type = data.type;

        if (type == ""bool"") {
            if (value) {
                return '<div style=""text-align: left""><div role=""button"" class=""x-grid-checkcolumn x-grid-checkcolumn-checked"" style=""""></div></div>';
            } else {
                return '<div style=""text-align: left""><div role=""button"" class=""x-grid-checkcolumn"" style=""""></div></div>';
            }
        }

        if (type == ""select"") {
            return t(""web2print_"" + value, value);
        }


","14
bundles/AdminBundle/Resources/public/js/pimcore/document/printpages/pdf_preview.js
@@ -264,15 +264,15 @@ pimcore.document.printpages.pdfpreview = Class.create({
        var data = record.data;
        var type = data.type;

        if (type == ""bool"") {
            if (value) {
                return '<div style=""text-align: left""><div role=""button"" class=""x-grid-checkcolumn x-grid-checkcolumn-checked"" style=""""></div></div>';
            } else {
                return '<div style=""text-align: left""><div role=""button"" class=""x-grid-checkcolumn"" style=""""></div></div>';
            }
        if (type === ""text"") {
            return Ext.util.Format.htmlEncode(value);
        }

        if (type === ""bool"") {
            return '<div style=""text-align: left""><div role=""button"" class=""x-grid-checkcolumn' + (value ? ' x-grid-checkcolumn-checked' : '') + '"" style=""""></div></div>';
        }

        if (type == ""select"") {
        if (type === ""select"") {
            return t(""web2print_"" + value, value);
        }",,
https://huntr.dev/bounties/1c45084f-123c-45ca-9e82-bf24833d993b/,Multiple Authenticated Remote Code Execution Vulnerabilities in Admin Panel in openemr/openemr,An attacker with administrative privileges in the openEMR application can execute arbitrary code on the server (remote code execution (RCE)). This was tested in openEMR version 7.0.0 (1) but also affects previous versions of openEMR.,,CWE-77: Command Injection,https://www.github.com/openemr/openemr/commit/d10b1bf17b6571ac304f2d6a13d0ddeceb81dbed,"@@ -116,8 +116,8 @@ function gzopen($filename, $mode, $use_include_path = 0)
$BACKUP_DIR = $TMP_BASE . ""/emr_backup"";
$TAR_FILE_PATH = $TMP_BASE . DIRECTORY_SEPARATOR . $backup_file_prefix . $backup_file_suffix;
$EXPORT_FILE = $GLOBALS['temporary_files_dir'] . ""/openemr_config.sql"";
$MYSQL_PATH = $GLOBALS['mysql_bin_dir'];
$PERL_PATH = $GLOBALS['perl_bin_dir'];

if ($form_step == 6) {
    header(""Pragma: public"");

@@ -15,6 +15,7 @@
require_once(""../globals.php"");
require_once(""$srcdir/options.inc.php"");


use OpenEMR\Common\Csrf\CsrfUtils;
use OpenEMR\Core\Header;

@@ -61,29 +62,31 @@
            $url .= '&informationRecipient.languageCode.c=es';
        }

        // There are 2 different ways to get the data: have the server do it, or
        // have the browser do it.
        if (false) {
            $data = file_get_contents($url);
            echo text($data);
        } else { // Removed opener because this is not a dialog. sjp 12/14/17
            echo ""<html><body>""
            //.""<script type=\""text/javascript\"" src=\"""". $webroot .""/interface/main/tabs/js/include_opener.js\""></script>""
            . ""<script>\n"";
            echo ""document.location.href = "" . js_escape($url) . "";\n"";
            echo ""</script></body></html>\n"";
        }

        exit();
    } else {
        $lang = 'en';
        if ($language == 'es' || $language == 'spanish') {
            $lang = 'es';
        }

        $filename = strtolower(""{$codetype}_{$codevalue}_{$lang}.pdf"");

        $filepath = ""$educationdir/$filename"";

        if (is_file($filepath)) {








            header('Content-Description: File Transfer');
            header('Content-Transfer-Encoding: binary');
            header('Expires: 0');
@@ -92,10 +95,10 @@
            // attachment, not inline
            header(""Content-Disposition: attachment; filename=\""$filename\"""");
            header(""Content-Type: application/pdf"");
            header(""Content-Length: "" . filesize($filepath));
            ob_clean();
            flush();
            readfile($filepath);
            exit();
        } else {
            $errmsg = xl('There is no local content for this topic.');

@@ -16,6 +16,7 @@
require_once('../globals.php');

use OpenEMR\Common\Acl\AclMain;

use OpenEMR\Common\Csrf\CsrfUtils;
use OpenEMR\Common\Twig\TwigContainer;
use OpenEMR\Core\Header;
@@ -25,7 +26,6 @@
    exit;
}

$imagedir     = ""$OE_SITE_DIR/images"";
$educationdir = ""$OE_SITE_DIR/documents/education"";

if (!empty($_POST['bn_save'])) {
@@ -34,78 +34,7 @@
        CsrfUtils::csrfNotVerified();
    }

    /** This is a feature that allows editing of configuration files. Uncomment this
        at your own risk, since it is considered a critical security vulnerability if
        OpenEMR is not configured correctly.
    // Prepare array of names of editable files, relative to the site directory.
    $my_files = array(
    'config.php',
    'faxcover.txt',
    'faxtitle.eps',
    'referral_template.html',
    'statement.inc.php',
    'letter_templates/custom_pdf.php',
    );
    // Append LBF plugin filenames to the array.
    $lres = sqlStatement('SELECT grp_form_id FROM layout_group_properties ' .
    ""WHERE grp_form_id LIKE 'LBF%' AND grp_group_id = '' AND grp_activity = 1 ORDER BY grp_seq, grp_title"");
    while ($lrow = sqlFetchArray($lres)) {
    $option_id = $lrow['grp_form_id']; // should start with LBF
    $my_files[] = ""LBF/$option_id.plugin.php"";
    }
    $form_filename = $_REQUEST['form_filename'];
    // Sanity check to prevent evildoing.
    if (!in_array($form_filename, $my_files)) {
    $form_filename = '';
    }
    $filepath = ""$OE_SITE_DIR/$form_filename"";
    if ($form_filename) {
        // Textareas, at least in Firefox, return a \r\n at the end of each line
        // even though only \n was originally there.  For consistency with
        // normal OpenEMR usage we translate those back.
        file_put_contents($filepath, str_replace(
            ""\r\n"",
            ""\n"",
            $_POST['form_filedata']
        ));
        $form_filename = '';
    }
    */

    // Handle image uploads.
    if (is_uploaded_file($_FILES['form_image']['tmp_name']) && $_FILES['form_image']['size']) {
        $form_dest_filename = $_POST['form_dest_filename'];
        if ($form_dest_filename == '') {
            $form_dest_filename = $_FILES['form_image']['name'];
        }

        $form_dest_filename = basename($form_dest_filename);
        if ($form_dest_filename == '') {
            die(xlt('Cannot find a destination filename'));
        }

        $path_parts = pathinfo($form_dest_filename);
        if (!in_array(strtolower($path_parts['extension']), array('gif','jpg','jpe','jpeg','png','svg'))) {
            die(xlt('Only images files are accepted'));
        }

        $imagepath = ""$imagedir/$form_dest_filename"";
        // If the site's image directory does not yet exist, create it.
        if (!is_dir($imagedir)) {
            mkdir($imagedir);
        }

        if (is_file($imagepath)) {
            unlink($imagepath);
        }

        $tmp_name = $_FILES['form_image']['tmp_name'];
        if (!move_uploaded_file($_FILES['form_image']['tmp_name'], $imagepath)) {
            die(xlt('Unable to create') . "" '"" . text($imagepath) . ""'"");
        }
    }

    // Handle PDF uploads for patient education.
    if (is_uploaded_file($_FILES['form_education']['tmp_name']) && $_FILES['form_education']['size']) {
        $form_dest_filename = $_FILES['form_education']['name'];
        $form_dest_filename = strtolower(basename($form_dest_filename));
@@ -123,8 +52,11 @@
            unlink($educationpath);
        }

        $tmp_name = $_FILES['form_education']['tmp_name'];
        if (!move_uploaded_file($tmp_name, $educationpath)) {



            die(text(xl('Unable to create') . "" '$educationpath'""));
        }
    }
@@ -283,79 +215,6 @@ function msfFileChanged() {

<table class=""table table-bordered border-dark"">

<?php /** This is a feature that allows editing of configuration files. Uncomment this
at your own risk, since it is considered a critical security vulnerability if
OpenEMR is not configured correctly. ?>
 <tr class='bg-light dehead'>
  <td colspan='2' align='center'><?php echo xlt('Edit File in') . "" "" . text($OE_SITE_DIR); ?></td>
 </tr>
 <tr>
  <td valign='top' class='detail' nowrap>
   <select name='form_filename' onchange='msfFileChanged()' class=""form-control"">
    <option value=''></option>
<?php
foreach ($my_files as $filename) {
    echo ""    <option value='"" . attr($filename) . ""'"";
    if ($filename == $form_filename) {
        echo "" selected"";
    }
    echo "">"" . text($filename) . ""</option>\n"";
}
?>
   </select>
   <br />
   <textarea name='form_filedata' rows='25' class=""w-100 form-control""><?php
    if ($form_filename) {
        echo text(@file_get_contents($filepath));
    }
?></textarea>
  </td>
 </tr>
<?php */ ?>

 <tr class='dehead bg-light'>
  <td colspan='2' class='text-center'><?php echo text(xl('Upload Image to') . "" $imagedir""); ?></td>
 </tr>

 <tr>
  <td valign='top' class='detail' nowrap>
    <?php echo xlt('Source File'); ?>:
   <input type=""hidden"" name=""MAX_FILE_SIZE"" value=""12000000"" />
   <input type=""file"" name=""form_image"" size=""40"" />&nbsp;
    <?php echo xlt('Destination Filename'); ?>:
   <select name='form_dest_filename' class='form-control'>
    <option value=''>(<?php echo xlt('Use source filename'); ?>)</option>
<?php
  // Generate an <option> for each file already in the images directory.
  $dh = opendir($imagedir);
if (!$dh) {
    die(text(xl('Cannot read directory') . "" '$imagedir'""));
}

  $imagesslist = array();
while (false !== ($sfname = readdir($dh))) {
    if (substr($sfname, 0, 1) == '.') {
        continue;
    }

    if ($sfname == 'CVS') {
        continue;
    }

    $imageslist[$sfname] = $sfname;
}

  closedir($dh);
  ksort($imageslist);
foreach ($imageslist as $sfname) {
    echo ""    <option value='"" . attr($sfname) . ""'"";
    echo "">"" . text($sfname) . ""</option>\n"";
}
?>
   </select>
  </td>
 </tr>

 <tr class='dehead bg-light'>
  <td colspan='2' align='center'><?php echo text(xl('Upload Patient Education PDF to') . "" $educationdir""); ?></td>
 </tr>

","4
interface/main/backup.php
@@ -116,8 +116,8 @@ function gzopen($filename, $mode, $use_include_path = 0)
$BACKUP_DIR = $TMP_BASE . ""/emr_backup"";
$TAR_FILE_PATH = $TMP_BASE . DIRECTORY_SEPARATOR . $backup_file_prefix . $backup_file_suffix;
$EXPORT_FILE = $GLOBALS['temporary_files_dir'] . ""/openemr_config.sql"";
$MYSQL_PATH = $GLOBALS['mysql_bin_dir'];
$PERL_PATH = $GLOBALS['perl_bin_dir'];
$MYSQL_PATH = realpath($GLOBALS['mysql_bin_dir']);
$PERL_PATH = realpath($GLOBALS['perl_bin_dir']);

if ($form_step == 6) {
    header(""Pragma: public"");
33
interface/patient_file/education.php
@@ -15,6 +15,7 @@
require_once(""../globals.php"");
require_once(""$srcdir/options.inc.php"");

use OpenEMR\Common\Crypto\CryptoGen;
use OpenEMR\Common\Csrf\CsrfUtils;
use OpenEMR\Core\Header;

@@ -61,29 +62,31 @@
            $url .= '&informationRecipient.languageCode.c=es';
        }

        // There are 2 different ways to get the data: have the server do it, or
        // have the browser do it.
        if (false) {
            $data = file_get_contents($url);
            echo text($data);
        } else { // Removed opener because this is not a dialog. sjp 12/14/17
            echo ""<html><body>""
            //.""<script type=\""text/javascript\"" src=\"""". $webroot .""/interface/main/tabs/js/include_opener.js\""></script>""
            . ""<script>\n"";
            echo ""document.location.href = "" . js_escape($url) . "";\n"";
            echo ""</script></body></html>\n"";
        }
        echo ""<html><body>""
        //.""<script type=\""text/javascript\"" src=\"""". $webroot .""/interface/main/tabs/js/include_opener.js\""></script>""
        . ""<script>\n"";
        echo ""document.location.href = "" . js_escape($url) . "";\n"";
        echo ""</script></body></html>\n"";

        exit();
    } else {
        $lang = 'en';
        if ($language == 'es' || $language == 'spanish') {
            $lang = 'es';
        }

        $filename = strtolower(""{$codetype}_{$codevalue}_{$lang}.pdf"");
        check_file_dir_name($filename);
        $filepath = ""$educationdir/$filename"";

        if (is_file($filepath)) {
            $fileData = file_get_contents($filepath);

            // Decrypt file, if applicable.
            $cryptoGen = new CryptoGen();
            if ($cryptoGen->cryptCheckStandard($fileData)) {
                $fileData = $cryptoGen->decryptStandard($fileData, null, 'database');
            }

            header('Content-Description: File Transfer');
            header('Content-Transfer-Encoding: binary');
            header('Expires: 0');
@@ -92,10 +95,10 @@
            // attachment, not inline
            header(""Content-Disposition: attachment; filename=\""$filename\"""");
            header(""Content-Type: application/pdf"");
            header(""Content-Length: "" . filesize($filepath));
            header(""Content-Length: "" . strlen($fileData));
            ob_clean();
            flush();
            readfile($filepath);
            echo $fileData;
            exit();
        } else {
            $errmsg = xl('There is no local content for this topic.');
155
interface/super/manage_site_files.php
@@ -16,6 +16,7 @@
require_once('../globals.php');

use OpenEMR\Common\Acl\AclMain;
use OpenEMR\Common\Crypto\CryptoGen;
use OpenEMR\Common\Csrf\CsrfUtils;
use OpenEMR\Common\Twig\TwigContainer;
use OpenEMR\Core\Header;
@@ -25,7 +26,6 @@
    exit;
}

$imagedir     = ""$OE_SITE_DIR/images"";
$educationdir = ""$OE_SITE_DIR/documents/education"";

if (!empty($_POST['bn_save'])) {
@@ -34,78 +34,7 @@
        CsrfUtils::csrfNotVerified();
    }

    /** This is a feature that allows editing of configuration files. Uncomment this
        at your own risk, since it is considered a critical security vulnerability if
        OpenEMR is not configured correctly.
    // Prepare array of names of editable files, relative to the site directory.
    $my_files = array(
    'config.php',
    'faxcover.txt',
    'faxtitle.eps',
    'referral_template.html',
    'statement.inc.php',
    'letter_templates/custom_pdf.php',
    );
    // Append LBF plugin filenames to the array.
    $lres = sqlStatement('SELECT grp_form_id FROM layout_group_properties ' .
    ""WHERE grp_form_id LIKE 'LBF%' AND grp_group_id = '' AND grp_activity = 1 ORDER BY grp_seq, grp_title"");
    while ($lrow = sqlFetchArray($lres)) {
    $option_id = $lrow['grp_form_id']; // should start with LBF
    $my_files[] = ""LBF/$option_id.plugin.php"";
    }
    $form_filename = $_REQUEST['form_filename'];
    // Sanity check to prevent evildoing.
    if (!in_array($form_filename, $my_files)) {
    $form_filename = '';
    }
    $filepath = ""$OE_SITE_DIR/$form_filename"";
    if ($form_filename) {
        // Textareas, at least in Firefox, return a \r\n at the end of each line
        // even though only \n was originally there.  For consistency with
        // normal OpenEMR usage we translate those back.
        file_put_contents($filepath, str_replace(
            ""\r\n"",
            ""\n"",
            $_POST['form_filedata']
        ));
        $form_filename = '';
    }
    */

    // Handle image uploads.
    if (is_uploaded_file($_FILES['form_image']['tmp_name']) && $_FILES['form_image']['size']) {
        $form_dest_filename = $_POST['form_dest_filename'];
        if ($form_dest_filename == '') {
            $form_dest_filename = $_FILES['form_image']['name'];
        }

        $form_dest_filename = basename($form_dest_filename);
        if ($form_dest_filename == '') {
            die(xlt('Cannot find a destination filename'));
        }

        $path_parts = pathinfo($form_dest_filename);
        if (!in_array(strtolower($path_parts['extension']), array('gif','jpg','jpe','jpeg','png','svg'))) {
            die(xlt('Only images files are accepted'));
        }

        $imagepath = ""$imagedir/$form_dest_filename"";
        // If the site's image directory does not yet exist, create it.
        if (!is_dir($imagedir)) {
            mkdir($imagedir);
        }

        if (is_file($imagepath)) {
            unlink($imagepath);
        }

        $tmp_name = $_FILES['form_image']['tmp_name'];
        if (!move_uploaded_file($_FILES['form_image']['tmp_name'], $imagepath)) {
            die(xlt('Unable to create') . "" '"" . text($imagepath) . ""'"");
        }
    }

    // Handle PDF uploads for patient education.
     // Handle PDF uploads for patient education.
    if (is_uploaded_file($_FILES['form_education']['tmp_name']) && $_FILES['form_education']['size']) {
        $form_dest_filename = $_FILES['form_education']['name'];
        $form_dest_filename = strtolower(basename($form_dest_filename));
@@ -123,8 +52,11 @@
            unlink($educationpath);
        }

        $tmp_name = $_FILES['form_education']['tmp_name'];
        if (!move_uploaded_file($tmp_name, $educationpath)) {
        $fileData = file_get_contents($_FILES['form_education']['tmp_name']);
        if ($GLOBALS['drive_encryption']) {
            $fileData = (new Cryptogen())->encryptStandard($fileData, null, 'database');
        }
        if (file_put_contents($educationpath, $fileData) === false) {
            die(text(xl('Unable to create') . "" '$educationpath'""));
        }
    }
@@ -283,79 +215,6 @@ function msfFileChanged() {

<table class=""table table-bordered border-dark"">

<?php /** This is a feature that allows editing of configuration files. Uncomment this
at your own risk, since it is considered a critical security vulnerability if
OpenEMR is not configured correctly. ?>
 <tr class='bg-light dehead'>
  <td colspan='2' align='center'><?php echo xlt('Edit File in') . "" "" . text($OE_SITE_DIR); ?></td>
 </tr>
 <tr>
  <td valign='top' class='detail' nowrap>
   <select name='form_filename' onchange='msfFileChanged()' class=""form-control"">
    <option value=''></option>
<?php
foreach ($my_files as $filename) {
    echo ""    <option value='"" . attr($filename) . ""'"";
    if ($filename == $form_filename) {
        echo "" selected"";
    }
    echo "">"" . text($filename) . ""</option>\n"";
}
?>
   </select>
   <br />
   <textarea name='form_filedata' rows='25' class=""w-100 form-control""><?php
    if ($form_filename) {
        echo text(@file_get_contents($filepath));
    }
?></textarea>
  </td>
 </tr>
<?php */ ?>

 <tr class='dehead bg-light'>
  <td colspan='2' class='text-center'><?php echo text(xl('Upload Image to') . "" $imagedir""); ?></td>
 </tr>

 <tr>
  <td valign='top' class='detail' nowrap>
    <?php echo xlt('Source File'); ?>:
   <input type=""hidden"" name=""MAX_FILE_SIZE"" value=""12000000"" />
   <input type=""file"" name=""form_image"" size=""40"" />&nbsp;
    <?php echo xlt('Destination Filename'); ?>:
   <select name='form_dest_filename' class='form-control'>
    <option value=''>(<?php echo xlt('Use source filename'); ?>)</option>
<?php
  // Generate an <option> for each file already in the images directory.
  $dh = opendir($imagedir);
if (!$dh) {
    die(text(xl('Cannot read directory') . "" '$imagedir'""));
}

  $imagesslist = array();
while (false !== ($sfname = readdir($dh))) {
    if (substr($sfname, 0, 1) == '.') {
        continue;
    }

    if ($sfname == 'CVS') {
        continue;
    }

    $imageslist[$sfname] = $sfname;
}

  closedir($dh);
  ksort($imageslist);
foreach ($imageslist as $sfname) {
    echo ""    <option value='"" . attr($sfname) . ""'"";
    echo "">"" . text($sfname) . ""</option>\n"";
}
?>
   </select>
  </td>
 </tr>

 <tr class='dehead bg-light'>
  <td colspan='2' align='center'><?php echo text(xl('Upload Patient Education PDF to') . "" $educationdir""); ?></td>
 </tr>",,
https://huntr.dev/bounties/63f1ff91-48f3-4886-a179-103f1ddd8ff8/,RCE using bad deserialization in builderio/qwik,"Qwik provides an extended serialization mechanism for exchanging data between the client and server. This allows for the serialization and deserialization of Date, Regex, Signal, Function and many other useful data types.",CVE-2023-1283,CWE-94: Code Injection,https://www.github.com/builderio/qwik/commit/4d9ba6e098ae6e537aa55abb6b8369bb670ffe66,"@@ -226,20 +226,6 @@ const ComponentSerializer: Serializer<Component<any>> = {
  },
};

const PureFunctionSerializer: Serializer<Function> = {
  prefix: '\u0011',
  test: (obj) => typeof obj === 'function' && obj.__qwik_serializable__ !== undefined,
  serialize: (obj) => {
    return obj.toString();
  },
  prepare: (data) => {
    const fn = new Function('return ' + data)();
    fn.__qwik_serializable__ = true;
    return fn;
  },
  fill: undefined,
};

const SignalSerializer: Serializer<SignalImpl<any>> = {
  prefix: '\u0012',
  test: (v) => v instanceof SignalImpl,
@@ -335,21 +321,20 @@ const FormDataSerializer: Serializer<FormData> = {
};

const serializers: Serializer<any>[] = [
  QRLSerializer,
  SignalSerializer,
  SignalWrapperSerializer,
  WatchSerializer,
  ResourceSerializer,
  URLSerializer,
  DateSerializer,
  RegexSerializer,
  ErrorSerializer,
  DocumentSerializer,
  ComponentSerializer,
  PureFunctionSerializer,
  NoFiniteNumberSerializer,
  URLSearchParamsSerializer,
  FormDataSerializer,
];

const collectorSerializers = /*#__PURE__*/ serializers.filter((a) => a.collect);

","43
packages/qwik/src/core/container/serializers.ts
@@ -226,20 +226,6 @@ const ComponentSerializer: Serializer<Component<any>> = {
  },
};

const PureFunctionSerializer: Serializer<Function> = {
  prefix: '\u0011',
  test: (obj) => typeof obj === 'function' && obj.__qwik_serializable__ !== undefined,
  serialize: (obj) => {
    return obj.toString();
  },
  prepare: (data) => {
    const fn = new Function('return ' + data)();
    fn.__qwik_serializable__ = true;
    return fn;
  },
  fill: undefined,
};

const SignalSerializer: Serializer<SignalImpl<any>> = {
  prefix: '\u0012',
  test: (v) => v instanceof SignalImpl,
@@ -335,21 +321,20 @@ const FormDataSerializer: Serializer<FormData> = {
};

const serializers: Serializer<any>[] = [
  QRLSerializer,
  SignalSerializer,
  SignalWrapperSerializer,
  WatchSerializer,
  ResourceSerializer,
  URLSerializer,
  DateSerializer,
  RegexSerializer,
  ErrorSerializer,
  DocumentSerializer,
  ComponentSerializer,
  PureFunctionSerializer,
  NoFiniteNumberSerializer,
  URLSearchParamsSerializer,
  FormDataSerializer,
  QRLSerializer, ////////////// \u0002
  SignalSerializer, /////////// \u0012
  SignalWrapperSerializer, //// \u0013
  WatchSerializer, //////////// \u0003
  ResourceSerializer, ///////// \u0004
  URLSerializer, ////////////// \u0005
  DateSerializer, ///////////// \u0006
  RegexSerializer, //////////// \u0007
  ErrorSerializer, //////////// \u000E
  DocumentSerializer, ///////// \u000F
  ComponentSerializer, //////// \u0010
  NoFiniteNumberSerializer, /// \u0014
  URLSearchParamsSerializer, // \u0015
  FormDataSerializer, ///////// \u0016
];

const collectorSerializers = /*#__PURE__*/ serializers.filter((a) => a.collect);",,
https://huntr.dev/bounties/ad1f917f-2b25-40ef-9215-c805354c683b/,XSS via Client Side Template Injection in btcpayserver/btcpayserver,Hi Team!,CVE-2023-1270,CWE-77: Command Injection,https://www.github.com/btcpayserver/btcpayserver/commit/7b5ce8f70c060b01990d3f7109e97e0144d878a4,"@@ -114,6 +114,11 @@ public void Add(ConsentSecurityPolicy policy)
            _Policies.Add(policy);
        }






        public IEnumerable<ConsentSecurityPolicy> Rules => _Policies;
        public bool HasRules => _Policies.Count != 0;


@@ -24,7 +24,7 @@ public ContentSecurityPolicyAttribute(CSPTemplate template)
                AutoSelf = false;
                FixWebsocket = false;
                UnsafeInline = false;
                ScriptSrc = ""'self' 'unsafe-eval'""; // unsafe-eval needed for vue
            }
        }


@@ -3,13 +3,14 @@
@inject BTCPayServer.Services.BTCPayServerEnvironment Env
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@{
    ViewData[""Title""] = Model.Title;
    Layout = null;
    if (!string.IsNullOrEmpty(Model.DisqusShortname))
    {
        Csp.Add(""script-src"", $""https://{Model.DisqusShortname}.disqus.com"");
        Csp.Add(""script-src"", ""https://c.disquscdn.com"");
    }

}
<!DOCTYPE html>
<html class=""h-100"" @(Env.IsDeveloping ? "" data-devenv"" : """")>
@@ -55,13 +56,13 @@
<div class=""public-page-wrap flex-column container"" id=""app"" @(Model.SimpleDisplay ? """" : ""v-cloak"")>
    @if (!string.IsNullOrEmpty(Model.MainImageUrl))
    {
        <img v-if=""srvModel.mainImageUrl"" src=""@Model.MainImageUrl"" :src=""srvModel.mainImageUrl"" alt=""@Model.Title"" :alt=""srvModel.title"" id=""crowdfund-main-image"" asp-append-version=""true""/>
    }
    <div class=""d-flex flex-column justify-content-between p-3 text-center"" id=""crowdfund-header-container"">
        <h1 class=""mb-3"">@Model.Title</h1>
        @if (!string.IsNullOrEmpty(Model.Tagline))
        {
            <h2 class=""h3 mb-3 fw-semibold"" v-if=""srvModel.tagline"" v-text=""srvModel.tagline"">@Model.Tagline</h2>
        }
        @if (Model.TargetAmount.HasValue)
        {
@@ -221,7 +222,6 @@
                <b-tabs>
                    <b-tab title=""Details"" active>
                        <div class=""overflow-hidden pt-3"" v-html=""srvModel.description"" id=""crowdfund-body-description"">
                            @Safe.Raw(Model.Description)
                        </div>
                    </b-tab>
                    <b-tab title=""Discussion"">
@@ -231,7 +231,6 @@
            </template>
            <template v-else>
                <div class=""overflow-hidden"" v-html=""srvModel.description"" id=""crowdfund-body-description"">
                    @Safe.Raw(Model.Description)
                </div>
            </template>
        </div>
@@ -246,7 +245,7 @@
            </contribute>
        </div>
    </div>
    <noscript>
        <div class=""row justify-content-between"">
            <div class=""col-md-7  col-sm-12"">
                <div class=""overflow-hidden"">@Safe.Raw(Model.Description)</div>

@@ -4,9 +4,11 @@
@using BTCPayServer.TagHelpers
@using BTCPayServer.Views.Apps
@using Microsoft.AspNetCore.Mvc.TagHelpers

@model BTCPayServer.Plugins.Crowdfund.Models.UpdateCrowdfundViewModel
@{
    ViewData.SetActivePage(AppsNavPages.Update, ""Update Crowdfund"", Model.AppId);

}

@section PageHeadContent {

@@ -1,7 +1,9 @@
@using BTCPayServer.Views.Stores

@model BTCPayServer.Plugins.PayButton.Models.PayButtonViewModel
@{
    ViewData.SetActivePage(StoreNavPages.PayButton, ""Pay Button"", Context.GetStoreData().Id);

}

@section PageHeadContent {

@@ -1,6 +1,8 @@

@model BTCPayServer.Plugins.PointOfSale.Models.ViewPointOfSaleViewModel
@{
    Layout = ""PointOfSale/Public/_Layout"";

}
@section PageHeadContent {
    <style>

@@ -5,10 +5,11 @@
@using BTCPayServer.Forms
@using BTCPayServer.Services.Stores
@inject FormDataService FormDataService

@model BTCPayServer.Plugins.PointOfSale.Models.UpdatePointOfSaleViewModel
@{
    ViewData.SetActivePage(AppsNavPages.Update, ""Update Point of Sale"", Model.Id);

    var checkoutFormOptions = await FormDataService.GetSelect(Model.StoreId, Model.FormId);
}


@@ -8,7 +8,7 @@
    }
}

<table class=""table my-0"">
    @foreach (var (key, value) in Model.Items)
    {
        <tr>

@@ -8,7 +8,7 @@
            foreach (var error in errors.Errors)
            {
                <br/>
                <span class=""text-danger"">@error.ErrorMessage</span>
            }
        }


@@ -27,7 +27,7 @@
    @await RenderSectionAsync(""PageHeadContent"", false)
</head>
<body class=""d-flex flex-column flex-lg-row min-vh-100"">
<header id=""mainMenu"" class=""btcpay-header d-flex flex-column"">
    <div id=""mainMenuHead"">
        <button id=""mainMenuToggle"" class=""mainMenuButton"" type=""button"" data-bs-toggle=""offcanvas"" data-bs-target=""#mainNav"" aria-controls=""mainNav"" aria-expanded=""false"" aria-label=""Toggle navigation"">
            <span>Menu</span>

@@ -1,4 +1,4 @@
@{
    Layout = ""_LayoutSimple"";
    ViewBag.ShowTitle ??= true;
    ViewBag.ShowLeadText ??= false;
@@ -50,7 +50,7 @@
<div class=""account-form"">
    @if (ViewBag.ShowTitle)
    {
        <h4>@ViewData[""Title""]</h4>
    }
    @RenderBody()
</div>

@@ -5,7 +5,7 @@

@if (parsedModel != null)
{
    <div class=""alert alert-@parsedModel.SeverityCSS @(parsedModel.AllowDismiss? ""alert-dismissible"":"""" ) @(ViewData[""Margin""] ?? ""mb-4"") text-break"" role=""alert"">
        @if (parsedModel.AllowDismiss)
        {
            <button type=""button"" class=""btn-close"" data-bs-dismiss=""alert"" aria-label=""Close"">

@@ -7,7 +7,7 @@
        ? await FileService.GetFileUrl(Context.Request.GetAbsoluteRootUri(), Model.LogoFileId)
        : null;
}
<header class=""store-header"">
    @if (!string.IsNullOrEmpty(logoUrl))
    {
        <img src=""@logoUrl"" alt=""@Model.Title"" class=""store-logo""/>

@@ -1,8 +1,10 @@
@model LoginViewModel

@inject BTCPayServer.Services.PoliciesSettings PoliciesSettings
@{
    ViewData[""Title""] = ""Sign in"";
    Layout = ""_LayoutSignedOut"";

}

<form asp-route-returnurl=""@ViewData[""ReturnUrl""]"" method=""post"" id=""login-form"" asp-action=""Login"">

@@ -1,9 +1,11 @@
@using BTCPayServer.Views.Apps
@using BTCPayServer.Abstractions.Extensions
@using BTCPayServer.Abstractions.Custodians

@model BTCPayServer.Models.CustodianAccountViewModels.ViewCustodianAccountViewModel
@{
    ViewData.SetActivePage(AppsNavPages.Create, ""Custodian account: "" + @Model?.CustodianAccount.Name);

}

@section PageHeadContent

@@ -1,9 +1,11 @@
@inject BTCPayServer.Services.LanguageService langService
@inject BTCPayServer.Services.BTCPayServerEnvironment env
@inject PaymentMethodHandlerDictionary PaymentMethodHandlerDictionary

@model PaymentModel
@{
    Layout = null;

}

<!DOCTYPE html>

@@ -5,12 +5,13 @@
@inject BTCPayServerEnvironment Env
@inject IEnumerable<IUIExtension> UiExtensions 
@inject PaymentMethodHandlerDictionary PaymentMethodHandlerDictionary

@model PaymentModel
@{
    Layout = null;
    ViewData[""Title""] = Model.HtmlTitle;

    var hasPaymentPlugins = UiExtensions.Any(extension => extension.Location == ""checkout-payment-method"");
    // Show LNURL as selectable payment method only for top up invoices + non-BIP21 case
    var displayedPaymentMethods = Model.IsUnsetTopUp && !Model.OnChainWithLnInvoiceFallback
        ? Model.AvailableCryptos
@@ -49,7 +50,7 @@
            <section id=""payment"" v-if=""isActive"">
                @if (!string.IsNullOrEmpty(Model.ItemDesc) && Model.ItemDesc != Model.StoreName)
                {
                    <h5 class=""text-center mt-1 mb-3 fw-semibold"" v-if=""srvModel.itemDesc"" v-text=""srvModel.itemDesc"">@Model.ItemDesc</h5>
                }
                @if (Model.IsUnsetTopUp)
                {

@@ -1,8 +1,10 @@
@namespace BTCPayServer.Client
@using BTCPayServer.Abstractions.Models

@model BTCPayServer.Controllers.UIManageController.ApiKeysViewModel
@{
    ViewData.SetActivePage(ManageNavPages.APIKeys, ""API Keys"");

}

<div class=""row"">

@@ -3,9 +3,11 @@
@using BTCPayServer.Client
@model BTCPayServer.Models.PaymentRequestViewModels.ViewPaymentRequestViewModel
@inject BTCPayServer.Services.BTCPayServerEnvironment Env

@{
    ViewData[""Title""] = Model.Title;
    Layout = null;

    string StatusClass(InvoiceState state)
    {
        switch (state.Status.ToModernStatus())
@@ -68,7 +70,7 @@
                    <div class=""col-12 col-md-8 col-lg-9"">
                        <div class=""row"">
                            <div class=""col col-12 col-lg-8"">
                                <h1 class=""h3"" v-text=""srvModel.title"">@Model.Title</h1>
                            </div>
                            <div class=""col col-12 col-sm-6 col-lg-8 d-flex align-items-center"">
                                <span class=""text-muted text-nowrap"">Last Updated</span>
@@ -204,9 +206,7 @@
                            <h2 class=""h4 mb-3"">Invoice Summary</h2>
                            @if (!string.IsNullOrEmpty(Model.Description) && Model.Description != ""<br>"")
                            {
                                <div v-html=""srvModel.description"">
                                    @Safe.Raw(Model.Description)
                                </div>
                            }
                            else
                            {

@@ -4,9 +4,11 @@
@using BTCPayServer.Components.ThemeSwitch
@using BTCPayServer.Payments
@model BTCPayServer.Models.ViewPullPaymentModel


@{
    ViewData[""Title""] = Model.Title;

    Layout = null;
    string StatusTextClass(string status)
    {

@@ -1,7 +1,9 @@

@model WalletSetupViewModel
@{
    Layout = ""_LayoutWalletSetup"";
    ViewData.SetActivePage(StoreNavPages.OnchainSettings, ""Scan QR code"", Context.GetStoreData().Id);

}

@section Navbar {

@@ -2,11 +2,13 @@
@using Newtonsoft.Json
@using System.Text
@using BTCPayServer.Abstractions.Models

@model WalletSettingsViewModel
@{
    Layout = ""../Shared/_NavLayout.cshtml"";
    ViewData[""NavPartialName""] = ""../UIWallets/_Nav"";
    ViewData.SetActivePage(StoreNavPages.OnchainSettings, $""{Model.CryptoCode} Wallet Settings"", Context.GetStoreData().Id);

}

@section PageHeadContent {

@@ -1,11 +1,13 @@
@using BTCPayServer.Controllers

@model WalletPSBTViewModel
@{
    var walletId = Context.GetRouteValue(""walletId"").ToString();
    var cancelUrl = Model.ReturnUrl ?? Url.Action(nameof(UIWalletsController.WalletTransactions), new { walletId });
    var backUrl = Model.BackUrl != null ? $""{Model.BackUrl}?returnUrl={Model.ReturnUrl}"" : null;
    Layout = ""_LayoutWizard"";
    ViewData.SetActivePage(WalletsNavPages.PSBT, ""Decode PSBT"", walletId);

}

@section Navbar {

@@ -1,14 +1,16 @@
@using BTCPayServer.Controllers

@model WalletPSBTViewModel
@{
 var walletId = Context.GetRouteValue(""walletId"").ToString();
    var cancelUrl = Model.ReturnUrl ?? Url.Action(nameof(UIWalletsController.WalletTransactions), new { walletId });
    var backUrl = Model.BackUrl != null ? $""{Model.BackUrl}?returnUrl={Model.ReturnUrl}"" : null;
 var isReady = !Model.HasErrors;
 var isSignable = !isReady;
 var needsExport = !isSignable && !isReady;
 Layout = ""_LayoutWizard"";
 ViewData.SetActivePage(WalletsNavPages.PSBT, isReady ? ""Confirm broadcasting this transaction"" : ""Transaction Details"", walletId);

}

@section PageHeadContent {

","5
BTCPayServer.Abstractions/Security/ContentSecurityPolicies.cs
@@ -114,6 +114,11 @@ public void Add(ConsentSecurityPolicy policy)
            _Policies.Add(policy);
        }

        public void UnsafeEval()
        {
            Add(""script-src"", ""'unsafe-eval'"");
        }

        public IEnumerable<ConsentSecurityPolicy> Rules => _Policies;
        public bool HasRules => _Policies.Count != 0;

2
BTCPayServer/Filters/ContentSecurityPolicyAttribute.cs
@@ -24,7 +24,7 @@ public ContentSecurityPolicyAttribute(CSPTemplate template)
                AutoSelf = false;
                FixWebsocket = false;
                UnsafeInline = false;
                ScriptSrc = ""'self' 'unsafe-eval'""; // unsafe-eval needed for vue
                ScriptSrc = ""'self'"";
            }
        }

25
BTCPayServer/Views/Shared/Crowdfund/Public/ViewCrowdfund.cshtml
@@ -3,13 +3,14 @@
@inject BTCPayServer.Services.BTCPayServerEnvironment Env
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@{
    ViewData[""Title""] = Model.Title;
    Layout = null;
    if (!string.IsNullOrEmpty(Model.DisqusShortname))
    {
        Csp.Add(""script-src"", $""https://{Model.DisqusShortname}.disqus.com"");
        Csp.Add(""script-src"", ""https://c.disquscdn.com"");
    }
 ViewData[""Title""] = Model.Title;
 Layout = null;
 Csp.UnsafeEval();
 if (!string.IsNullOrEmpty(Model.DisqusShortname))
 {
  Csp.Add(""script-src"", $""https://{Model.DisqusShortname}.disqus.com"");
  Csp.Add(""script-src"", ""https://c.disquscdn.com"");
 }
}
<!DOCTYPE html>
<html class=""h-100"" @(Env.IsDeveloping ? "" data-devenv"" : """")>
@@ -55,13 +56,13 @@
<div class=""public-page-wrap flex-column container"" id=""app"" @(Model.SimpleDisplay ? """" : ""v-cloak"")>
    @if (!string.IsNullOrEmpty(Model.MainImageUrl))
    {
        <img v-if=""srvModel.mainImageUrl"" src=""@Model.MainImageUrl"" :src=""srvModel.mainImageUrl"" alt=""@Model.Title"" :alt=""srvModel.title"" id=""crowdfund-main-image"" asp-append-version=""true""/>
        <img v-if=""srvModel.mainImageUrl"" :src=""srvModel.mainImageUrl"" :alt=""srvModel.title"" id=""crowdfund-main-image"" asp-append-version=""true""/>
    }
    <div class=""d-flex flex-column justify-content-between p-3 text-center"" id=""crowdfund-header-container"">
        <h1 class=""mb-3"">@Model.Title</h1>
   <h1 class=""mb-3"">{{ srvModel.title }}</h1>
        @if (!string.IsNullOrEmpty(Model.Tagline))
        {
            <h2 class=""h3 mb-3 fw-semibold"" v-if=""srvModel.tagline"" v-text=""srvModel.tagline"">@Model.Tagline</h2>
            <h2 class=""h3 mb-3 fw-semibold"" v-if=""srvModel.tagline"" v-text=""srvModel.tagline""></h2>
        }
        @if (Model.TargetAmount.HasValue)
        {
@@ -221,7 +222,6 @@
                <b-tabs>
                    <b-tab title=""Details"" active>
                        <div class=""overflow-hidden pt-3"" v-html=""srvModel.description"" id=""crowdfund-body-description"">
                            @Safe.Raw(Model.Description)
                        </div>
                    </b-tab>
                    <b-tab title=""Discussion"">
@@ -231,7 +231,6 @@
            </template>
            <template v-else>
                <div class=""overflow-hidden"" v-html=""srvModel.description"" id=""crowdfund-body-description"">
                    @Safe.Raw(Model.Description)
                </div>
            </template>
        </div>
@@ -246,7 +245,7 @@
            </contribute>
        </div>
    </div>
    <noscript>
 <noscript v-pre>
        <div class=""row justify-content-between"">
            <div class=""col-md-7  col-sm-12"">
                <div class=""overflow-hidden"">@Safe.Raw(Model.Description)</div>
2
BTCPayServer/Views/Shared/Crowdfund/UpdateCrowdfund.cshtml
@@ -4,9 +4,11 @@
@using BTCPayServer.TagHelpers
@using BTCPayServer.Views.Apps
@using Microsoft.AspNetCore.Mvc.TagHelpers
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model BTCPayServer.Plugins.Crowdfund.Models.UpdateCrowdfundViewModel
@{
    ViewData.SetActivePage(AppsNavPages.Update, ""Update Crowdfund"", Model.AppId);
 Csp.UnsafeEval();
}

@section PageHeadContent {
2
BTCPayServer/Views/Shared/PayButton/PayButton.cshtml
@@ -1,7 +1,9 @@
@using BTCPayServer.Views.Stores
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model BTCPayServer.Plugins.PayButton.Models.PayButtonViewModel
@{
    ViewData.SetActivePage(StoreNavPages.PayButton, ""Pay Button"", Context.GetStoreData().Id);
 Csp.UnsafeEval();
}

@section PageHeadContent {
2
BTCPayServer/Views/Shared/PointOfSale/Public/Light.cshtml
@@ -1,6 +1,8 @@
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model BTCPayServer.Plugins.PointOfSale.Models.ViewPointOfSaleViewModel
@{
    Layout = ""PointOfSale/Public/_Layout"";
 Csp.UnsafeEval();
}
@section PageHeadContent {
    <style>
3
BTCPayServer/Views/Shared/PointOfSale/UpdatePointOfSale.cshtml
@@ -5,10 +5,11 @@
@using BTCPayServer.Forms
@using BTCPayServer.Services.Stores
@inject FormDataService FormDataService
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model BTCPayServer.Plugins.PointOfSale.Models.UpdatePointOfSaleViewModel
@{
    ViewData.SetActivePage(AppsNavPages.Update, ""Update Point of Sale"", Model.Id);

 Csp.UnsafeEval();
    var checkoutFormOptions = await FormDataService.GetSelect(Model.StoreId, Model.FormId);
}

2
BTCPayServer/Views/Shared/PosData.cshtml
@@ -8,7 +8,7 @@
    }
}

<table class=""table my-0"">
<table class=""table my-0"" v-pre>
    @foreach (var (key, value) in Model.Items)
    {
        <tr>
2
BTCPayServer/Views/Shared/TemplateEditor.cshtml
@@ -8,7 +8,7 @@
            foreach (var error in errors.Errors)
            {
                <br/>
                <span class=""text-danger"">@error.ErrorMessage</span>
                <span class=""text-danger"" v-pre>@error.ErrorMessage</span>
            }
        }

2
BTCPayServer/Views/Shared/_Layout.cshtml
@@ -27,7 +27,7 @@
    @await RenderSectionAsync(""PageHeadContent"", false)
</head>
<body class=""d-flex flex-column flex-lg-row min-vh-100"">
<header id=""mainMenu"" class=""btcpay-header d-flex flex-column"">
<header id=""mainMenu"" class=""btcpay-header d-flex flex-column"" v-pre>
    <div id=""mainMenuHead"">
        <button id=""mainMenuToggle"" class=""mainMenuButton"" type=""button"" data-bs-toggle=""offcanvas"" data-bs-target=""#mainNav"" aria-controls=""mainNav"" aria-expanded=""false"" aria-label=""Toggle navigation"">
            <span>Menu</span>
4
BTCPayServer/Views/Shared/_LayoutSignedOut.cshtml
@@ -1,4 +1,4 @@
@{
@{
    Layout = ""_LayoutSimple"";
    ViewBag.ShowTitle ??= true;
    ViewBag.ShowLeadText ??= false;
@@ -50,7 +50,7 @@
<div class=""account-form"">
    @if (ViewBag.ShowTitle)
    {
        <h4>@ViewData[""Title""]</h4>
   <h4 v-pre>@ViewData[""Title""]</h4>
    }
    @RenderBody()
</div>
2
BTCPayServer/Views/Shared/_StatusMessage.cshtml
@@ -5,7 +5,7 @@

@if (parsedModel != null)
{
    <div class=""alert alert-@parsedModel.SeverityCSS @(parsedModel.AllowDismiss? ""alert-dismissible"":"""" ) @(ViewData[""Margin""] ?? ""mb-4"") text-break"" role=""alert"">
 <div class=""alert alert-@parsedModel.SeverityCSS @(parsedModel.AllowDismiss? ""alert-dismissible"":"""" ) @(ViewData[""Margin""] ?? ""mb-4"") text-break"" role=""alert"" v-pre>
        @if (parsedModel.AllowDismiss)
        {
            <button type=""button"" class=""btn-close"" data-bs-dismiss=""alert"" aria-label=""Close"">
2
BTCPayServer/Views/Shared/_StoreHeader.cshtml
@@ -7,7 +7,7 @@
        ? await FileService.GetFileUrl(Context.Request.GetAbsoluteRootUri(), Model.LogoFileId)
        : null;
}
<header class=""store-header"">
<header class=""store-header"" v-pre>
    @if (!string.IsNullOrEmpty(logoUrl))
    {
        <img src=""@logoUrl"" alt=""@Model.Title"" class=""store-logo""/>
6
BTCPayServer/Views/UIAccount/Login.cshtml
@@ -1,8 +1,10 @@
@model LoginViewModel
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@inject BTCPayServer.Services.PoliciesSettings PoliciesSettings
@{
    ViewData[""Title""] = ""Sign in"";
    Layout = ""_LayoutSignedOut"";
 ViewData[""Title""] = ""Sign in"";
 Layout = ""_LayoutSignedOut"";
 Csp.UnsafeEval();
}

<form asp-route-returnurl=""@ViewData[""ReturnUrl""]"" method=""post"" id=""login-form"" asp-action=""Login"">
4
BTCPayServer/Views/UICustodianAccounts/ViewCustodianAccount.cshtml
@@ -1,9 +1,11 @@
@using BTCPayServer.Views.Apps
@using BTCPayServer.Abstractions.Extensions
@using BTCPayServer.Abstractions.Custodians
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model BTCPayServer.Models.CustodianAccountViewModels.ViewCustodianAccountViewModel
@{
    ViewData.SetActivePage(AppsNavPages.Create, ""Custodian account: "" + @Model?.CustodianAccount.Name);
 ViewData.SetActivePage(AppsNavPages.Create, ""Custodian account: "" + @Model?.CustodianAccount.Name);
 Csp.UnsafeEval();
}

@section PageHeadContent
4
BTCPayServer/Views/UIInvoice/Checkout.cshtml
@@ -1,9 +1,11 @@
@inject BTCPayServer.Services.LanguageService langService
@inject BTCPayServer.Services.BTCPayServerEnvironment env
@inject PaymentMethodHandlerDictionary PaymentMethodHandlerDictionary
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model PaymentModel
@{
    Layout = null;
 Layout = null;
 Csp.UnsafeEval();
}

<!DOCTYPE html>
11
BTCPayServer/Views/UIInvoice/CheckoutV2.cshtml
@@ -5,12 +5,13 @@
@inject BTCPayServerEnvironment Env
@inject IEnumerable<IUIExtension> UiExtensions 
@inject PaymentMethodHandlerDictionary PaymentMethodHandlerDictionary
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model PaymentModel
@{
    Layout = null;
    ViewData[""Title""] = Model.HtmlTitle;

    var hasPaymentPlugins = UiExtensions.Any(extension => extension.Location == ""checkout-payment-method"");
 Layout = null;
 ViewData[""Title""] = Model.HtmlTitle;
 Csp.UnsafeEval();
 var hasPaymentPlugins = UiExtensions.Any(extension => extension.Location == ""checkout-payment-method"");
    // Show LNURL as selectable payment method only for top up invoices + non-BIP21 case
    var displayedPaymentMethods = Model.IsUnsetTopUp && !Model.OnChainWithLnInvoiceFallback
        ? Model.AvailableCryptos
@@ -49,7 +50,7 @@
            <section id=""payment"" v-if=""isActive"">
                @if (!string.IsNullOrEmpty(Model.ItemDesc) && Model.ItemDesc != Model.StoreName)
                {
                    <h5 class=""text-center mt-1 mb-3 fw-semibold"" v-if=""srvModel.itemDesc"" v-text=""srvModel.itemDesc"">@Model.ItemDesc</h5>
                    <h5 class=""text-center mt-1 mb-3 fw-semibold"" v-if=""srvModel.itemDesc"" v-text=""srvModel.itemDesc""></h5>
                }
                @if (Model.IsUnsetTopUp)
                {
4
BTCPayServer/Views/UIManage/APIKeys.cshtml
@@ -1,8 +1,10 @@
@namespace BTCPayServer.Client
@using BTCPayServer.Abstractions.Models
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model BTCPayServer.Controllers.UIManageController.ApiKeysViewModel
@{
    ViewData.SetActivePage(ManageNavPages.APIKeys, ""API Keys"");
 ViewData.SetActivePage(ManageNavPages.APIKeys, ""API Keys"");
 Csp.UnsafeEval();
}

<div class=""row"">
12
BTCPayServer/Views/UIPaymentRequest/ViewPaymentRequest.cshtml
@@ -3,9 +3,11 @@
@using BTCPayServer.Client
@model BTCPayServer.Models.PaymentRequestViewModels.ViewPaymentRequestViewModel
@inject BTCPayServer.Services.BTCPayServerEnvironment Env
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@{
    ViewData[""Title""] = Model.Title;
    Layout = null;
 ViewData[""Title""] = Model.Title;
 Csp.UnsafeEval();
 Layout = null;
    string StatusClass(InvoiceState state)
    {
        switch (state.Status.ToModernStatus())
@@ -68,7 +70,7 @@
                    <div class=""col-12 col-md-8 col-lg-9"">
                        <div class=""row"">
                            <div class=""col col-12 col-lg-8"">
                                <h1 class=""h3"" v-text=""srvModel.title"">@Model.Title</h1>
                                <h1 class=""h3"" v-text=""srvModel.title""></h1>
                            </div>
                            <div class=""col col-12 col-sm-6 col-lg-8 d-flex align-items-center"">
                                <span class=""text-muted text-nowrap"">Last Updated</span>
@@ -204,9 +206,7 @@
                            <h2 class=""h4 mb-3"">Invoice Summary</h2>
                            @if (!string.IsNullOrEmpty(Model.Description) && Model.Description != ""<br>"")
                            {
                                <div v-html=""srvModel.description"">
                                    @Safe.Raw(Model.Description)
                                </div>
                                <div v-html=""srvModel.description""></div>
                            }
                            else
                            {
2
BTCPayServer/Views/UIPullPayment/ViewPullPayment.cshtml
@@ -4,9 +4,11 @@
@using BTCPayServer.Components.ThemeSwitch
@using BTCPayServer.Payments
@model BTCPayServer.Models.ViewPullPaymentModel
@inject BTCPayServer.Security.ContentSecurityPolicies Csp

@{
    ViewData[""Title""] = Model.Title;
 Csp.UnsafeEval();
    Layout = null;
    string StatusTextClass(string status)
    {
6
BTCPayServer/Views/UIStores/ImportWallet/Scan.cshtml
@@ -1,7 +1,9 @@
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model WalletSetupViewModel
@{
    Layout = ""_LayoutWalletSetup"";
    ViewData.SetActivePage(StoreNavPages.OnchainSettings, ""Scan QR code"", Context.GetStoreData().Id);
 Layout = ""_LayoutWalletSetup"";
 ViewData.SetActivePage(StoreNavPages.OnchainSettings, ""Scan QR code"", Context.GetStoreData().Id);
 Csp.UnsafeEval();
}

@section Navbar {
8
BTCPayServer/Views/UIStores/WalletSettings.cshtml
@@ -2,11 +2,13 @@
@using Newtonsoft.Json
@using System.Text
@using BTCPayServer.Abstractions.Models
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model WalletSettingsViewModel
@{
    Layout = ""../Shared/_NavLayout.cshtml"";
    ViewData[""NavPartialName""] = ""../UIWallets/_Nav"";
    ViewData.SetActivePage(StoreNavPages.OnchainSettings, $""{Model.CryptoCode} Wallet Settings"", Context.GetStoreData().Id);
 Layout = ""../Shared/_NavLayout.cshtml"";
 ViewData[""NavPartialName""] = ""../UIWallets/_Nav"";
 ViewData.SetActivePage(StoreNavPages.OnchainSettings, $""{Model.CryptoCode} Wallet Settings"", Context.GetStoreData().Id);
 Csp.UnsafeEval();
}

@section PageHeadContent {
12
BTCPayServer/Views/UIWallets/WalletPSBT.cshtml
@@ -1,11 +1,13 @@
@using BTCPayServer.Controllers
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model WalletPSBTViewModel
@{
    var walletId = Context.GetRouteValue(""walletId"").ToString();
    var cancelUrl = Model.ReturnUrl ?? Url.Action(nameof(UIWalletsController.WalletTransactions), new { walletId });
    var backUrl = Model.BackUrl != null ? $""{Model.BackUrl}?returnUrl={Model.ReturnUrl}"" : null;
    Layout = ""_LayoutWizard"";
    ViewData.SetActivePage(WalletsNavPages.PSBT, ""Decode PSBT"", walletId);
 var walletId = Context.GetRouteValue(""walletId"").ToString();
 var cancelUrl = Model.ReturnUrl ?? Url.Action(nameof(UIWalletsController.WalletTransactions), new { walletId });
 var backUrl = Model.BackUrl != null ? $""{Model.BackUrl}?returnUrl={Model.ReturnUrl}"" : null;
 Layout = ""_LayoutWizard"";
 ViewData.SetActivePage(WalletsNavPages.PSBT, ""Decode PSBT"", walletId);
 Csp.UnsafeEval();
}

@section Navbar {
6
BTCPayServer/Views/UIWallets/WalletPSBTDecoded.cshtml
@@ -1,14 +1,16 @@
@using BTCPayServer.Controllers
@inject BTCPayServer.Security.ContentSecurityPolicies Csp
@model WalletPSBTViewModel
@{
 var walletId = Context.GetRouteValue(""walletId"").ToString();
    var cancelUrl = Model.ReturnUrl ?? Url.Action(nameof(UIWalletsController.WalletTransactions), new { walletId });
    var backUrl = Model.BackUrl != null ? $""{Model.BackUrl}?returnUrl={Model.ReturnUrl}"" : null;
 var cancelUrl = Model.ReturnUrl ?? Url.Action(nameof(UIWalletsController.WalletTransactions), new { walletId });
 var backUrl = Model.BackUrl != null ? $""{Model.BackUrl}?returnUrl={Model.ReturnUrl}"" : null;
 var isReady = !Model.HasErrors;
 var isSignable = !isReady;
 var needsExport = !isSignable && !isReady;
 Layout = ""_LayoutWizard"";
 ViewData.SetActivePage(WalletsNavPages.PSBT, isReady ? ""Confirm broadcasting this transaction"" : ""Transaction Details"", walletId);
 Csp.UnsafeEval();
}

@section PageHeadContent {",,
https://huntr.dev/bounties/722c4b4b-af58-4d22-b302-125ce881a22f/,Account Takeover in alextselegidis/easyappointments,In this case i found that api endpoint Leaking password and username.,,CWE-213: Exposure of Sensitive Information Due to Incompatible Policies,https://www.github.com/alextselegidis/easyappointments/commit/6d413ffdfc076414baacd26a47f59eef051038da,"@@ -327,7 +327,11 @@ public function find(int $provider_id, bool $with_trashed = FALSE): array

        $provider['settings'] = $this->db->get_where('user_settings', ['id_users' => $provider_id])->row_array();

        unset($provider['settings']['id_users']);





        $service_provider_connections = $this->db->get_where('services_providers', ['id_users' => $provider_id])->result_array();


@@ -219,7 +219,11 @@ public function find(int $user_id, bool $with_trashed = FALSE): array

        $user['settings'] = $this->db->get_where('user_settings', ['id_users' => $user_id])->row_array();

        unset($user['settings']['id_users']);





        return $user;
    }
@@ -430,6 +434,14 @@ public function search(string $keyword, int $limit = NULL, int $offset = NULL, s
        foreach ($users as &$user)
        {
            $this->cast($user);








        }

        return $users;

","6
application/models/Providers_model.php
@@ -327,7 +327,11 @@ public function find(int $provider_id, bool $with_trashed = FALSE): array

        $provider['settings'] = $this->db->get_where('user_settings', ['id_users' => $provider_id])->row_array();

        unset($provider['settings']['id_users']);
        unset(
            $provider['settings']['id_users'],
            $provider['settings']['password'],
            $provider['settings']['salt'],
        );

        $service_provider_connections = $this->db->get_where('services_providers', ['id_users' => $provider_id])->result_array();

14
application/models/Users_model.php
@@ -219,7 +219,11 @@ public function find(int $user_id, bool $with_trashed = FALSE): array

        $user['settings'] = $this->db->get_where('user_settings', ['id_users' => $user_id])->row_array();

        unset($user['settings']['id_users']);
        unset(
            $user['settings']['id_users'],
            $user['settings']['password'],
            $user['settings']['salt'],
        );

        return $user;
    }
@@ -430,6 +434,14 @@ public function search(string $keyword, int $limit = NULL, int $offset = NULL, s
        foreach ($users as &$user)
        {
            $this->cast($user);

            $user['settings'] = $this->db->get_where('user_settings', ['id_users' => $user['id']])->row_array();

            unset(
                $user['settings']['id_users'],
                $user['settings']['password'],
                $user['settings']['salt']
            );
        }

        return $users;",,
https://huntr.dev/bounties/91c31eb6-024d-4ad3-88fe-f15b03fd20f5/,Default account creation on all installation methods in alextselegidis/easyappointments,The credentials of the administrator user (console installation) are set by default. Additionally in both the console installation and the gui installation a janedoe account is created with default credentials.,CVE-2023-1269,CWE-798: Use of Hard-coded Credentials,https://www.github.com/alextselegidis/easyappointments/commit/2731d2f17c5140c562426b857e9f5d63da5c4593,"@@ -55,9 +55,9 @@ public function install()
    {
        $this->instance->migrate('fresh');

        $this->instance->seed();

        response(PHP_EOL . '?Installation completed, login with ""administrator"" / ""administrator"".' . PHP_EOL . PHP_EOL);
    }

    /**

@@ -113,7 +113,7 @@ public function perform()
                ],
                'settings' => [
                    'username' => 'janedoe',
                    'password' => 'janedoe',
                    'working_plan' => setting('company_working_plan'),
                    'notifications' => TRUE,
                    'google_sync' => FALSE,

@@ -84,31 +84,38 @@ public function migrate(string $type = '')

    /**
     * Seed the database with test data.


     */
    public function seed()
    {
        // Settings

        setting([
            'company_name' => 'Company Name',
            'company_email' => 'info@example.org',
            'company_link' => 'https://example.org',
        ]);



        // Admin

        $this->CI->admins_model->save([
            'first_name' => 'John',
            'last_name' => 'Doe',
            'email' => 'john@example.org',
            'phone_number' => '+10000000000',
            'settings' => [
                'username' => 'administrator',
                'password' => 'administrator',
                'notifications' => TRUE,
                'calendar_view' => CALENDAR_VIEW_DEFAULT
            ],
        ]);

        // Service

        $service_id = $this->CI->services_model->save([
            'name' => 'Service',
            'duration' => '30',
@@ -119,6 +126,7 @@ public function seed()
        ]);

        // Provider

        $this->CI->providers_model->save([
            'first_name' => 'Jane',
            'last_name' => 'Doe',
@@ -129,7 +137,7 @@ public function seed()
            ],
            'settings' => [
                'username' => 'janedoe',
                'password' => 'janedoe',
                'working_plan' => setting('company_working_plan'),
                'notifications' => TRUE,
                'google_sync' => FALSE,
@@ -140,12 +148,15 @@ public function seed()
        ]);

        // Customer

        $this->CI->customers_model->save([
            'first_name' => 'James',
            'last_name' => 'Doe',
            'email' => 'james@example.org',
            'phone_number' => '+10000000000',
        ]);


    }

    /**

","4
application/controllers/Console.php
@@ -55,9 +55,9 @@ public function install()
    {
        $this->instance->migrate('fresh');

        $this->instance->seed();
        $password = $this->instance->seed();

        response(PHP_EOL . '?Installation completed, login with ""administrator"" / ""administrator"".' . PHP_EOL . PHP_EOL);
        response(PHP_EOL . '?Installation completed, login with ""administrator"" / ""' . $password . '"".' . PHP_EOL . PHP_EOL);
    }

    /**
2
application/controllers/Installation.php
@@ -113,7 +113,7 @@ public function perform()
                ],
                'settings' => [
                    'username' => 'janedoe',
                    'password' => 'janedoe',
                    'password' => random_string(),
                    'working_plan' => setting('company_working_plan'),
                    'notifications' => TRUE,
                    'google_sync' => FALSE,
17
application/libraries/Instance.php
@@ -84,31 +84,38 @@ public function migrate(string $type = '')

    /**
     * Seed the database with test data.
     *
     * @return string Return's the administrator user password.
     */
    public function seed()
    public function seed(): string
    {
        // Settings

        setting([
            'company_name' => 'Company Name',
            'company_email' => 'info@example.org',
            'company_link' => 'https://example.org',
        ]);

        $password = random_string();

        // Admin

        $this->CI->admins_model->save([
            'first_name' => 'John',
            'last_name' => 'Doe',
            'email' => 'john@example.org',
            'phone_number' => '+10000000000',
            'settings' => [
                'username' => 'administrator',
                'password' => 'administrator',
                'password' => $password,
                'notifications' => TRUE,
                'calendar_view' => CALENDAR_VIEW_DEFAULT
            ],
        ]);

        // Service

        $service_id = $this->CI->services_model->save([
            'name' => 'Service',
            'duration' => '30',
@@ -119,6 +126,7 @@ public function seed()
        ]);

        // Provider

        $this->CI->providers_model->save([
            'first_name' => 'Jane',
            'last_name' => 'Doe',
@@ -129,7 +137,7 @@ public function seed()
            ],
            'settings' => [
                'username' => 'janedoe',
                'password' => 'janedoe',
                'password' => random_string(),
                'working_plan' => setting('company_working_plan'),
                'notifications' => TRUE,
                'google_sync' => FALSE,
@@ -140,12 +148,15 @@ public function seed()
        ]);

        // Customer

        $this->CI->customers_model->save([
            'first_name' => 'James',
            'last_name' => 'Doe',
            'email' => 'james@example.org',
            'phone_number' => '+10000000000',
        ]);

        return $password;
    }

    /**",,
https://huntr.dev/bounties/bc00ac25-7fc7-46ed-b38e-51328d1595bb/,UI REDRESSING in alextselegidis/easyappointments,"The web application does not restrict or incorrectly restricts frame objects or UI layers that belong to another application or domain, which can lead to user confusion about which interface the user is interacting with.",,CWE-1021: Improper Restriction of Rendered UI Layers or Frames,https://www.github.com/alextselegidis/easyappointments/commit/f3a3fb047ef01286da31e92c5ab2c258135407d2,"@@ -57,6 +57,22 @@

$route['translate_uri_dashes'] = FALSE;

















/*
| -------------------------------------------------------------------------
| CORS HEADERS

","16
application/config/routes.php
@@ -57,6 +57,22 @@

$route['translate_uri_dashes'] = FALSE;

/*
| -------------------------------------------------------------------------
| FRAME OPTIONS HEADERS
| -------------------------------------------------------------------------
| Set the appropriate headers so that iframe control and permissions are 
| properly configured.
|
| Options:
|
|   - DENY 
|   - SAMEORIGIN 
|
*/

header('X-Frame-Options: SAMEORIGIN');

/*
| -------------------------------------------------------------------------
| CORS HEADERS",,
https://huntr.dev/bounties/b2989095-88f3-413a-9a39-c1c58a6e6815/,NULL Pointer Dereference in function utfc_ptr2len in vim/vim,NULL Pointer Dereference in function utfc_ptr2len at mbyte.c.c:2145 allows attackers to cause a denial of service (application crash) via a crafted input.,CVE-2023-1264,CWE-476: NULL Pointer Dereference,https://www.github.com/vim/vim/commit/7ac5023a5f1a37baafbe1043645f97ba3443d9f6,"@@ -3107,7 +3107,7 @@ check_end_reg_executing(int advance)
    static int
vgetorpeek(int advance)
{
    int  c, c1;
    int  timedout = FALSE; // waited for more than 'timeoutlen'
     // for mapping to complete or
     // 'ttimeoutlen' for complete key code
@@ -3474,7 +3474,7 @@ vgetorpeek(int advance)
   * to the user with showcmd.
   */
  showcmd_idx = 0;
  c1 = 0;
  if (typebuf.tb_len > 0 && advance && !exmode_active)
  {
      if (((State & (MODE_NORMAL | MODE_INSERT))
@@ -3489,7 +3489,7 @@ vgetorpeek(int advance)
       edit_putchar(typebuf.tb_buf[typebuf.tb_off
      + typebuf.tb_len - 1], FALSE);
       setcursor(); // put cursor back where it belongs
       c1 = 1;
   }
   // need to use the col and row from above here
   old_wcol = curwin->w_wcol;
@@ -3506,8 +3506,10 @@ vgetorpeek(int advance)
   curwin->w_wrow = old_wrow;
      }

      // this looks nice when typing a dead character map

      if ((State & MODE_CMDLINE)

#if defined(FEAT_CRYPT) || defined(FEAT_EVAL)
       && cmdline_star == 0
#endif
@@ -3516,7 +3518,7 @@ vgetorpeek(int advance)
      {
   putcmdline(typebuf.tb_buf[typebuf.tb_off
      + typebuf.tb_len - 1], FALSE);
   c1 = 1;
      }
  }

@@ -3550,11 +3552,12 @@ vgetorpeek(int advance)

  if (showcmd_idx != 0)
      pop_showcmd();
  if (c1 == 1)
  {
      if (State & MODE_INSERT)
   edit_unputchar();
      if (State & MODE_CMDLINE)

   unputcmdline();
      else
   setcursor(); // put cursor back where it belongs

@@ -55,6 +55,7 @@ endfunc
"" ""cols"" - width of the terminal window (max. 78)
"" ""statusoff"" - number of lines the status is offset from default
"" ""wait_for_ruler"" - if zero then don't wait for ruler to show

func RunVimInTerminal(arguments, options)
  "" If Vim doesn't exit a swap file remains, causing other tests to fail.
  "" Remove it here.
@@ -91,6 +92,10 @@ func RunVimInTerminal(arguments, options)

  let cmd = GetVimCommandCleanTerm() .. reset_u7 .. a:arguments





  let options = #{curwin: 1}
  if &termwinsize == ''
    let options.term_rows = rows

@@ -134,6 +134,28 @@ func Test_open_command_flush_line()
  bwipe!
endfunc























"" Test for :g/pat/visual to run vi commands in Ex mode
"" This used to hang Vim before 8.2.0274.
func Test_Ex_global()

@@ -695,6 +695,8 @@ static char *(features[]) =

static int included_patches[] =
{   /* Add new patch number below this line */


/**/
    1391,
/**/

","17
src/getchar.c
@@ -3107,7 +3107,7 @@ check_end_reg_executing(int advance)
    static int
vgetorpeek(int advance)
{
    int  c, c1;
    int  c;
    int  timedout = FALSE; // waited for more than 'timeoutlen'
     // for mapping to complete or
     // 'ttimeoutlen' for complete key code
@@ -3474,7 +3474,7 @@ vgetorpeek(int advance)
   * to the user with showcmd.
   */
  showcmd_idx = 0;
  c1 = 0;
  int showing_partial = FALSE;
  if (typebuf.tb_len > 0 && advance && !exmode_active)
  {
      if (((State & (MODE_NORMAL | MODE_INSERT))
@@ -3489,7 +3489,7 @@ vgetorpeek(int advance)
       edit_putchar(typebuf.tb_buf[typebuf.tb_off
      + typebuf.tb_len - 1], FALSE);
       setcursor(); // put cursor back where it belongs
       c1 = 1;
       showing_partial = TRUE;
   }
   // need to use the col and row from above here
   old_wcol = curwin->w_wcol;
@@ -3506,8 +3506,10 @@ vgetorpeek(int advance)
   curwin->w_wrow = old_wrow;
      }

      // this looks nice when typing a dead character map
      // This looks nice when typing a dead character map.
      // There is no actual command line for get_number().
      if ((State & MODE_CMDLINE)
       && get_cmdline_info()->cmdbuff != NULL
#if defined(FEAT_CRYPT) || defined(FEAT_EVAL)
       && cmdline_star == 0
#endif
@@ -3516,7 +3518,7 @@ vgetorpeek(int advance)
      {
   putcmdline(typebuf.tb_buf[typebuf.tb_off
      + typebuf.tb_len - 1], FALSE);
   c1 = 1;
   showing_partial = TRUE;
      }
  }

@@ -3550,11 +3552,12 @@ vgetorpeek(int advance)

  if (showcmd_idx != 0)
      pop_showcmd();
  if (c1 == 1)
  if (showing_partial)
  {
      if (State & MODE_INSERT)
   edit_unputchar();
      if (State & MODE_CMDLINE)
      if ((State & MODE_CMDLINE)
     && get_cmdline_info()->cmdbuff != NULL)
   unputcmdline();
      else
   setcursor(); // put cursor back where it belongs
5
src/testdir/term_util.vim
@@ -55,6 +55,7 @@ endfunc
"" ""cols"" - width of the terminal window (max. 78)
"" ""statusoff"" - number of lines the status is offset from default
"" ""wait_for_ruler"" - if zero then don't wait for ruler to show
"" ""no_clean"" - if non-zero then remove ""--clean"" from the command
func RunVimInTerminal(arguments, options)
  "" If Vim doesn't exit a swap file remains, causing other tests to fail.
  "" Remove it here.
@@ -91,6 +92,10 @@ func RunVimInTerminal(arguments, options)

  let cmd = GetVimCommandCleanTerm() .. reset_u7 .. a:arguments

  if get(a:options, 'no_clean', 0)
    let cmd = substitute(cmd, '--clean', '', '')
  endif

  let options = #{curwin: 1}
  if &termwinsize == ''
    let options.term_rows = rows
22
src/testdir/test_ex_mode.vim
@@ -134,6 +134,28 @@ func Test_open_command_flush_line()
  bwipe!
endfunc

"" FIXME: this doesn't fail without the fix but hangs
func Skip_Test_open_command_state()
  "" Tricky script that failed because State was not set properly
  let lines =<< trim END
      !ls 
      0sci
      so! Xsourced
      set t_0=0
      v/-/o
  END
  call writefile(lines, 'XopenScript', '')

  let sourced = [""!f\u0083\x02\<Esc>z=0""]
  call writefile(sourced, 'Xsourced', 'b')

  CheckRunVimInTerminal
  let buf = RunVimInTerminal('-u NONE -i NONE -n -m -X -Z -e -s -S XopenScript -c qa!', #{rows: 6, wait_for_ruler: 0, no_clean: 1})
  sleep 3

  call StopVimInTerminal(buf)
endfunc

"" Test for :g/pat/visual to run vi commands in Ex mode
"" This used to hang Vim before 8.2.0274.
func Test_Ex_global()
2
src/version.c
@@ -695,6 +695,8 @@ static char *(features[]) =

static int included_patches[] =
{   /* Add new patch number below this line */
/**/
    1392,
/**/
    1391,
/**/",,
https://huntr.dev/bounties/04447124-c7d4-477f-8364-91fe5b59cda0/,XSS in HTML-Tags in pimcore/pimcore,Cross site scripting vulnerability in pimcore/pimcore in HTML-Tags of "SEO & Settings",CVE-2023-1247,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/pimcore/pimcore/commit/da2af2d413b144b9a742118124457d13232d31fd,"@@ -21,75 +21,6 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac

        if (this.layout == null) {

            /**
             * @deprecated 10.6 Will be removed in 11.
             */
            // meta-data
            var addMetaData = function (value) {
                console.warn('Setting/Editing the `HTML-tags` field is deprecated');
                if(typeof value != ""string"") {
                    value = """";
                }

                var count = this.metaDataPanel.query(""button"").length+1;

                var compositeField = new Ext.form.FieldContainer({
                    layout: 'hbox',
                    hideLabel: true,
                    items: [{
                        xtype: ""textfield"",
                        value: value,
                        width: 636,
                        name: ""metadata_"" + count,
                    }]
                });

                compositeField.add({
                    xtype: ""button"",
                    iconCls: ""pimcore_icon_delete"",
                    handler: function (compositeField, el) {
                        this.metaDataPanel.remove(compositeField);
                        this.metaDataPanel.updateLayout();
                    }.bind(this, compositeField)
                });

                this.metaDataPanel.add(compositeField);
                this.metaDataPanel.updateLayout();
            }.bind(this);

            var user = pimcore.globalmanager.get(""user"");
            if (user.admin) {
                /**
                 * @deprecated 10.6 Will be removed in 11.
                 */
                this.metaDataPanel = new Ext.form.FieldSet({
                    title: t(""html_tags"") + "" (&lt;meta .../&gt; &lt;link .../&gt; ...) (Deprecated)"",
                    collapsible: false,
                    autoHeight: true,
                    width: 700,
                    style: ""margin-top: 20px;"",
                    items: [{
                        xtype: ""toolbar"",
                        style: ""margin-bottom: 10px;"",
                        items: [""->"", {
                            xtype: 'button',
                            iconCls: ""pimcore_icon_add"",
                            handler: addMetaData
                        }]
                    }]
                });

                try {
                    if (typeof this.document.data.metaData == ""object"" && this.document.data.metaData.length > 0) {
                        for (var r = 0; r < this.document.data.metaData.length; r++) {
                            addMetaData(this.document.data.metaData[r]);
                        }
                    }
                } catch (e) {
                }
            }


            var updateSerpPreview = function () {

                var metaPanel = this.layout.getComponent(""metaDataPanel"");
@@ -144,7 +75,7 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac
                items: [
                    {
                        xtype:'fieldset',
                        title: t('title') + "", "" + t(""description"") + "" & "" + t('metadata'),
                        itemId: ""metaDataPanel"",
                        collapsible: true,
                        autoHeight:true,
@@ -185,7 +116,6 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac
                                    }
                                }
                            },
                            this.metaDataPanel,
                            {
                                xtype: ""container"",
                                itemId: ""serpPreview"",

@@ -148,17 +148,6 @@ public function saveAction(Request $request, StaticPageGenerator $staticPageGene
            }
        }

        // check if settings exist, before saving meta data
        if ($request->get('settings') && is_array($settings)) {
            $metaData = [];
            for ($i = 1; $i < 30; $i++) {
                if (array_key_exists('metadata_' . $i, $settings)) {
                    $metaData[] = $settings['metadata_' . $i];
                }
            }
            $page->setMetaData($metaData);
        }

        list($task, $page, $version) = $this->saveDocument($page, $request);
        $arguments = [
            'oldPage' => $oldPage,

@@ -53,9 +53,6 @@ services:
        calls:
            - [setLogger, ['@logger']]

    # Adds Meta Data entries of document to HeadMeta view helper
    Pimcore\Bundle\CoreBundle\EventListener\Frontend\DocumentMetaDataListener: ~

    Pimcore\Bundle\CoreBundle\EventListener\Frontend\DocumentRendererListener: ~
    Pimcore\Bundle\CoreBundle\EventListener\Frontend\StaticPageGeneratorListener: ~


@@ -0,0 +1,32 @@
































@@ -165,7 +165,6 @@ CREATE TABLE `documents_page` (
  `template` varchar(255) DEFAULT NULL,
  `title` varchar(255) DEFAULT NULL,
  `description` varchar(383) DEFAULT NULL,
  `metaData` text,
  `prettyUrl` varchar(255) DEFAULT NULL,
  `contentMasterDocumentId` int(11) DEFAULT NULL,
  `targetGroupIds` varchar(255) NOT NULL DEFAULT '',

@@ -27,4 +27,5 @@
class Dao extends Model\Document\Page\Dao implements TargetingDocumentDaoInterface
{
    use TargetingDocumentDaoTrait;

}
@@ -223,6 +223,7 @@ pimcore_seo:
        auto_create_redirects: true
```
- [DataObject] Added new helper inheritance helper function `DataObject\Serivce::useInheritedValues`



## 10.6.0

@@ -41,13 +41,6 @@ class Page extends PageSnippet
     */
    protected string $description = '';

    /**
     * @internal
     *
     * @var array
     */
    protected array $metaData = [];

    /**
     * {@inheritdoc}
     */
@@ -84,38 +77,6 @@ public function setTitle(string $title): static
        return $this;
    }

    /**
     * @deprecated
     *
     * @return $this
     */
    public function setMetaData(array $metaData): static
    {
        trigger_deprecation(
            'pimcore/pimcore',
            '10.6.0',
            sprintf('%s is deprecated and will be removed in Pimcore 11.', __METHOD__)
        );

        $this->metaData = $metaData;

        return $this;
    }

    /**
     * @deprecated
     */
    public function getMetaData(): array
    {
        trigger_deprecation(
            'pimcore/pimcore',
            '10.6.0',
            sprintf('%s is deprecated and will be removed in Pimcore 11.', __METHOD__)
        );

        return $this->metaData;
    }

    public function getFullPath(bool $force = false): string
    {
        $path = parent::getFullPath($force);

@@ -43,12 +43,7 @@ public function getById(int $id = null): void
                WHERE documents.id = ?"", [$this->model->getId()]);

        if (!empty($data['id'])) {
            if (is_string($data['metaData'])) {
                $data['metaData'] = @unserialize($data['metaData']);
            }
            if (!is_array($data['metaData'])) {
                $data['metaData'] = [];
            }
            $this->assignVariablesToModel($data);
        } else {
            throw new Model\Exception\NotFoundException('Page with the ID ' . $this->model->getId() . "" doesn't exists"");

","72
bundles/AdminBundle/public/js/pimcore/document/pages/settings.js
@@ -21,75 +21,6 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac

        if (this.layout == null) {

            /**
             * @deprecated 10.6 Will be removed in 11.
             */
            // meta-data
            var addMetaData = function (value) {
                console.warn('Setting/Editing the `HTML-tags` field is deprecated');
                if(typeof value != ""string"") {
                    value = """";
                }

                var count = this.metaDataPanel.query(""button"").length+1;

                var compositeField = new Ext.form.FieldContainer({
                    layout: 'hbox',
                    hideLabel: true,
                    items: [{
                        xtype: ""textfield"",
                        value: value,
                        width: 636,
                        name: ""metadata_"" + count,
                    }]
                });

                compositeField.add({
                    xtype: ""button"",
                    iconCls: ""pimcore_icon_delete"",
                    handler: function (compositeField, el) {
                        this.metaDataPanel.remove(compositeField);
                        this.metaDataPanel.updateLayout();
                    }.bind(this, compositeField)
                });

                this.metaDataPanel.add(compositeField);
                this.metaDataPanel.updateLayout();
            }.bind(this);

            var user = pimcore.globalmanager.get(""user"");
            if (user.admin) {
                /**
                 * @deprecated 10.6 Will be removed in 11.
                 */
                this.metaDataPanel = new Ext.form.FieldSet({
                    title: t(""html_tags"") + "" (&lt;meta .../&gt; &lt;link .../&gt; ...) (Deprecated)"",
                    collapsible: false,
                    autoHeight: true,
                    width: 700,
                    style: ""margin-top: 20px;"",
                    items: [{
                        xtype: ""toolbar"",
                        style: ""margin-bottom: 10px;"",
                        items: [""->"", {
                            xtype: 'button',
                            iconCls: ""pimcore_icon_add"",
                            handler: addMetaData
                        }]
                    }]
                });

                try {
                    if (typeof this.document.data.metaData == ""object"" && this.document.data.metaData.length > 0) {
                        for (var r = 0; r < this.document.data.metaData.length; r++) {
                            addMetaData(this.document.data.metaData[r]);
                        }
                    }
                } catch (e) {
                }
            }


            var updateSerpPreview = function () {

                var metaPanel = this.layout.getComponent(""metaDataPanel"");
@@ -144,7 +75,7 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac
                items: [
                    {
                        xtype:'fieldset',
                        title: t('title') + "", "" + t(""description"") + "" & "" + t('metadata'),
                        title: t('title') + "" & "" + t(""description""),
                        itemId: ""metaDataPanel"",
                        collapsible: true,
                        autoHeight:true,
@@ -185,7 +116,6 @@ pimcore.document.pages.settings = Class.create(pimcore.document.settings_abstrac
                                    }
                                }
                            },
                            this.metaDataPanel,
                            {
                                xtype: ""container"",
                                itemId: ""serpPreview"",
11
bundles/AdminBundle/src/Controller/Admin/Document/PageController.php
@@ -148,17 +148,6 @@ public function saveAction(Request $request, StaticPageGenerator $staticPageGene
            }
        }

        // check if settings exist, before saving meta data
        if ($request->get('settings') && is_array($settings)) {
            $metaData = [];
            for ($i = 1; $i < 30; $i++) {
                if (array_key_exists('metadata_' . $i, $settings)) {
                    $metaData[] = $settings['metadata_' . $i];
                }
            }
            $page->setMetaData($metaData);
        }

        list($task, $page, $version) = $this->saveDocument($page, $request);
        $arguments = [
            'oldPage' => $oldPage,
3
bundles/CoreBundle/config/event_listeners.yaml
@@ -53,9 +53,6 @@ services:
        calls:
            - [setLogger, ['@logger']]

    # Adds Meta Data entries of document to HeadMeta view helper
    Pimcore\Bundle\CoreBundle\EventListener\Frontend\DocumentMetaDataListener: ~

    Pimcore\Bundle\CoreBundle\EventListener\Frontend\DocumentRendererListener: ~
    Pimcore\Bundle\CoreBundle\EventListener\Frontend\StaticPageGeneratorListener: ~

82
bundles/CoreBundle/src/EventListener/Frontend/DocumentMetaDataListener.php
Load diff
This file was deleted.
32
bundles/CoreBundle/src/Migrations/Version20230222174636.php
@@ -0,0 +1,32 @@
<?php

declare(strict_types=1);

namespace Pimcore\Bundle\CoreBundle\Migrations;

use Doctrine\DBAL\Schema\Schema;
use Doctrine\Migrations\AbstractMigration;

final class Version20230222174636 extends AbstractMigration
{
    public function getDescription(): string
    {
        return '';
    }

    public function up(Schema $schema): void
    {
        if($schema->getTable('documents_page')->hasColumn('metaData')) {
            $this->addSql('ALTER TABLE documents_page DROP COLUMN metaData');
        }

    }

    public function down(Schema $schema): void
    {
        if(!$schema->getTable('documents_page')->hasColumn('metaData')) {
                $this->addSql('ALTER TABLE documents_page ADD COLUMN `metaData` TEXT AFTER `description`');
        }

    }
}
1
bundles/InstallBundle/dump/install.sql
@@ -165,7 +165,6 @@ CREATE TABLE `documents_page` (
  `template` varchar(255) DEFAULT NULL,
  `title` varchar(255) DEFAULT NULL,
  `description` varchar(383) DEFAULT NULL,
  `metaData` text,
  `prettyUrl` varchar(255) DEFAULT NULL,
  `contentMasterDocumentId` int(11) DEFAULT NULL,
  `targetGroupIds` varchar(255) NOT NULL DEFAULT '',
1
bundles/PersonalizationBundle/src/Model/Document/Page/Dao.php
@@ -27,4 +27,5 @@
class Dao extends Model\Document\Page\Dao implements TargetingDocumentDaoInterface
{
    use TargetingDocumentDaoTrait;

}
1
...evelopment_Documentation/23_Installation_and_Upgrade/09_Upgrade_Notes/README.md
@@ -223,6 +223,7 @@ pimcore_seo:
        auto_create_redirects: true
```
- [DataObject] Added new helper inheritance helper function `DataObject\Serivce::useInheritedValues`
- [Page] Removed the functionality to input `metadata` html tags in Settings section of the document.


## 10.6.0
39
models/Document/Page.php
@@ -41,13 +41,6 @@ class Page extends PageSnippet
     */
    protected string $description = '';

    /**
     * @internal
     *
     * @var array
     */
    protected array $metaData = [];

    /**
     * {@inheritdoc}
     */
@@ -84,38 +77,6 @@ public function setTitle(string $title): static
        return $this;
    }

    /**
     * @deprecated
     *
     * @return $this
     */
    public function setMetaData(array $metaData): static
    {
        trigger_deprecation(
            'pimcore/pimcore',
            '10.6.0',
            sprintf('%s is deprecated and will be removed in Pimcore 11.', __METHOD__)
        );

        $this->metaData = $metaData;

        return $this;
    }

    /**
     * @deprecated
     */
    public function getMetaData(): array
    {
        trigger_deprecation(
            'pimcore/pimcore',
            '10.6.0',
            sprintf('%s is deprecated and will be removed in Pimcore 11.', __METHOD__)
        );

        return $this->metaData;
    }

    public function getFullPath(bool $force = false): string
    {
        $path = parent::getFullPath($force);
7
models/Document/Page/Dao.php
@@ -43,12 +43,7 @@ public function getById(int $id = null): void
                WHERE documents.id = ?"", [$this->model->getId()]);

        if (!empty($data['id'])) {
            if (is_string($data['metaData'])) {
                $data['metaData'] = @unserialize($data['metaData']);
            }
            if (!is_array($data['metaData'])) {
                $data['metaData'] = [];
            }

            $this->assignVariablesToModel($data);
        } else {
            throw new Model\Exception\NotFoundException('Page with the ID ' . $this->model->getId() . "" doesn't exists"");",,
https://huntr.dev/bounties/f8011bb3-8212-4937-aa58-79f4b73be004/,XSS in answerdev/answer,HTML injection in user profile,CVE-2023-1245,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/71a4cdac81112975969129d308899edd155c0e80,"@@ -309,7 +309,7 @@ func (req *UpdateInfoRequest) Check() (errFields []*validator.FormErrorField, er
   return errFields, errors.BadRequest(reason.UsernameInvalid)
  }
 }
 req.BioHTML = converter.Markdown2HTML(req.Bio)
 return nil, nil
}


@@ -35,6 +35,17 @@ func Markdown2HTML(source string) string {
 return buf.String()
}












type DangerousHTMLFilterExtension struct {
}


","2
internal/schema/user_schema.go
@@ -309,7 +309,7 @@ func (req *UpdateInfoRequest) Check() (errFields []*validator.FormErrorField, er
   return errFields, errors.BadRequest(reason.UsernameInvalid)
  }
 }
 req.BioHTML = converter.Markdown2HTML(req.Bio)
 req.BioHTML = converter.Markdown2BasicHTML(req.Bio)
 return nil, nil
}

11
pkg/converter/markdown.go
@@ -35,6 +35,17 @@ func Markdown2HTML(source string) string {
 return buf.String()
}

// Markdown2BasicHTML convert markdown to html ,Only basic syntax can be used
func Markdown2BasicHTML(source string) string {
 content := Markdown2HTML(source)
 filter := bluemonday.NewPolicy()
 filter.AllowElements(""p"", ""b"", ""br"")
 filter.AllowAttrs(""src"").OnElements(""img"")
 filter.AddSpaceWhenStrippingTag(true)
 content = filter.Sanitize(content)
 return content
}

type DangerousHTMLFilterExtension struct {
}",,
https://huntr.dev/bounties/bcab9555-8a35-42b2-a7de-0a79fd710b52/,Stored XSS in Sitename in answerdev/answer,"There is a presence of stored xss in username, which directly gets rendered whenever the page is opened.",CVE-2023-1244,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/9870ed87fb24ed468aaf1e169c2d028e0f375106,"@@ -78,7 +78,7 @@ type InitEnvironmentResp struct {
// InitBaseInfoReq init base info request
type InitBaseInfoReq struct {
 Language      string `validate:""required,gt=0,lte=30"" json:""lang""`
 SiteName      string `validate:""required,gt=0,lte=30"" json:""site_name""`
 SiteURL       string `validate:""required,gt=0,lte=512,url"" json:""site_url""`
 ContactEmail  string `validate:""required,email,gt=0,lte=500"" json:""contact_email""`
 AdminName     string `validate:""required,gt=3,lte=30"" json:""name""`

","2
internal/install/install_req.go
@@ -78,7 +78,7 @@ type InitEnvironmentResp struct {
// InitBaseInfoReq init base info request
type InitBaseInfoReq struct {
 Language      string `validate:""required,gt=0,lte=30"" json:""lang""`
 SiteName      string `validate:""required,gt=0,lte=30"" json:""site_name""`
 SiteName      string `validate:""required,sanitizer,gt=0,lte=30"" json:""site_name""`
 SiteURL       string `validate:""required,gt=0,lte=512,url"" json:""site_url""`
 ContactEmail  string `validate:""required,email,gt=0,lte=500"" json:""contact_email""`
 AdminName     string `validate:""required,gt=3,lte=30"" json:""name""`",,
https://huntr.dev/bounties/1d62d35a-b096-4b76-a021-347c3f1c570c/,Stored XSS in answerdev/answer,"answer has a feature to customize the ""Site Name"" during installation or in the settings page , due to a bad sanitization it allows to put arbitrary html code which allows to execute javascript code.",CVE-2023-1243,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/9870ed87fb24ed468aaf1e169c2d028e0f375106,"@@ -78,7 +78,7 @@ type InitEnvironmentResp struct {
// InitBaseInfoReq init base info request
type InitBaseInfoReq struct {
 Language      string `validate:""required,gt=0,lte=30"" json:""lang""`
 SiteName      string `validate:""required,gt=0,lte=30"" json:""site_name""`
 SiteURL       string `validate:""required,gt=0,lte=512,url"" json:""site_url""`
 ContactEmail  string `validate:""required,email,gt=0,lte=500"" json:""contact_email""`
 AdminName     string `validate:""required,gt=3,lte=30"" json:""name""`

","2
internal/install/install_req.go
@@ -78,7 +78,7 @@ type InitEnvironmentResp struct {
// InitBaseInfoReq init base info request
type InitBaseInfoReq struct {
 Language      string `validate:""required,gt=0,lte=30"" json:""lang""`
 SiteName      string `validate:""required,gt=0,lte=30"" json:""site_name""`
 SiteName      string `validate:""required,sanitizer,gt=0,lte=30"" json:""site_name""`
 SiteURL       string `validate:""required,gt=0,lte=512,url"" json:""site_url""`
 ContactEmail  string `validate:""required,email,gt=0,lte=500"" json:""contact_email""`
 AdminName     string `validate:""required,gt=3,lte=30"" json:""name""`",,
https://huntr.dev/bounties/71c24c5e-ceb2-45cf-bda7-fa195d37e289/,Store XSS in Question Tag in answerdev/answer,"Attackers can use this vulnerability to attack users/admins in the community, take over user/admins accounts, etc...",CVE-2023-1242,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/90bfa0dcc7b49482f1d1e31aee3ab073f3c13dd9,"@@ -90,7 +90,7 @@ type GetTagResp struct {
}

func (tr *GetTagResp) GetExcerpt() {
 excerpt := strings.TrimSpace(tr.OriginalText)
 idx := strings.Index(excerpt, ""\n"")
 if idx >= 0 {
  excerpt = excerpt[0:idx]

","2
internal/schema/tag_schema.go
@@ -90,7 +90,7 @@ type GetTagResp struct {
}

func (tr *GetTagResp) GetExcerpt() {
 excerpt := strings.TrimSpace(tr.OriginalText)
 excerpt := strings.TrimSpace(tr.ParsedText)
 idx := strings.Index(excerpt, ""\n"")
 if idx >= 0 {
  excerpt = excerpt[0:idx]",,
https://huntr.dev/bounties/e0e9b1bb-3025-4b9f-acb4-16a5da28aa3c/,Stored XSS on Tag in answerdev/answer,"Evil users can attack other users or administrator users through this vulnerability, causing other users/administrator user accounts to be taken over",CVE-2023-1241,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/90bfa0dcc7b49482f1d1e31aee3ab073f3c13dd9,"@@ -90,7 +90,7 @@ type GetTagResp struct {
}

func (tr *GetTagResp) GetExcerpt() {
 excerpt := strings.TrimSpace(tr.OriginalText)
 idx := strings.Index(excerpt, ""\n"")
 if idx >= 0 {
  excerpt = excerpt[0:idx]

","2
internal/schema/tag_schema.go
@@ -90,7 +90,7 @@ type GetTagResp struct {
}

func (tr *GetTagResp) GetExcerpt() {
 excerpt := strings.TrimSpace(tr.OriginalText)
 excerpt := strings.TrimSpace(tr.ParsedText)
 idx := strings.Index(excerpt, ""\n"")
 if idx >= 0 {
  excerpt = excerpt[0:idx]",,
https://huntr.dev/bounties/a24f57a4-22e3-4a17-8227-6a410a11498a/,Stored DOM-based Cross-site Scripting in Tags Functionality in answerdev/answer,"A stored, DOM-based cross-site scripting vulnerability exists in answer version 1.0.4 within the question tagging functionality.",CVE-2023-1240,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/90bfa0dcc7b49482f1d1e31aee3ab073f3c13dd9,"@@ -90,7 +90,7 @@ type GetTagResp struct {
}

func (tr *GetTagResp) GetExcerpt() {
 excerpt := strings.TrimSpace(tr.OriginalText)
 idx := strings.Index(excerpt, ""\n"")
 if idx >= 0 {
  excerpt = excerpt[0:idx]

","2
internal/schema/tag_schema.go
@@ -90,7 +90,7 @@ type GetTagResp struct {
}

func (tr *GetTagResp) GetExcerpt() {
 excerpt := strings.TrimSpace(tr.OriginalText)
 excerpt := strings.TrimSpace(tr.ParsedText)
 idx := strings.Index(excerpt, ""\n"")
 if idx >= 0 {
  excerpt = excerpt[0:idx]",,
https://huntr.dev/bounties/3a22c609-d2d8-4613-815d-58f5990b8bd8/,Stored XSS in Site Name in answerdev/answer,Stored Cross-site Scripting (XSS) vulnerability in Site name of answerdev/answer,CVE-2023-1239,CWE-79: Cross-site Scripting (XSS) - Reflected,https://www.github.com/answerdev/answer/commit/9870ed87fb24ed468aaf1e169c2d028e0f375106,"@@ -78,7 +78,7 @@ type InitEnvironmentResp struct {
// InitBaseInfoReq init base info request
type InitBaseInfoReq struct {
 Language      string `validate:""required,gt=0,lte=30"" json:""lang""`
 SiteName      string `validate:""required,gt=0,lte=30"" json:""site_name""`
 SiteURL       string `validate:""required,gt=0,lte=512,url"" json:""site_url""`
 ContactEmail  string `validate:""required,email,gt=0,lte=500"" json:""contact_email""`
 AdminName     string `validate:""required,gt=3,lte=30"" json:""name""`

","2
internal/install/install_req.go
@@ -78,7 +78,7 @@ type InitEnvironmentResp struct {
// InitBaseInfoReq init base info request
type InitBaseInfoReq struct {
 Language      string `validate:""required,gt=0,lte=30"" json:""lang""`
 SiteName      string `validate:""required,gt=0,lte=30"" json:""site_name""`
 SiteName      string `validate:""required,sanitizer,gt=0,lte=30"" json:""site_name""`
 SiteURL       string `validate:""required,gt=0,lte=512,url"" json:""site_url""`
 ContactEmail  string `validate:""required,email,gt=0,lte=500"" json:""contact_email""`
 AdminName     string `validate:""required,gt=3,lte=30"" json:""name""`",,
https://huntr.dev/bounties/52f97267-1439-4bb6-862b-89b8fafce50d/,Stored XSS Bypass While add a new Comment in answerdev/answer,"Stored XSS bypass in add comments function if you try to inject XSS payload like <img src=x onerror=alert(1)> that won't work ,So I found a bypass that able to bypass cloudflare with the following payload <img only=1 src=x onerror=alert()> or <img xthemo=1 src=x onerror=alert(1)> and click enter to add newline and click ""add comment""",CVE-2023-1238,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/0566894a2c0e13cf07d877f41467e2e21529fee8,"@@ -5,7 +5,6 @@ import { Link } from 'react-router-dom';

import classNames from 'classnames';
import { unionBy } from 'lodash';
import { marked } from 'marked';

import * as Types from '@/common/interface';
import { Modal } from '@/components';
@@ -108,15 +107,11 @@ const Comment = ({ objectId, mode, commentId }) => {
    const users = matchedUsers(item.value);
    const userNames = unionBy(users.map((user) => user.userName));
    const commentMarkDown = parseUserInfo(item.value);
    const html = marked.parse(commentMarkDown);
    // if (!commentMarkDown || !html) {
    //   return;
    // }
    const params = {
      object_id: objectId,
      original_text: commentMarkDown,
      mention_username_list: userNames,
      parsed_text: html,
      ...(item.type === 'reply'
        ? {
            reply_comment_id: item.comment_id,
@@ -128,13 +123,13 @@ const Comment = ({ objectId, mode, commentId }) => {
      return updateComment({
        ...params,
        comment_id: item.comment_id,
      }).then(() => {
        setComments(
          comments.map((comment) => {
            if (comment.comment_id === item.comment_id) {
              comment.showEdit = false;
              comment.parsed_text = html;
              comment.original_text = item.value;
            }
            return comment;
          }),

","13
ui/src/components/Comment/index.tsx
@@ -5,7 +5,6 @@ import { Link } from 'react-router-dom';

import classNames from 'classnames';
import { unionBy } from 'lodash';
import { marked } from 'marked';

import * as Types from '@/common/interface';
import { Modal } from '@/components';
@@ -108,15 +107,11 @@ const Comment = ({ objectId, mode, commentId }) => {
    const users = matchedUsers(item.value);
    const userNames = unionBy(users.map((user) => user.userName));
    const commentMarkDown = parseUserInfo(item.value);
    const html = marked.parse(commentMarkDown);
    // if (!commentMarkDown || !html) {
    //   return;
    // }

    const params = {
      object_id: objectId,
      original_text: commentMarkDown,
      mention_username_list: userNames,
      parsed_text: html,
      ...(item.type === 'reply'
        ? {
            reply_comment_id: item.comment_id,
@@ -128,13 +123,13 @@ const Comment = ({ objectId, mode, commentId }) => {
      return updateComment({
        ...params,
        comment_id: item.comment_id,
      }).then(() => {
      }).then((res) => {
        setComments(
          comments.map((comment) => {
            if (comment.comment_id === item.comment_id) {
              comment.showEdit = false;
              comment.parsed_text = html;
              comment.original_text = item.value;
              comment.parsed_text = res.parsed_text;
              comment.original_text = res.original_text;
            }
            return comment;
          }),",,
https://huntr.dev/bounties/cc2aa618-05da-495d-a5cd-51c40557d481/,Complex xss to bypass protection in answerdev/answer,"1.First we login as a normal user, and then comment under a question, the content of the comment is",CVE-2023-1237,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/answerdev/answer/commit/0566894a2c0e13cf07d877f41467e2e21529fee8,"@@ -5,7 +5,6 @@ import { Link } from 'react-router-dom';

import classNames from 'classnames';
import { unionBy } from 'lodash';
import { marked } from 'marked';

import * as Types from '@/common/interface';
import { Modal } from '@/components';
@@ -108,15 +107,11 @@ const Comment = ({ objectId, mode, commentId }) => {
    const users = matchedUsers(item.value);
    const userNames = unionBy(users.map((user) => user.userName));
    const commentMarkDown = parseUserInfo(item.value);
    const html = marked.parse(commentMarkDown);
    // if (!commentMarkDown || !html) {
    //   return;
    // }
    const params = {
      object_id: objectId,
      original_text: commentMarkDown,
      mention_username_list: userNames,
      parsed_text: html,
      ...(item.type === 'reply'
        ? {
            reply_comment_id: item.comment_id,
@@ -128,13 +123,13 @@ const Comment = ({ objectId, mode, commentId }) => {
      return updateComment({
        ...params,
        comment_id: item.comment_id,
      }).then(() => {
        setComments(
          comments.map((comment) => {
            if (comment.comment_id === item.comment_id) {
              comment.showEdit = false;
              comment.parsed_text = html;
              comment.original_text = item.value;
            }
            return comment;
          }),

","13
ui/src/components/Comment/index.tsx
@@ -5,7 +5,6 @@ import { Link } from 'react-router-dom';

import classNames from 'classnames';
import { unionBy } from 'lodash';
import { marked } from 'marked';

import * as Types from '@/common/interface';
import { Modal } from '@/components';
@@ -108,15 +107,11 @@ const Comment = ({ objectId, mode, commentId }) => {
    const users = matchedUsers(item.value);
    const userNames = unionBy(users.map((user) => user.userName));
    const commentMarkDown = parseUserInfo(item.value);
    const html = marked.parse(commentMarkDown);
    // if (!commentMarkDown || !html) {
    //   return;
    // }

    const params = {
      object_id: objectId,
      original_text: commentMarkDown,
      mention_username_list: userNames,
      parsed_text: html,
      ...(item.type === 'reply'
        ? {
            reply_comment_id: item.comment_id,
@@ -128,13 +123,13 @@ const Comment = ({ objectId, mode, commentId }) => {
      return updateComment({
        ...params,
        comment_id: item.comment_id,
      }).then(() => {
      }).then((res) => {
        setComments(
          comments.map((comment) => {
            if (comment.comment_id === item.comment_id) {
              comment.showEdit = false;
              comment.parsed_text = html;
              comment.original_text = item.value;
              comment.parsed_text = res.parsed_text;
              comment.original_text = res.original_text;
            }
            return comment;
          }),",,
https://huntr.dev/bounties/68708c1c-5c29-4aa8-859e-cc885dcc1062/,XSS in Library Description and Synopsis in galaxyproject/galaxy,"The 'description' and 'synopsis' fields of libraries are vulnerable to stored XSS injection. If a user sets the synopsis or description of a library to ''""><img src=x onerror=alert(1);>' they can set a stored XSS payload that fires whenever someone visits the /libraries page. Normally libraries are only editable by admins, but it is possible for admins to give edit permissions for specific libraries to regular users, meaning that this vulnerability could be used by an attacker on a normal user account if an admin gives them edit permission for a library.",,CWE-79: Cross-site Scripting (XSS) - Generic,https://www.github.com/galaxyproject/galaxy/commit/44fed0dfa50c03ae2fc8a4f16448f32b249a0e23,"@@ -7,17 +7,20 @@
            </div>
            <!-- shrink long text -->
            <div v-else-if=""text.length > maxDescriptionLength && !isExpanded"">

                <span
                    class=""shrinked-description""
                    :title=""text""
                    v-html=""linkify(text.substring(0, maxDescriptionLength))"">
                </span>

                <span :title=""text"">...</span>
                <a class=""more-text-btn"" href=""javascript:void(0)"" @click=""toggleDescriptionExpand"">(more) </a>
            </div>
            <!-- Regular -->
            <div v-else>
                <div v-html=""linkify(text)""></div>

                <!-- hide toggle expand if text is too short -->
                <a
                    v-if=""text.length > maxDescriptionLength""
@@ -37,6 +40,7 @@ import BootstrapVue from ""bootstrap-vue"";
import Vue from ""vue"";

import linkifyHtml from ""linkify-html"";

Vue.use(BootstrapVue);

export default {
@@ -60,6 +64,7 @@ export default {
        };
    },
    methods: {

        updateValue(value) {
            this.$emit(""update:changedValue"", value);
        },

","9
client/src/components/Libraries/LibraryEditField.vue
@@ -7,17 +7,20 @@
            </div>
            <!-- shrink long text -->
            <div v-else-if=""text.length > maxDescriptionLength && !isExpanded"">
                <!-- eslint-disable vue/no-v-html -->
                <span
                    class=""shrinked-description""
                    :title=""text""
                    v-html=""linkify(text.substring(0, maxDescriptionLength))"">
                    v-html=""linkify(sanitize(text.substring(0, maxDescriptionLength)))"">
                </span>
                <!-- eslint-enable vue/no-v-html -->
                <span :title=""text"">...</span>
                <a class=""more-text-btn"" href=""javascript:void(0)"" @click=""toggleDescriptionExpand"">(more) </a>
            </div>
            <!-- Regular -->
            <div v-else>
                <div v-html=""linkify(text)""></div>
                <!-- eslint-disable-next-line vue/no-v-html -->
                <div v-html=""linkify(sanitize(text))""></div>
                <!-- hide toggle expand if text is too short -->
                <a
                    v-if=""text.length > maxDescriptionLength""
@@ -37,6 +40,7 @@ import BootstrapVue from ""bootstrap-vue"";
import Vue from ""vue"";
import linkifyHtml from ""linkify-html"";
import { sanitize } from ""dompurify"";
Vue.use(BootstrapVue);
export default {
@@ -60,6 +64,7 @@ export default {
        };
    },
    methods: {
        sanitize,
        updateValue(value) {
            this.$emit(""update:changedValue"", value);
        },",,
https://huntr.dev/bounties/3d5199d6-9bb2-4f7b-bd81-bded704da499/,Two Stored XSS in Instructions and User Widget in phpipam/phpipam,Description 1,CVE-2023-1212,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/phpipam/phpipam/commit/78e0470100a6cb143fe9af2e336dce80e4620960,"@@ -118,8 +118,8 @@
$m=0;       //to calculate chunk index

foreach($uwidgets as $uk=>$uv) {
 //get fetails
 $wdet = (array) $widgets[$uv];
 if(is_blank($wdet['wsize'])) { $wsize = 6; }
 else       { $wsize = $wdet['wsize']; }

@@ -148,18 +148,18 @@
 foreach($uwidgetschunk as $w) {
  # print itams in a row
  foreach($w as $c) {

   /* print items */
   $wdet = (array) $widgets[$c];
   if(array_key_exists($c, $widgets)) {


    //reset size if not set
    if(is_blank($wdet['wsize'])) { $wdet['wsize'] = 6; }

    print "" <div class='col-xs-12 col-sm-12 col-md-12 col-lg-$wdet[wsize] widget-dash' id='w-$wdet[wfile]'>"";
    print "" <div class='inner'><i class='fa fa-times remove-widget icon-action fa-gray pull-right'></i>"";
    // href?
    if($wdet['whref']==""yes"") { print ""<a href='"".create_link(""widgets"",$wdet['wfile']).""'> <h4>""._($wdet['wtitle']).""<i class='fa fa-external-link fa-gray pull-right'></i></h4></a>""; }
    else      { print ""<h4>""._($wdet['wtitle']).""</h4>""; }
    print ""  <div class='hContent'>"";
    print ""   <div style='text-align:center;padding-top:50px;'><strong>""._('Loading widget').""</strong><br><i class='fa fa-spinner fa-spin'></i></div>"";
    print ""  </div>"";
@@ -169,9 +169,9 @@
   }
   # invalid widget
   else {
    print "" <div class='col-xs-12 col-sm-12 col-md-12 col-lg-6' id='w-$c'>"";
    print "" <div class='inner'>"";
    print ""  <blockquote style='margin-top:20px;margin-left:20px;'><p>Invalid widget $c</p></blockquote>"";
    print "" </div>"";
    print "" </div>"";
   }

@@ -674,7 +674,7 @@ public function noxss_html($html) {
   if ($dom->loadHTML(""<html>"".$html.""</html>"", LIBXML_HTML_NOIMPLIED | LIBXML_HTML_NODEFDTD | LIBXML_NOBLANKS | LIBXML_NOWARNING | LIBXML_NOERROR) === false)
    return """";

   $banned_elements = ['script', 'iframe', 'embed'];
   $remove_elements = [];

   $elements = $dom->getElementsByTagName('*');

@@ -12,6 +12,7 @@
    + XSS (reflected) in 'bw-calulator-result.php';
    + XSS (reflected) by invalid email address response;
    + XSS (reflected) by /app/tools/subnet-masks/popup.php (#3738);

    + XSS and LDAP injection in ad-search-result.php;
    + XSS and LDAP injection in ad-search-group-result.php;
    + Restrict find_full_subnets.php to CLI;

","18
app/dashboard/index.php
@@ -118,8 +118,8 @@
$m=0;       //to calculate chunk index

foreach($uwidgets as $uk=>$uv) {
 //get fetails
 $wdet = (array) $widgets[$uv];
 //get details
 $wdet = isset($widgets[$uv]) ? (array) $widgets[$uv] : ['wsize' => 6];
 if(is_blank($wdet['wsize'])) { $wsize = 6; }
 else       { $wsize = $wdet['wsize']; }

@@ -148,18 +148,18 @@
 foreach($uwidgetschunk as $w) {
  # print itams in a row
  foreach($w as $c) {

   /* print items */
   $wdet = (array) $widgets[$c];
   if(array_key_exists($c, $widgets)) {
    $wdet = (array) $widgets[$c];

    //reset size if not set
    if(is_blank($wdet['wsize'])) { $wdet['wsize'] = 6; }

    print "" <div class='col-xs-12 col-sm-12 col-md-12 col-lg-$wdet[wsize] widget-dash' id='w-$wdet[wfile]'>"";
    print "" <div class='col-xs-12 col-sm-12 col-md-12 col-lg-"".escape_input($wdet['wsize'])."" widget-dash' id='w-"".escape_input($wdet['wfile']).""'>"";
    print "" <div class='inner'><i class='fa fa-times remove-widget icon-action fa-gray pull-right'></i>"";
    // href?
    if($wdet['whref']==""yes"") { print ""<a href='"".create_link(""widgets"",$wdet['wfile']).""'> <h4>""._($wdet['wtitle']).""<i class='fa fa-external-link fa-gray pull-right'></i></h4></a>""; }
    else      { print ""<h4>""._($wdet['wtitle']).""</h4>""; }
    if($wdet['whref']==""yes"") { print ""<a href='"".create_link(""widgets"",$wdet['wfile']).""'> <h4>""._(escape_input($wdet['wtitle'])).""<i class='fa fa-external-link fa-gray pull-right'></i></h4></a>""; }
    else      { print ""<h4>""._(escape_input($wdet['wtitle'])).""</h4>""; }
    print ""  <div class='hContent'>"";
    print ""   <div style='text-align:center;padding-top:50px;'><strong>""._('Loading widget').""</strong><br><i class='fa fa-spinner fa-spin'></i></div>"";
    print ""  </div>"";
@@ -169,9 +169,9 @@
   }
   # invalid widget
   else {
    print "" <div class='col-xs-12 col-sm-12 col-md-12 col-lg-6' id='w-$c'>"";
    print "" <div class='col-xs-12 col-sm-12 col-md-12 col-lg-6' id='w-"".escape_input($c).""'>"";
    print "" <div class='inner'>"";
    print ""  <blockquote style='margin-top:20px;margin-left:20px;'><p>Invalid widget $c</p></blockquote>"";
    print ""  <blockquote style='margin-top:20px;margin-left:20px;'><p>Invalid widget "".escape_input($c).""</p></blockquote>"";
    print "" </div>"";
    print "" </div>"";
   }
2
functions/classes/class.Common.php
@@ -674,7 +674,7 @@ public function noxss_html($html) {
   if ($dom->loadHTML(""<html>"".$html.""</html>"", LIBXML_HTML_NOIMPLIED | LIBXML_HTML_NODEFDTD | LIBXML_NOBLANKS | LIBXML_NOWARNING | LIBXML_NOERROR) === false)
    return """";

   $banned_elements = ['script', 'iframe', 'embed'];
   $banned_elements = ['script', 'iframe', 'embed', 'object'];
   $remove_elements = [];

   $elements = $dom->getElementsByTagName('*');
1
misc/CHANGELOG
@@ -12,6 +12,7 @@
    + XSS (reflected) in 'bw-calulator-result.php';
    + XSS (reflected) by invalid email address response;
    + XSS (reflected) by /app/tools/subnet-masks/popup.php (#3738);
    + XSS (stored) in user widget settings;
    + XSS and LDAP injection in ad-search-result.php;
    + XSS and LDAP injection in ad-search-group-result.php;
    + Restrict find_full_subnets.php to CLI;",,
https://huntr.dev/bounties/ed569124-2aeb-4b0d-a312-435460892afd/,SQL Injection in Custom Fields in phpipam/phpipam,SQL injection when updating custom fields in the admin panel.,CVE-2023-1211,CWE-89: SQL Injection,https://www.github.com/phpipam/phpipam/commit/16e7a94fb69412e569ccf6f2fe0a1f847309c922,"@@ -673,7 +673,7 @@ public function update_custom_field_definition ($field) {

     # set type definition and size of needed
     if($field['fieldType']==""bool"" || $field['fieldType']==""text"" || $field['fieldType']==""date"" || $field['fieldType']==""datetime"") { $field['ftype'] = $field['fieldType']; }
     else                                { $field['ftype'] = $field['fieldType'].""("".$field['fieldSize']."")""; }

     # default value null
     $field['fieldDefault'] = is_blank($field['fieldDefault']) ? NULL : $field['fieldDefault'];
@@ -709,6 +709,7 @@ public function update_custom_field_definition ($field) {
     $params = array();
     if (strpos($query, "":default"")>0) $params['default'] = $field['fieldDefault'];
     if (strpos($query, "":comment"")>0) $params['comment'] = $field['Comment'];


  # execute
  try { $res = $this->Database->runQuery($query, $params); }

@@ -7,6 +7,7 @@

    Security Fixes:
    ----------------------------

    + XSS (reflected) in 'bw-calulator-result.php';
    + XSS (reflected) by invalid email address response;
    + XSS (reflected) by /app/tools/subnet-masks/popup.php (#3738);

","3
functions/classes/class.Admin.php
@@ -673,7 +673,7 @@ public function update_custom_field_definition ($field) {

     # set type definition and size of needed
     if($field['fieldType']==""bool"" || $field['fieldType']==""text"" || $field['fieldType']==""date"" || $field['fieldType']==""datetime"") { $field['ftype'] = $field['fieldType']; }
     else                                { $field['ftype'] = $field['fieldType'].""("".$field['fieldSize']."")""; }
     else                                { $field['ftype'] = $field['fieldType'].""( :enumset )""; }

     # default value null
     $field['fieldDefault'] = is_blank($field['fieldDefault']) ? NULL : $field['fieldDefault'];
@@ -709,6 +709,7 @@ public function update_custom_field_definition ($field) {
     $params = array();
     if (strpos($query, "":default"")>0) $params['default'] = $field['fieldDefault'];
     if (strpos($query, "":comment"")>0) $params['comment'] = $field['Comment'];
     if (strpos($query, "":enumset"")>0) $params['enumset'] = $field['fieldSize'];

  # execute
  try { $res = $this->Database->runQuery($query, $params); }
1
misc/CHANGELOG
@@ -7,6 +7,7 @@

    Security Fixes:
    ----------------------------
    + SQL injection in custom field enum/set types;
    + XSS (reflected) in 'bw-calulator-result.php';
    + XSS (reflected) by invalid email address response;
    + XSS (reflected) by /app/tools/subnet-masks/popup.php (#3738);",,
https://huntr.dev/bounties/97d226ea-2cd8-4f4d-9360-aa46c37fdd26/,Cross-Site Scripting (Stored/Persistent) in Categories in uvdesk/community-skeleton,?The application is vulnerable to Cross-Site Scripting (XSS) attacks. This occurs when web applications do not properly validate user-supplied inputs before including them in dynamic web pages.,CVE-2023-1197,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/uvdesk/community-skeleton/commit/6fae9442361c8a216611d3622bec26249a8c48a0,"@@ -3,7 +3,7 @@
    ""description"": ""UVDesk Community Helpdesk Project Skeleton"",
    ""type"": ""project"",
    ""license"": ""MIT"",
    ""minimum-stability"": ""dev"",
    ""prefer-stable"": true,
    ""require"": {
        ""php"": ""^7.2.5 || ^8.0"",

","2
composer.json
@@ -3,7 +3,7 @@
    ""description"": ""UVDesk Community Helpdesk Project Skeleton"",
    ""type"": ""project"",
    ""license"": ""MIT"",
    ""minimum-stability"": ""dev"",
    ""minimum-stability"": ""stable"",
    ""prefer-stable"": true,
    ""require"": {
        ""php"": ""^7.2.5 || ^8.0"",",,
https://huntr.dev/bounties/f5cb8816-fc12-4282-9571-81f25670e04a/,Storage xss vulnerability exists in simple graph beds in icret/easyimages2.0,"Storage xss vulnerability exists in simple graph beds,By constructing a malicious svg code that directs the administrator to click, the cookie is stolen",CVE-2023-1181,CWE-79: Cross-site Scripting (XSS) - Stored,https://www.github.com/icret/easyimages2.0/commit/95a6caf1c660a7342a8f11d70c2dbf7ebcbe2966,"@@ -1,4 +1,4 @@
* 2023-03-04 v2.7.6 dev
- 
- SVG
- ?
","2
docs/update.md
@@ -1,4 +1,4 @@
* 2023-03-04 v2.7.6 dev
* 2023-03-04 v2.7.6
- 
- SVG
- ?
https://huntr.dev/bounties/3ba48abe-74c0-4e74-8bcb-978a4f7ae59e/,Simple graph bed system has deserialization vulnerability and weak type comparison vulnerability in icret/easyimages2.0,Simple graph bed has deserialization vulnerability and weak type comparison vulnerability,,CWE-639: Authorization Bypass Through User-Controlled Key,https://www.github.com/icret/easyimages2.0/commit/95a6caf1c660a7342a8f11d70c2dbf7ebcbe2966,@@ -1",4 +1,4 @@
https://huntr.dev/bounties/7e93fc17-92eb-4ae7-b01a-93bb460b643e/,Incorrect Calculation of Buffer Size in function yank_copy_line in vim/vim,Incorrect Calculation of Buffer Size in function yank_copy_line at register.c:1468,CVE-2023-1175,CWE-131: Incorrect Calculation of Buffer Size,https://www.github.com/vim/vim/commit/c99cbf8f289bdda5d4a77d7ec415850a520330ba,"@@ -1245,6 +1245,8 @@ op_yank(oparg_T *oap, int deleting, int mess)
    // double-count it.
    bd.startspaces = (ce - cs + 1)
         - oap->start.coladd;


    startcol++;
       }
   }

@@ -88,6 +88,16 @@ func Test_edit_change()
  set virtualedit=
endfunc











"" Tests for pasting at the beginning, end and middle of a tab character
"" in virtual edit mode.
func Test_paste_in_tab()

@@ -695,6 +695,8 @@ static char *(features[]) =

static int included_patches[] =
{   /* Add new patch number below this line */


/**/
    1377,
/**/

","2
src/register.c
@@ -1245,6 +1245,8 @@ op_yank(oparg_T *oap, int deleting, int mess)
    // double-count it.
    bd.startspaces = (ce - cs + 1)
         - oap->start.coladd;
    if (bd.startspaces < 0)
        bd.startspaces = 0;
    startcol++;
       }
   }
10
src/testdir/test_virtualedit.vim
@@ -88,6 +88,16 @@ func Test_edit_change()
  set virtualedit=
endfunc

func Test_edit_special_char()
  new
  se ve=all
  norm a0
  sil! exe ""norm o00000\<Nul>k<a0s""

  bwipe!
  set virtualedit=
endfunc

"" Tests for pasting at the beginning, end and middle of a tab character
"" in virtual edit mode.
func Test_paste_in_tab()
2
src/version.c
@@ -695,6 +695,8 @@ static char *(features[]) =

static int included_patches[] =
{   /* Add new patch number below this line */
/**/
    1378,
/**/
    1377,
/**/",,
https://huntr.dev/bounties/1b1dbc5a-df16-421f-9a0d-de83e43146c4/,SQL Injection in 'core/ajax/ajax_data.php' in unilogies/bumsys,There exists an SQL injection affecting the customer_id parameter located in the file core/ajax/ajax_data.php,CVE-2023-1361,CWE-89: SQL Injection,https://www.github.com/unilogies/bumsys/commit/6a328eb5bf9dbb44329a3df82e95683b77c4730d,"@@ -6,7 +6,7 @@








@@ -27,11 +27,38 @@










































@@ -89,9 +116,32 @@


































@@ -105,12 +155,15 @@





















@@ -122,13 +175,16 @@























@@ -143,7 +199,7 @@








@@ -196,8 +252,10 @@












@@ -207,7 +265,15 @@
















@@ -279,8 +345,10 @@












@@ -299,7 +367,15 @@
















@@ -424,7 +500,7 @@








@@ -460,7 +536,22 @@























@@ -522,7 +613,10 @@











@@ -534,9 +628,15 @@
















@@ -570,7 +670,7 @@








@@ -997,12 +1097,12 @@















@@ -1200,6 +1300,8 @@








@@ -1352,14 +1454,14 @@
















@@ -1712,39 +1814,100 @@












































































































@@ -1754,10 +1917,16 @@


















@@ -1773,27 +1942,31 @@




































@@ -1803,10 +1976,16 @@


















@@ -1816,6 +1995,337 @@

















































































































































































































































































































































",,,
https://huntr.dev/bounties/e5959166-c8ef-4ada-9bb1-0ff5a9693bac/,UI REDRESSING in unilogies/bumsys,"The web application does not restrict or incorrectly restricts frame objects or UI layers that belong to another application or domain, which can lead to user confusion about which interface the user is interacting with",CVE-2023-1362,CWE-1021: Improper Restriction of Rendered UI Layers or Frames,https://www.github.com/unilogies/bumsys/commit/8c5b27d54707f9805b27ef26ad741f2801e30e1f,"@@ -7,6 +7,9 @@
// Set the php coockie id only visible over http
ini_set('session.cookie_httponly', true);




// Check if the PHP version is at leat 7.0
if( version_compare(PHP_VERSION, '7.0.0') <= 0 ) {
    header('HTTP/1.0 403 Forbidden');

","3
core/loader.php
@@ -7,6 +7,9 @@
// Set the php coockie id only visible over http
ini_set('session.cookie_httponly', true);

// Prevent Loading iframe to other website
header(""X-Frame-Options: DENY"");

// Check if the PHP version is at leat 7.0
if( version_compare(PHP_VERSION, '7.0.0') <= 0 ) {
    header('HTTP/1.0 403 Forbidden');",,
